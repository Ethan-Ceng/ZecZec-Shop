import{_ as e,A as t,x as a,z as s,B as l,D as r,M as o,a as d,N as i,o as n,c as p,w as c,g as u,b as m,e as f,d as g,t as _,G as b,K as h,q as y,f as w,F as x,i as k,I as S,O as v,Q as A,j as I,k as P,h as C,a4 as F}from"./index-6e5c77a7.js";import{P as V}from"./uni-popup.f3f35788.js";/* empty css                                                                  */const R=e({components:{Popup:V},data:()=>({isPopup:!1,is_read:!1,agreement:"",is_applying:!1,referee_name:"",words:{},is_agent:"",top_background:"",temlIds:[],urldata:"",btnAtrrpx:{},mpState:null,form:{}}),mounted(){let e=t("mpState");this.mpState=e,this.isWeixin()&&(this.urldata=window.location.href,this.getBtnInfo(),this.getTemplateId()),this.getData()},methods:{subscribeSuccess(){this.formSubmit(),console.log("呼叫成功")},subscribeFail(){this.temlIds=[],this.formSubmit(),console.log("呼叫失敗")},getBtnInfo(){let e=this,t={width:540,height:84,paddingLeft:28,fontSize:28};a({success:function(a){let s=a.screenWidth/750,l={};for(let e in t)l[e]=t[e]*s;e.btnAtrrpx=l},fail(){e.btnAtrrpx=t}})},getTemplateId(){let e=this;e._post("index/getSignPackage",{url:e.urldata,paySource:e.getPlatform()},(function(t){e.mpMessage(t.data.signPackage)}))},getData(){let e=this;s({title:"載入中"}),e._get("user.agent/apply",{platform:e.getPlatform(),referee_id:t("referee_id")},(function(t){l(),e.top_background=t.data.background,e.is_applying=t.data.is_applying,e.referee_name=null!=t.data.referee_name?t.data.referee_name:"平臺",e.is_agent=t.data.is_agent,e.words=t.data.words,e.temlIds=t.data.template_arr,e.agreement=t.data.license,r({title:e.words.apply.title.value}),e.is_agent&&o({})}))},formSubmit:function(e){let a=this.form;a.referee_id=t("referee_id");let r=this;if(""==a.name)return void d({title:"請輸入姓名！",icon:"none"});if(""==a.mobile.length)return void d({title:"請輸入手機號！",icon:"none"});if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(a.mobile))return void d({title:"手機有誤,請重填！",icon:"none"});if(!r.is_read)return void d({title:"請同意協議！",icon:"none"});r.subMessage(r.temlIds,(function(){s({title:"正在提交",mask:!0}),r._post("plus.agent.apply/submit",a,(function(e){l(),d({title:"申請成功"}),r.getData()}))}))},gotoShop(){i({url:"/pages/index/index"})},changeFunc(e){e.detail.value.length>0?this.is_read=!0:this.is_read=!1}}},[["render",function(e,t,a,s,l,r){const o=k,d=u,i=S,V=v,R=A,j=I,z=P("wx-open-subscribe"),D=C,L=F,B=P("Popup");return n(),p(d,{class:"apply-agent"},{default:c((()=>[""!=l.top_background?(n(),p(d,{key:0,class:"banner d-c-c d-c"},{default:c((()=>[m(o,{src:l.top_background,mode:"aspectFill"},null,8,["src"])])),_:1})):f("",!0),l.is_applying?f("",!0):(n(),p(d,{key:1,class:"form-wrap p30 f30"},{default:c((()=>[m(d,{class:"p30 d-c-c gray3 f36 fb"},{default:c((()=>[g(_(l.words.apply&&l.words.apply.words&&l.words.apply.words.title&&l.words.apply.words.title.value||""),1)])),_:1}),m(L,{onSubmit:r.formSubmit,onReset:e.formReset},{default:c((()=>[m(d,{class:"form-item border-b"},{default:c((()=>[m(d,{class:"field-name"},{default:c((()=>[g("邀請人")])),_:1}),g(" "+_(l.referee_name||""),1)])),_:1}),m(d,{class:"form-item border-b"},{default:c((()=>[m(d,{class:"field-name"},{default:c((()=>[g("姓名")])),_:1}),m(i,{class:"flex-1 ml20",name:"name",modelValue:l.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.name=e),type:"text","placeholder-class":"grary",placeholder:"請輸入姓名"},null,8,["modelValue"])])),_:1}),m(d,{class:"form-item border-b"},{default:c((()=>[m(d,{class:"field-name"},{default:c((()=>[g("手機號")])),_:1}),m(i,{class:"flex-1 ml20",name:"mobile",modelValue:l.form.mobile,"onUpdate:modelValue":t[1]||(t[1]=e=>l.form.mobile=e),type:"number","placeholder-class":"grary",placeholder:"請輸入手機"},null,8,["modelValue"])])),_:1}),m(d,{class:"d-s-c p-20-0 f24"},{default:c((()=>[m(R,{onChange:r.changeFunc},{default:c((()=>[m(V,{style:{transform:"scale(0.7)"},value:"checkbox",checked:l.is_read},null,8,["checked"])])),_:1},8,["onChange"]),m(j,null,{default:c((()=>[g("我已閱讀並瞭解")])),_:1}),m(j,{class:"red",onClick:t[2]||(t[2]=e=>l.isPopup=!0)},{default:c((()=>[g(" 【"+_(l.words.apply&&l.words.apply.words&&l.words.apply.words.license&&l.words.apply.words.license.value||"")+"】 ",1)])),_:1})])),_:1}),m(d,{class:"d-c-c mt30"},{default:c((()=>[e.isWeixin()&&1==l.mpState&&""!=l.temlIds?(n(),p(z,{key:0,template:l.temlIds,id:"subscribe-btn",onSuccess:r.subscribeSuccess,onError:r.subscribeFail},{default:c((()=>[(n(),p(b("script"),{type:"text/wxtag-template",slot:"style"})),(n(),p(b("script"),{type:"text/wxtag-template"},{default:c((()=>[h("div",{class:"subscribe-btn",style:y({width:l.btnAtrrpx.width+"px",height:l.btnAtrrpx.height+"px",lineHeight:l.btnAtrrpx.height+"px",paddingLeft:l.btnAtrrpx.paddingLeft+"px",paddingRigth:l.btnAtrrpx.paddingLeft+"px",fontSize:l.btnAtrrpx.fontSize+"px",background:"#f6220c",border:"1px solid #f6220c",borderRadius:"20px",color:"#fff",textAlign:"center"})},_(l.words.apply&&l.words.apply.words&&l.words.apply.words.submit.value||""),5)])),_:1}))])),_:1},8,["template","onSuccess","onError"])):(n(),p(D,{key:1,class:"btn-red",onClick:r.formSubmit},{default:c((()=>[g(_(l.words.apply&&l.words.apply.words&&l.words.apply.words.submit.value||""),1)])),_:1},8,["onClick"]))])),_:1})])),_:1},8,["onSubmit","onReset"])])),_:1})),l.is_applying?(n(),w(x,{key:2},[m(d,{class:"d-c-c pt30"},{default:c((()=>[m(o,{style:{width:"532rpx",height:"340rpx",margin:"0 auto"},src:"/h5/assets/agen_applay-c16c3866.png",mode:""})])),_:1}),m(d,{class:"p-30-0 d-c-c gray9 f26"},{default:c((()=>[g(_(l.words.apply.words.wait_audit.value||""),1)])),_:1}),m(d,{class:"p30 mt30 d-c-c"},{default:c((()=>[m(D,{type:"primary",class:"btn-red",onClick:r.gotoShop},{default:c((()=>[g(_(l.words.apply.words.goto_mall.value||""),1)])),_:1},8,["onClick"])])),_:1})],64)):f("",!0),m(B,{show:l.isPopup,msg:"申請協議"},{default:c((()=>[m(d,{class:"agreement-content f28 lh150"},{default:c((()=>[g(_(l.agreement),1)])),_:1}),m(d,{class:"ww100 pt20 d-c-c"},{default:c((()=>[m(D,{type:"primary",class:"btn-red",onClick:t[3]||(t[3]=e=>l.isPopup=!1)},{default:c((()=>[g("我已閱讀")])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}],["__scopeId","data-v-eeef7c4b"]]);export{R as default};
