import{_ as t,x as a,y as s,M as e,o as l,c as o,w as i,g as n,b as r,n as c,d as u,f as d,r as g,F as _,q as p,j as f,k as m,S as h,h as b,t as y,e as w,i as k}from"./index-6e5c77a7.js";import{u as x}from"./uni-load-more.58b2601d.js";import{C}from"./countdown.ae2f98a7.js";const D=t({components:{uniLoadMore:x,Countdown:C},data:()=>({loading:!0,phoneHeight:0,scrollviewHigh:0,status:0,topRefresh:!1,page:1,list_rows:20,listData:[],no_more:!1,countdownConfig:{startstamp:0,endstamp:0,type:"text",title:"剩餘："}}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onLoad(t){},mounted(){this.init(),this.getData()},methods:{rturnObjec:t=>({type:"text",startstamp:0,endstamp:t.end_time,title:"剩餘"}),progressReturn:t=>1==t.is_floor?100:t.bargain_rate,init(){let t=this;a({success(a){t.phoneHeight=a.windowHeight,s().select(".top-tabbar").boundingClientRect((a=>{let e=t.phoneHeight-a.height;s().select(".more-bargaining").boundingClientRect((a=>{let s=e-a.height;t.scrollviewHigh=s})).exec()})).exec()}})},stateFunc(t){let a=this;a.status!=t&&(a.listData=[],a.page=1,a.status=t,a.getData())},getData(){let t=this;t.loading=!0,t._get("user.bargain/lists",{page:t.page,list_rows:t.list_rows,status:t.status},(function(a){if(t.loading=!1,t.listData=t.listData.concat(a.data.list.data),t.last_page=a.data.list.last_page,a.data.list.last_page<=1)return t.no_more=!0,!1}))},scrolltolowerFunc(){let t=this;t.no_more||(t.page++,t.page<=t.last_page?t.getData():t.no_more=!0)},gotoDetail(t){let a="/pages/plus/bargain/haggle/haggle?bargain_task_id="+t;this.gotoPage(a)},goback(){e()},gotoMore(){this.gotoPage("/pages/plus/bargain/list/list")},returnValFunc(t,a){console.log(t,a)}}},[["render",function(t,a,s,e,x,C){const D=n,F=f,v=m("Countdown"),j=k,H=m("uni-load-more"),R=h,M=b;return l(),o(D,null,{default:i((()=>[r(D,{class:"top-tabbar"},{default:i((()=>[r(D,{class:c(0==x.status?"tab-item active":"tab-item"),onClick:a[0]||(a[0]=t=>C.stateFunc(0))},{default:i((()=>[u("進行中")])),_:1},8,["class"]),r(D,{class:c(1==x.status?"tab-item active":"tab-item"),onClick:a[1]||(a[1]=t=>C.stateFunc(1))},{default:i((()=>[u("砍價成功")])),_:1},8,["class"]),r(D,{class:c(2==x.status?"tab-item active":"tab-item"),onClick:a[2]||(a[2]=t=>C.stateFunc(2))},{default:i((()=>[u("砍價失敗")])),_:1},8,["class"])])),_:1}),r(R,{"scroll-y":"true",class:"scroll-Y",style:p("height:"+x.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:C.scrolltolowerFunc},{default:i((()=>[r(D,{class:"my-bargaing-list"},{default:i((()=>[(l(!0),d(_,null,g(x.listData,((t,a)=>(l(),o(D,{class:"item",onClick:a=>C.gotoDetail(t.bargain_task_id),key:a},{default:i((()=>[r(D,{class:"datetime d-b-c"},{default:i((()=>[r(F,{class:"f28"},{default:i((()=>[u(y(t.create_time),1)])),_:2},1024),0==x.status?(l(),o(D,{key:0,class:"surplus-time"},{default:i((()=>[r(v,{config:C.rturnObjec(t)},null,8,["config"])])),_:2},1024)):w("",!0)])),_:2},1024),r(D,{class:"product d-s-s mt30"},{default:i((()=>[r(D,{class:"cover"},{default:i((()=>[r(j,{src:t.file_path,mode:"aspectFill"},null,8,["src"])])),_:2},1024),r(D,{class:"info flex-1 ml20 f28"},{default:i((()=>[r(F,{class:"f26 text-ellipsis-2"},{default:i((()=>[u(y(t.product_name),1)])),_:2},1024),r(D,{class:"mt20"},{default:i((()=>[r(F,{class:"redF6 f26"},{default:i((()=>[u("砍到底價：")])),_:1}),r(F,{class:"redF6 f20"},{default:i((()=>[u("￥")])),_:1}),r(F,{class:"redF6 f32"},{default:i((()=>[u(y(t.bargain_price),1)])),_:2},1024),r(F,{class:"ml10 gray9 text-l-t f26"},{default:i((()=>[u(y(t.product_price),1)])),_:2},1024)])),_:2},1024),r(D,{class:"d-b-c mt10 f24"},{default:i((()=>[r(D,null,{default:i((()=>[r(F,{class:"gray3"},{default:i((()=>[u("完成度：")])),_:1}),r(F,{class:"gray3"},{default:i((()=>[u(y(C.progressReturn(t))+"%",1)])),_:2},1024)])),_:2},1024),r(D,{class:"progress-box"},{default:i((()=>[r(D,{class:"progress-box-active",style:p("width:"+C.progressReturn(t)+"%;")},null,8,["style"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0!=x.listData.length||x.loading?(l(),o(H,{key:1,loadingType:C.loadingType},null,8,["loadingType"])):(l(),o(D,{key:0,class:"d-c-c p30"},{default:i((()=>[r(F,{class:"iconfont icon-wushuju"}),r(F,{class:"cont"},{default:i((()=>[u("親，暫無相關記錄哦")])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"]),r(D,{class:"more-bargaining"},{default:i((()=>[r(M,{type:"primary",class:"btn-red",onClick:C.gotoMore},{default:i((()=>[u("更多活動")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-d9103922"]]);export{D as default};
