import{_ as a,x as t,y as e,o as s,c as l,w as o,n as c,g as i,b as n,d as u,f as p,r,F as _,q as d,j as f,k as g,S as y,e as m,t as h,u as b,i as k}from"./index-6e5c77a7.js";import{u as x}from"./uni-load-more.58b2601d.js";const w=a({components:{uniLoadMore:x},data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:0,page:1,last_page:0,list_rows:15,listData:[],no_more:!1,loading:!1,data_type:"not_use"}),mounted(){this.init()},onShow(){this.initData(),this.getData()},computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},methods:{init(){let a=this;t({success(t){a.phoneHeight=t.windowHeight,e().select(".top-tabbar").boundingClientRect((t=>{let e=a.phoneHeight-t.height;a.scrollviewHigh=e})).exec()}})},initData(){this.listData=[],this.page=1,this.no_more=!1},getData(){let a=this;a.loading=!0;let t=a.data_type;a._get("user.coupon/lists",{page:a.page,list_rows:a.list_rows,data_type:t},(function(t){if(a.loading=!1,a.listData=a.listData.concat(t.data.list.data),a.last_page=t.data.list.last_page,t.data.list.last_page<=1)return a.no_more=!0,!1}))},scrolltolowerFunc(){let a=this;a.no_more||(a.page++,a.page<=a.last_page?a.getData():a.no_more=!0)},stateFunc(a){let t=this;t.state_active!=a&&(0==a&&(t.data_type="not_use"),1==a&&(t.data_type="is_use"),2==a&&(t.data_type="is_expire"),t.state_active=a,t.initData(),t.getData())},scrolltoupperFunc(){console.log("滾動檢視區域到頂")},lookRule(a){a.rule=!0},closeRule(a){a.rule=!1}}},[["render",function(a,t,e,x,w,v){const D=i,C=k,F=f,H=g("uni-load-more"),S=y;return s(),l(D,{"data-theme":a.theme(),class:c(a.theme()||"")},{default:o((()=>[n(D,{class:"top-tabbar"},{default:o((()=>[n(D,{class:c(0==w.state_active?"tab-item active":"tab-item"),onClick:t[0]||(t[0]=a=>v.stateFunc(0))},{default:o((()=>[u("未使用")])),_:1},8,["class"]),n(D,{class:c(1==w.state_active?"tab-item active":"tab-item"),onClick:t[1]||(t[1]=a=>v.stateFunc(1))},{default:o((()=>[u("已使用")])),_:1},8,["class"]),n(D,{class:c(2==w.state_active?"tab-item active":"tab-item"),onClick:t[2]||(t[2]=a=>v.stateFunc(2))},{default:o((()=>[u("已過期")])),_:1},8,["class"])])),_:1}),n(S,{"scroll-y":"true",class:"scroll-Y",style:d("height:"+w.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltoupper:v.scrolltoupperFunc,onScrolltolower:v.scrolltolowerFunc},{default:o((()=>[n(D,{class:""},{default:o((()=>[(s(!0),p(_,null,r(w.listData,((e,i)=>(s(),l(D,{class:"item-wrap mb20",key:i},{default:o((()=>[n(D,{class:c(0==e.is_expire&&0==e.is_use?"coupon-item coupon-item-"+e.color.text:"coupon-item coupon-item-gray")},{default:o((()=>[1==e.is_use?(s(),l(C,{key:0,class:"coupon-disabled",src:"/h5/assets/coupon-status1-e64a9c3b.png",mode:""})):m("",!0),1==e.is_expire?(s(),l(C,{key:1,class:"coupon-disabled",src:"/h5/assets/coupon-status2-f67188ff.png",mode:""})):m("",!0),n(D,{class:"operation d-b-c"},{default:o((()=>[n(D,{class:"flex-1 coupon-content"},{default:o((()=>[n(D,{class:"mb20"},{default:o((()=>[n(F,{class:"f40 fb"},{default:o((()=>[u(h(e.name),1)])),_:2},1024)])),_:2},1024),n(D,{class:"f22 gray9 mb20"},{default:o((()=>[u("有效期："+h(e.start_time.text)+"至"+h(e.end_time.text),1)])),_:2},1024),e.max_price&&e.max_price>0?(s(),l(D,{key:0,class:"f22"},{default:o((()=>[u("(最大優惠"+h(e.max_price)+"元)",1)])),_:2},1024)):m("",!0)])),_:2},1024),n(D,{class:"right-box d-c-c d-c"},{default:o((()=>[10==e.coupon_type.value?(s(),l(D,{key:0,class:"theme-price mb10"},{default:o((()=>[n(F,{class:"f24"},{default:o((()=>[u("￥")])),_:1}),n(F,{class:"f52 fb"},{default:o((()=>[u(h(1*e.reduce_price),1)])),_:2},1024)])),_:2},1024)):m("",!0),20==e.coupon_type.value?(s(),l(D,{key:1,class:"mb10 theme-price"},{default:o((()=>[n(F,{class:"f52 fb"},{default:o((()=>[u(h(e.discount),1)])),_:2},1024),n(F,{class:"f24"},{default:o((()=>[u("折")])),_:1})])),_:2},1024)):m("",!0),n(D,{class:"f24 mb10"},{default:o((()=>[u(h(e.min_price>0?"滿"+1*e.min_price+"元可用":"無門檻"),1)])),_:2},1024),e.state.value>0?(s(),p(_,{key:2},[10!=e.apply_range?(s(),l(D,{key:0,class:"f26 coupon-btn theme-borderbtn",onClick:b((t=>a.gotoPage("/pages/coupon/detail?coupon_id="+e.coupon_id+"&apply_range="+e.apply_range)),["stop"])},{default:o((()=>[u(" 去使用 ")])),_:2},1032,["onClick"])):(s(),l(D,{key:1,class:"f26 coupon-btn theme-btn",onClick:t[3]||(t[3]=b((t=>a.gotoPage("/pages/index/index")),["stop"]))},{default:o((()=>[u("去使用")])),_:1}))],64)):(s(),l(D,{key:3,class:"f26 coupon-btn btn-gray white"},{default:o((()=>[n(F,null,{default:o((()=>[u(h(e.state.text),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"]),20==e.apply_range?(s(),l(D,{key:0,class:"range_item d-b-c",onClick:b((t=>a.gotoPage("/pages/coupon/detail?coupon_id="+e.coupon_id+"&apply_range="+e.apply_range)),["stop"])},{default:o((()=>[n(D,{class:"gray9 f24"},{default:o((()=>[u(" 限指定部分商品 "),n(F,{class:"icon iconfont icon-you",style:{color:"#999999","font-size":"22rpx"}})])),_:1}),n(D,{class:"gray9 f24"},{default:o((()=>[u("本券不支援轉贈")])),_:1})])),_:2},1032,["onClick"])):30==e.apply_range?(s(),l(D,{key:1,class:"range_item d-b-c",onClick:b((t=>a.gotoPage("/pages/coupon/detail?coupon_id="+e.coupon_id+"&apply_range="+e.apply_range)),["stop"])},{default:o((()=>[n(D,{class:"gray9 f24"},{default:o((()=>[u(" 限指定分類商品 "),n(F,{class:"icon iconfont icon-you",style:{color:"#999999","font-size":"22rpx"}})])),_:1}),n(D,{class:"gray9 f24"},{default:o((()=>[u("本券不支援轉贈")])),_:1})])),_:2},1032,["onClick"])):(s(),l(D,{key:2,class:"range_item d-b-c"},{default:o((()=>[n(D,{class:"gray9 f24"},{default:o((()=>[u(" 全場通用 "),n(F,{class:"icon iconfont icon-you",style:{color:"#999999","font-size":"22rpx"}})])),_:1}),n(D,{class:"gray9 f24"},{default:o((()=>[u("本券不支援轉贈")])),_:1})])),_:1}))])),_:2},1024)))),128))])),_:1}),0!=w.listData.length||w.loading?(s(),l(H,{key:1,loadingType:v.loadingType},null,8,["loadingType"])):(s(),l(D,{key:0,class:"d-c-c p30"},{default:o((()=>[n(F,{class:"iconfont icon-wushuju"}),n(F,{class:"cont"},{default:o((()=>[u("親，暫無相關記錄哦")])),_:1})])),_:1}))])),_:1},8,["style","onScrolltoupper","onScrolltolower"])])),_:1},8,["data-theme","class"])}]]);export{w as default};
