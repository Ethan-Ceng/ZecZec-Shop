import{_ as e,a as s,A as o,z as t,s as l,B as a,o as i,c as d,w as n,n as r,g as c,b as u,d as p,e as _,t as m,I as f,h as g,j as b}from"./index-6e5c77a7.js";const w=e({data:()=>({formData:{mobile:"",password:"",code:""},resetpassword:{mobile:"",password:"",repassword:"",code:""},is_send:!1,send_btn_txt:"獲取驗證碼",second:60,ip:"",is_login:2,sms_open:!1,isRead:!1}),onLoad(){},onShow(){this.getCodeType()},methods:{xieyi(e){this.gotoPage("/pages/webview/ue?type="+e)},getCodeType(){let e=this;e._post("index/loginSetting",{},(s=>{e.sms_open=s.data.setting.sms_open,e.sms_open||(e.is_login=1)}))},formSubmit(){let e=this;if(!e.isRead)return void s({title:"請先閱讀並接受使用者協議及隱私政策",duration:2e3,icon:"none"});let i={mobile:e.formData.mobile,invitation_id:e.invitation_id||0,referee_id:o("referee_id")||0},d="";if(/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile)){if(2==e.is_login){if(e.sms_open&&""==e.formData.code)return void s({title:"驗證碼不能為空！",duration:2e3,icon:"none"});i.code=e.formData.code,d="user.useropen/smslogin"}else{if(i.password=e.formData.password,""==e.formData.password)return void s({title:"密碼不能為空！",duration:2e3,icon:"none"});d="user.useropen/phonelogin"}t({title:"正在提交"}),e._post(d,i,(s=>{l("token",s.data.token),l("user_id",s.data.user_id);let t="/"+o("currentPage"),a=o("currentPageOptions");if(Object.keys(a).length>0){t+="?";for(let e in a)t+=e+"="+a[e]+"&";t=t.substring(0,t.length-1)}e.gotoPage(t,"redirect")}),!1,(()=>{a()}))}else s({title:"手機有誤,請重填！",duration:2e3,icon:"none"})},resetpasswordSub(){let e=this;/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile)?""!=e.resetpassword.code?e.resetpassword.password.length<6?s({title:"密碼至少6位數！",duration:2e3,icon:"none"}):e.resetpassword.password===e.resetpassword.repassword?(t({title:"正在提交"}),e._post("user.useropen/resetpassword",e.resetpassword,(o=>{s({title:"重置成功",duration:3e3}),e.formData.mobile=e.resetpassword.mobile,e.resetpassword={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{a()}))):s({title:"兩次密碼輸入不一致！",duration:2e3,icon:"none"}):s({title:"驗證碼不能為空！",duration:2e3,icon:"none"}):s({title:"手機有誤,請重填！",duration:2e3,icon:"none"})},sendCode(){let e=this;if(0!=e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile))return void s({title:"手機有誤,請重填！",duration:2e3,icon:"none"})}else if(0==e.is_login&&!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile))return void s({title:"手機有誤,請重填！",duration:2e3,icon:"none"});let o=e.formData.mobile;0==e.is_login&&(o=e.resetpassword.mobile),e._post("user.useropen/sendCode",{mobile:o,type:"sms"},(o=>{1==o.code&&(s({title:"傳送成功"}),e.is_send=!0,e.changeMsg())}))},changeMsg(){this.second>0?(this.send_btn_txt=this.second+"秒",this.second--,setTimeout(this.changeMsg,1e3)):(this.send_btn_txt="獲取驗證碼",this.second=60,this.is_send=!1)}}},[["render",function(e,s,o,t,l,a){const w=c,h=f,k=g,y=b;return i(),d(w,{class:r(["login-container",e.theme()||""]),"data-theme":e.theme()},{default:n((()=>[u(w,{class:"skip",onClick:s[0]||(s[0]=s=>e.gotoPage("/pages/index/index"))},{default:n((()=>[p("跳過→")])),_:1}),0!=l.is_login?(i(),d(w,{key:0,class:""},{default:n((()=>[u(w,{class:"login_topbpx"},{default:n((()=>[2==l.is_login?(i(),d(w,{key:0,class:"login_tit"},{default:n((()=>[p("快速登入")])),_:1})):_("",!0),1==l.is_login?(i(),d(w,{key:1,class:"login_tit"},{default:n((()=>[p("賬號登入")])),_:1})):_("",!0),2==l.is_login?(i(),d(w,{key:2,class:"login_top"},{default:n((()=>[p("首次登入會自動註冊")])),_:1})):_("",!0)])),_:1}),u(w,{class:"group-bd"},{default:n((()=>[u(w,{class:"form-level d-s-c"},{default:n((()=>[u(h,{class:"login-input","adjust-position":!1,type:"text",modelValue:l.formData.mobile,"onUpdate:modelValue":s[1]||(s[1]=e=>l.formData.mobile=e),placeholder:"請填寫手機號",disabled:l.is_send},null,8,["modelValue","disabled"])])),_:1}),1==l.is_login?(i(),d(w,{key:0,class:"form-level d-s-c"},{default:n((()=>[u(h,{class:"login-input","adjust-position":!1,type:"text",password:"true",modelValue:l.formData.password,"onUpdate:modelValue":s[2]||(s[2]=e=>l.formData.password=e),placeholder:"請輸入密碼"},null,8,["modelValue"]),u(k,{class:"get-code-btn",onClick:s[3]||(s[3]=e=>l.is_login=0)},{default:n((()=>[p("忘記密碼？")])),_:1})])),_:1})):_("",!0),2==l.is_login&&l.sms_open?(i(),d(w,{key:1,class:"form-level d-b-c"},{default:n((()=>[u(h,{class:"login-input",type:"number",modelValue:l.formData.code,"onUpdate:modelValue":s[4]||(s[4]=e=>l.formData.code=e),placeholder:"請填寫驗證碼"},null,8,["modelValue"]),u(k,{class:"get-code-btn",onClick:a.sendCode,disabled:l.is_send},{default:n((()=>[p(m(l.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})):_("",!0)])),_:1})])),_:1})):_("",!0),0==l.is_login?(i(),d(w,{key:1,class:""},{default:n((()=>[u(w,{class:"login_topbpx"},{default:n((()=>[u(w,{class:"login_tit"},{default:n((()=>[p("找回密碼")])),_:1}),u(w,{class:"login_top"},{default:n((()=>[p("請確認您的賬號已繫結此手機號碼")])),_:1})])),_:1}),u(w,{class:"group-bd"},{default:n((()=>[u(w,{class:"form-level d-s-c"},{default:n((()=>[u(w,{class:"val flex-1"},{default:n((()=>[u(h,{type:"text",modelValue:l.resetpassword.mobile,"onUpdate:modelValue":s[5]||(s[5]=e=>l.resetpassword.mobile=e),placeholder:"請填寫手機號",disabled:l.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),u(w,{class:"form-level d-s-c"},{default:n((()=>[u(w,{class:"val flex-1 d-b-c"},{default:n((()=>[u(h,{class:"flex-1","adjust-position":!1,type:"number",modelValue:l.resetpassword.code,"onUpdate:modelValue":s[6]||(s[6]=e=>l.resetpassword.code=e),placeholder:"請填寫驗證碼"},null,8,["modelValue"]),u(k,{class:"get-code-btn",onClick:a.sendCode,disabled:l.is_send},{default:n((()=>[p(m(l.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1}),u(w,{class:"form-level d-s-c"},{default:n((()=>[u(w,{class:"val flex-1"},{default:n((()=>[u(h,{type:"text","adjust-position":!1,password:"true",modelValue:l.resetpassword.password,"onUpdate:modelValue":s[7]||(s[7]=e=>l.resetpassword.password=e),placeholder:"請輸入密碼"},null,8,["modelValue"])])),_:1})])),_:1}),u(w,{class:"form-level d-s-c"},{default:n((()=>[u(w,{class:"val flex-1"},{default:n((()=>[u(h,{type:"text","adjust-position":!1,password:"true",modelValue:l.resetpassword.repassword,"onUpdate:modelValue":s[8]||(s[8]=e=>l.resetpassword.repassword=e),placeholder:"請再次輸入密碼"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})):_("",!0),u(w,{onClick:s[11]||(s[11]=e=>l.isRead=!l.isRead),class:"d-s-c gray6 mt30"},{default:n((()=>[u(w,{class:r(["icon iconfont icon-tijiaochenggong",l.isRead?"active agreement":"agreement"])},null,8,["class"]),p("我已閱讀並接受"),u(y,{class:"dominant",onClick:s[9]||(s[9]=e=>a.xieyi("service"))},{default:n((()=>[p("《使用者協議》")])),_:1}),p("和"),u(y,{class:"dominant",onClick:s[10]||(s[10]=e=>a.xieyi("privacy"))},{default:n((()=>[p("《隱私政策》")])),_:1})])),_:1}),2==l.is_login?(i(),d(k,{key:2,class:"theme-btn sub-btn",onClick:a.formSubmit},{default:n((()=>[p("立即登入")])),_:1},8,["onClick"])):_("",!0),1==l.is_login?(i(),d(k,{key:3,class:"theme-btn sub-btn",onClick:a.formSubmit},{default:n((()=>[p("立即登入")])),_:1},8,["onClick"])):_("",!0),0==l.is_login?(i(),d(k,{key:4,class:"theme-btn sub-btn",onClick:a.resetpasswordSub},{default:n((()=>[p("確認")])),_:1},8,["onClick"])):_("",!0),u(w,{class:"f30 gray6 d-c-c"},{default:n((()=>[1==l.is_login?(i(),d(w,{key:0,onClick:s[12]||(s[12]=e=>l.is_login=2)},{default:n((()=>[p("手機登入")])),_:1})):_("",!0),2==l.is_login?(i(),d(w,{key:1,onClick:s[13]||(s[13]=e=>l.is_login=1)},{default:n((()=>[p("賬號登入")])),_:1})):_("",!0),0==l.is_login?(i(),d(w,{key:2,onClick:s[14]||(s[14]=e=>l.is_login=1)},{default:n((()=>[p("立即登入")])),_:1})):_("",!0)])),_:1})])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-d0ae48b2"]]);export{w as default};
