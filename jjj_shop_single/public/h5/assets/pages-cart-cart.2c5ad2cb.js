import{_ as e,v as t,z as a,A as c,B as l,s,a as m,J as d,N as o,o as Z,c as n,w as i,n as r,g as u,f as h,b as A,d as f,F as k,r as p,t as _,e as g,h as b,O as C,P as D,Q as E,i as w,j as V,G as B,k as v,u as F}from"./index-6e5c77a7.js";import{_ as y}from"./recommendProduct.cb8c20bf.js";import{r as G}from"./uni-app.es.5424dc16.js";const I=e({components:{recommendProduct:y},data:()=>({loadding:!0,isEdit:!1,tableData:[],arrIds:[],checkedAll:!1,totalPrice:0,is_auto:0,clock:!1}),onReady(){t()},onShow(){this.getData()},methods:{getData(){a({title:"載入中"});let e=this;e._get("order.cart/lists",{},(function(t){let a=c("TabBar").is_auto&&0!=c("TabBar").is_auto;e.is_auto=a,l(),e.tableData=t.data,e.loadding=!1,e.clock=!1,e._initGoodsChecked()}),(t=>{e.getData()}))},_initGoodsChecked(){let e=this,t=e.getCheckedData();e.tableData.forEach((a=>{a.checked=e.inArray(`${a.cart_id}`,t)})),e.isEdit=!1,e.checkedAll=t.length==e.tableData.length,e.updateTotalPrice()},getCheckedData(){let e=c("CheckedData");return e||[]},checkItem(e,t){e.checked=!e.checked,this.tableData[t]=e,this.onUpdateChecked(),this.updateTotalPrice(),this.checkedAll=this.getCheckedData().length==this.tableData.length},onUpdateChecked(){let e=[];this.tableData.forEach((t=>{1==t.checked&&e.push(`${t.cart_id}`)})),s("CheckedData",e)},onCheckedAll(){let e=this;e.checkedAll=!e.checkedAll,e.tableData.forEach((t=>{t.checked=e.checkedAll})),e.updateTotalPrice(),e.onUpdateChecked()},updateTotalPrice:function(){let e=0,t=this.tableData;for(let a=0;a<t.length;a++)1==t[a].checked&&(e+=t[a].total_num*t[a].product_price);this.totalPrice=e.toFixed(2)},Submit(){let e=[];if(this.tableData.forEach((t=>{1==t.checked&&e.push(`${t.cart_id}`)})),0==e.length)return m({title:"請選擇商品",icon:"none"}),!1;this.gotoPage("/pages/order/confirm-order?order_type=cart&cart_ids="+e),console.log()},addFunc(e){let t=this;if(t.clock)return;t.clock=!0;let c=e.product_id,s=e.spec_sku_id;a({title:"載入中"}),t._post("order.cart/add",{product_id:c,spec_sku_id:s,total_num:1},(function(e){l(),t.getData()}),(function(){l(),t.clock=!1}))},reduceFunc(e){let t=this;if(t.clock)return;t.clock=!0;let c=e.product_id,s=e.spec_sku_id;e.total_num<=1||(console.log(e.total_num),a({title:"載入中"}),t._post("order.cart/sub",{product_id:c,spec_sku_id:s},(function(e){console.log("數量-1"),l(),t.getData()}),(function(){l(),t.clock=!1})))},onDelete(){let e=this,t=e.getCheckedIds();if(!t.length)return e.showError("您還沒有選擇商品"),!1;d({title:"提示",content:"您確定要移除選擇的商品嗎?",success(a){a.confirm&&e._post("order.cart/delete",{cart_id:t.join()},(function(a){e.onDeleteEvent(t),e.getData()}))}})},getCheckedIds(){let e=[];return this.tableData.forEach((t=>{!0===t.checked&&e.push(`${t.cart_id}`)})),e},onDeleteEvent(e){let t=this;return e.forEach((e=>{t.tableData.forEach(((a,c)=>{e==`${a.cart_id}`&&t.tableData.splice(c,1)}))})),t.onUpdateChecked(),!0},inArray(e,t){for(var a in t)if(t[a]==e)return!0;return!1},gotoShop(){o({url:"/pages/index/index"})}}},[["render",function(e,t,a,c,l,s){const m=b,d=u,o=C,I=D,P=E,R=w,W=V,x=G(B("recommendProduct"),y),O=v("tabBar");return Z(),n(d,{"data-theme":e.theme(),class:r(e.theme()||"")},{default:i((()=>[l.loadding?g("",!0):(Z(),n(d,{key:0,class:"card"},{default:i((()=>[l.tableData.length>0?(Z(),h(k,{key:0},[A(d,{class:"address-bar d-e-c"},{default:i((()=>[A(d,{class:"f30",onClick:t[0]||(t[0]=e=>l.isEdit=!l.isEdit)},{default:i((()=>[l.isEdit?(Z(),n(m,{key:0,class:"f24"},{default:i((()=>[f("完成")])),_:1})):(Z(),n(m,{key:1,class:"f24"},{default:i((()=>[f("編輯")])),_:1}))])),_:1})])),_:1}),A(d,{class:"section"},{default:i((()=>[A(d,{class:"supplier_list"},{default:i((()=>[(Z(!0),h(k,null,p(l.tableData,((e,t)=>(Z(),n(d,{class:"item",key:t},{default:i((()=>[A(P,{onChange:a=>s.checkItem(e,t)},{default:i((()=>[A(I,{class:"d-c-c"},{default:i((()=>[A(o,{value:"cb",class:"checkbox",checked:e.checked},null,8,["checked"])])),_:2},1024)])),_:2},1032,["onChange"]),A(R,{src:e.product_image,class:"cover",mode:"aspectFit"},null,8,["src"]),A(d,{class:"info"},{default:i((()=>[A(d,{class:"title"},{default:i((()=>[f(_(e.product_name),1)])),_:2},1024),A(d,{class:"describe"},{default:i((()=>[f(_(e.product_sku.product_attr),1)])),_:2},1024),A(d,{class:"level-box count_choose"},{default:i((()=>[A(d,{class:"price"},{default:i((()=>[f(" ¥ "),A(W,{class:"num"},{default:i((()=>[f(_(e.product_price),1)])),_:2},1024)])),_:2},1024),A(d,{class:"num-wrap"},{default:i((()=>[e.total_num>1?(Z(),n(d,{key:0,class:"",onClick:F((t=>s.reduceFunc(e)),["stop"])},{default:i((()=>[A(R,{class:"reduce_icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAilBMVEUAAABmZmZmZmZmZmZlZWVpaWlmZmZmZmZoaGhmZmZnZ2dpaWlkZGRnZ2dmZmZmZmZmZmZmZmZmZmZmZmZlZWVmZmZmZmZmZmZmZmZmZmZmZmZnZ2dmZmZmZmZmZmZmZmZmZmZmZmZlZWVlZWVmZmZmZmZmZmZmZmZlZWVmZmZmZmZlZWVlZWVmZmaDiK+QAAAALXRSTlMA+VW9QwXv5BbUJgkPn8703kovHMTYt7ES6aY9h8iOmU99Wip1bZF/qzV4aGAFJZmLAAADDUlEQVRYw6VX6XqrIBBFFFwgGnfjviZq6vu/3h2bfm0ujY0J5ycwh5lhmAX9BmFG5w5lqtpHnQL0o62m5eB2BiNoB4jRZXiuIlt3li84uh1VM846YwcDs3A+BqZOleUOCtXNYMyxxZ6Ic8vt0/AmEdpFEKhqEBR2eOML0961+F/yidbE5mlV2oyr5trWrqa5dXttqthcDTqZcaMlf2l/tj+PqYfLh+b5jNyc6nvax+WgflLb5007yNTHR9D0mPb1ZPmc3G1x35rqPj2Cbce4nx4y8KwJFNiP8tZijxVs8+gIR4Im4w/ktdIGM80SewbZemAPn01wkF1q/IE8bJ3Ui7glHssLCtf8YmDZOVSWU3zt+JN39oaILkp4zv4zk3iX9f7xw0dPYV3jE+hw8cj94lwoC41bf0+o+20MOhSz9bOU4Ajko6uPdsH/WBkinJDv+DvDAxcDUO5kuKoQLufvmLSaQlHC3EO70V1MRSmarxuZGzvAB27dDZKBzk7sfooQqzcXRcUJegEJVpXF7C2yhhdO6SIY8BxeHi40xQaBCM9NhY7YeI3AwCNVzLxjyMhG56bMbnwb7oyZgTocgAdqhl4Eq8ELAe6QO4Mx1YRexlSB62YXDZWumPCiL8NqTEWvBlRGlEbCJ9oZ0KtkiVIbeDT+OgHXQHc7Raq+hOvXfBmQAsJFVxHkMXvw0RvwBxuyG4IsWbT8HQLeFpCDEWSXoCbvEJA6gCyGKBC46C24QEBXAvWOgCTWpG1ispI7ZTX1AQGfhlTdRDpMXCAQTUjqA102QQ91IpggOhEInG0CBwgEJ4rPyLO80DdR5BkXnlEMJOa15SE9PAIsl63HhEASQxkKqIs34ULhFUNZ/EyEJ8YmEk7EzyT9naUTinRKk0yqbSef1lknV1ikShtcS94urtGtuEqXd/kG46fFCd5ocaSbrHfbvPF0a/MkG00m2+puNNvZs2Y7uGu2RYYd7X651e4DQ3YpZAYOODDN+0aeeWKyQ5f02Ld/8FQB+wdP+dFXfvgWx/8TdRx6+nP8/wdWpoH8K7QZOAAAAABJRU5ErkJggg==",mode:""})])),_:2},1032,["onClick"])):g("",!0),A(d,{class:"text-wrap"},{default:i((()=>[f(_(e.total_num),1)])),_:2},1024),e.total_num<e.product_sku.stock_num?(Z(),n(d,{key:1,class:"",onClick:F((t=>s.addFunc(e)),["stop"])},{default:i((()=>[A(R,{class:"add_icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAjVBMVEUAAABpaWlnZ2dmZmZmZmZmZmZmZmZkZGRnZ2dmZmZlZWVmZmZmZmZpaWlmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZWVnZ2dmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZWVmZmZlZWVmZmZmZmZlZWVmZmZmZmYQR7WMAAAALnRSTlMABSb5WO++ERbSQXzVCY8NalLF9Lh2cM7YRSobMd5L4umx5aCrl6bJOGCCiR+blsmQzgAAA9xJREFUWMO1V+caqjAMLVCGlFlApgxlOnj/x7sBR70y1Ot3zy8pcpqk6UmCpuB0JUoto5b83V4E7He+VBtWGik6hz4Ap0Qq9irXz5z+Bifz3crDaqR8wKDz+FhSLROF/gmCmGm0PGJeR+sw+XRbB9cvAr+hEoA2fnDlC+ptystoBbJKik0+GK0VFbGwnYZhamOLVIU2OJRvChLKK9bbhj/+TbqQLoxic3SZM+Mo7MhFGql9w17yg0u8YgeW7mrPbvlY5p5eyTHf2l69A992hZfMMpgtoQK8d08QqoXwnlzYQaCkNefcNzbg5sbAicItHXCCDQ0CtDFUebK/OrzKpaP6JsonKva9Zqjmi3mtEQh9XliR+eacE8sVeyEwWv3v+JEN7F92Z/QWvFXk4CpJuOdFD+InFjj+JNXPuAAbGo9/OiTswveudUYf4dwNDC5+HLQcGnDAdAuUHzJYEqSL8chJnjSCEJwS9DGioyYIDbntqKeF02eGqn9OwKlG1jtFqo8PvKeNHqEvMEZN83huSC9cin1wimZ3MmXZnM3L5BT0YokVDjIc/Bl+zmVNlHZdOptbw7aCdox0pKilczVmihjXTVNPsuPhuFOqCoowhQjY+vyfApCheXLdhihQHKGUgDOXBM0T7OC85wlQcoHQkRRZVSZohJ8n2G4g67fzBDzRhKyykOGKotvF3xPE3fClgWofeEL5ewI5BNv9Gkl78CThvifgEojeXkK+0/tWjL4nQLG16R0fgUo22PwXAhM3oMEI1IXaCyqqWH4P9ikLN8qmoGIIJFJK0TziK8GSToWgCuJIED6XEL5Vbwi7akikqgvvKy0vc28IzHZbS3fQwIEqENDHQr1tzReCVxfk9CD2ixAP6VPGpAPBI4iMwFkmcIDgJYivx2iqR7ofke33uSgMnUI+PIygR9V8OcbXRDIjfDqMuBwOZSOCkU05PIw44cj864wc/5HKrICGGNsjsHXI+j47WPdnHELhfUlldpmYDCo3xC3RoJCSNr6vMIFkl2nlOqPzNZXPaOU6rwkKVKCBACreiqCsS9rVglVJY6L6FQETVSbr3xEwWdcjVlg+J2CFhZW2hV0WrIvupW2tuIIFAwFYsFxc18o7EFjUcag1JYDyvruVd9ZgHJNprtgVpZUdTx0grMFYa3HkBHseTuQJ8dDisAuw3GRBm83z8aRBiFmTxdq85ps2r8xZm/dDo6n/2ur+2mz/2u7/PnBMof8w8vw8dDGhfBn7QsDa2Ddl4FNvbfD0YPD8n6MvG74JDN97NnzvYfgma8P3dPzfjuN/LjqOmI/j/3Zh/P8DDsSbMWz1m30AAAAASUVORK5CYII=",mode:""})])),_:2},1032,["onClick"])):g("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})],64)):(Z(),n(d,{key:1,class:"none-data-box cart_none"},{default:i((()=>[A(R,{class:"cart_none_img",src:"/h5/assets/cart_none-cff73f30.png",mode:"widthFix"}),A(W,{class:"f26 gray9 pt10"},{default:i((()=>[f("購物車空空如也")])),_:1}),A(m,{type:"default",class:"theme-btn mt30 ww100 none_btn",onClick:s.gotoShop},{default:i((()=>[f("去購物")])),_:1},8,["onClick"])])),_:1})),l.tableData.length>0?(Z(),n(d,{key:2,class:"bottom-btns f28"},{default:i((()=>[A(P,{onChange:s.onCheckedAll},{default:i((()=>[A(I,{class:"d-c-c mr20"},{default:i((()=>[A(o,{color:"red",class:"checkbox",checked:l.checkedAll,value:"cb"},null,8,["checked"]),f(" 全選 ")])),_:1})])),_:1},8,["onChange"]),l.isEdit?(Z(),n(d,{key:1,class:""},{default:i((()=>[A(m,{type:"primary",onClick:t[2]||(t[2]=e=>s.onDelete()),class:"delete-btn theme-btn mr20"},{default:i((()=>[f("刪除")])),_:1})])),_:1})):(Z(),n(d,{key:0,class:"d-e-c"},{default:i((()=>[A(d,{class:"total d-s-c flex-1 mr20"},{default:i((()=>[A(W,null,{default:i((()=>[f("合計：")])),_:1}),A(d,{class:"price f22"},{default:i((()=>[f(" ¥ "),A(W,{class:"num f40"},{default:i((()=>[f(_(l.totalPrice),1)])),_:1})])),_:1})])),_:1}),A(m,{type:"primary",class:"buy-btn theme-btn",onClick:t[1]||(t[1]=e=>s.Submit())},{default:i((()=>[f("去結算")])),_:1})])),_:1}))])),_:1})):g("",!0),A(x,{location:10})])),_:1})),A(O)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-68eaf5af"]]);export{I as default};
