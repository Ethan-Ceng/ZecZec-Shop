import{_ as a,E as t,H as e,z as l,B as s,a as o,M as i,o as c,c as d,w as p,n,e as r,g as u,b as _,d as f,t as g,f as m,F as h,r as A,j as y,h as b,i as k,k as w}from"./index-6e5c77a7.js";import{u as C}from"./uni-load-more.58b2601d.js";const F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACc0lEQVQ4T22TvU9TURjGn+e0pbf3FisffoRAWwJGZWJw0MGBQSMYFkGDi6NuhhhwY6BaQwIaTYyf/4IrRo0mYhzUOCGJCYa28qFMxsb23lvoPa+5BZrycYYznI9fnvf3nkMAKCXrj3lK9ylgdi5TnDkBrPvrO0cpXtflBUPnlGDOyBbf+Pv0JzsZHYJCCpA8NUeMXOEjAa8WkO8Id4Z0KA3IaYAvzGzhehXgttcf9SBpUs4D+EbhiJGtQLR/yG0Ld+hQMAXBBQDfFWXMyNjTVYAAqtQePqIZukNInwCzoL4RWXA+uQkjLiqQAjAgwHzAw0h4sTjDzTIrJWwNP4mmTADSC/Ar6N2lqH4RDAnxIyAYDWeL72rL2waoCE1Ej3sKE6CcBZgHJAZgXmncDOeKb3e62QUQgGud0S7tyZQQPSLMgHr0S8Z+3QOUd3amApAWmA4jjaWQU2jI4a8PsRNmtwqoa1rrV2bOnvZrlk6EHTfSvA7HiS3jT1ViMWH2UqkxUD7LukxaS/YvX2w+HovFFvP/CJSlFRG3zrwswqskX0YyBV/sxjsotFtnCD4g0QbIM/Fkyvpp/96KK0kYLq2LAqRARkVw38oW0lXA6iFY+yLRfircAnCQIk/LgnvRXHHVj+1qaxDClCaaFOSxrOmH5rKzUgVUPGwcHADoR2vWWh4p5T0p6+CpgEJagAM+WG+Ct9Jt60I2CeMwrUGA4xrYT+IDRbpBNgrlufYw5aeq7cSuNi61ItIctC4JMQ6wFRAXhO9lstbLngmq0lpglozoFREMg3hvl7zbTSvO8l4/dFeCKiSOBpvmSQZlzlxwlva67K/9B2y0FSC6laY7AAAAAElFTkSuQmCC";const D=a({components:{uniLoadMore:C},data:()=>({loading:!0,statusBarHeight:0,titleBarHeight:0,titleHeight:0,opacity:0,coupon_id:0,listData:[],detail:{},apply_range:10,last_page:0,page:1,list_rows:10,no_more:!1}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onPageScroll(a){a.scrollTop<100?this.opacity=a.scrollTop/100:this.opacity=1},onReady(){t({frontColor:"#000000",backgroundColor:"#FFFFFF"})},onLoad(a){this.coupon_id=a.coupon_id,this.apply_range=a.apply_range,this.GetStatusBarHeight()},onShow(){this.page=1,this.listData=[],this.getData()},onReachBottom(){let a=this;20!=a.apply_range&&(a.page<a.last_page&&(a.page++,a.getData()),a.no_more=!0)},methods:{GetStatusBarHeight(){const a=e();this.statusBarHeight=a.statusBarHeight,this.titleHeight=this.statusBarHeight},getData(){let a=this;a.loading=!0,l({title:"載入中"});let t={coupon_id:a.coupon_id};20!=a.apply_range&&(t.page=a.page||1,t.list_rows=a.list_rows),a._get("coupon.coupon/detail",t,(function(t){s(),a.loading=!1,a.detail=t.data.model,20==a.apply_range?a.listData=t.data.model.product:30==a.apply_range&&(a.listData=a.listData.concat(t.data.product_list.data),a.last_page=t.data.product_list.last_page,t.data.product_list.last_page<=1&&(a.no_more=!0))}))},receiveCoupon(){let a=this;if(0==a.detail.state.value)return!1;a._post("user.coupon/receive",{coupon_id:a.detail.coupon_id},(function(t){o({title:"領取成功",icon:"success",mask:!0,duration:2e3}),a.getData()}))},goback(){i()}}},[["render",function(a,t,e,l,s,o){const i=y,C=u,D=b,v=k,B=w("uni-load-more");return s.loading?r("",!0):(c(),d(C,{key:0,"data-theme":a.theme(),class:n([a.theme()||"","coupon_bg"])},{default:p((()=>[_(C,{class:"coupon-detail-top"},{default:p((()=>[_(C,{class:"top_box"},{default:p((()=>[_(C,{class:"item-wrap"},{default:p((()=>[_(C,{class:n("coupon-item coupon-item-"+s.detail.color.text)},{default:p((()=>[_(C,{class:"operation d-b-c w-b"},{default:p((()=>[_(C,{class:"flex-1 coupon-content"},{default:p((()=>[_(C,{class:"mb20"},{default:p((()=>[_(i,{class:"f40 fb"},{default:p((()=>[f(g(s.detail.name),1)])),_:1})])),_:1}),_(C,{class:"f22 gray9 mb20"},{default:p((()=>[10==s.detail.expire_type?(c(),m(h,{key:0},[f(" 有效期：領取"+g(s.detail.expire_day)+"天內有效 ",1)],64)):r("",!0),20==s.detail.expire_type?(c(),m(h,{key:1},[f(" 有效期："+g(s.detail.start_time.text)+"至"+g(s.detail.end_time.text),1)],64)):r("",!0)])),_:1}),20==s.detail.coupon_type.value?(c(),d(C,{key:0,class:"f22"},{default:p((()=>[f(g(s.detail.max_price>0?"最多抵扣"+1*s.detail.max_price+"元":"無最高抵扣限制"),1)])),_:1})):r("",!0)])),_:1}),_(C,{class:"right-box d-c-c d-c"},{default:p((()=>[10==s.detail.coupon_type.value?(c(),d(C,{key:0,class:"theme-price mb10"},{default:p((()=>[_(i,{class:"f24"},{default:p((()=>[f("￥")])),_:1}),_(i,{class:"f52 fb"},{default:p((()=>[f(g(1*s.detail.reduce_price),1)])),_:1})])),_:1})):r("",!0),20==s.detail.coupon_type.value?(c(),d(C,{key:1,class:"mb10 theme-price"},{default:p((()=>[_(i,{class:"f52 fb"},{default:p((()=>[f(g(s.detail.discount),1)])),_:1}),_(i,{class:"f24"},{default:p((()=>[f("折")])),_:1})])),_:1})):r("",!0),_(C,{class:"f24 mb10"},{default:p((()=>[f(g(s.detail.min_price>0?"滿"+1*s.detail.min_price+"元可用":"無門檻"),1)])),_:1}),s.detail.is_get<=0?(c(),d(C,{key:2,class:"f26 coupon-btn theme-btn",onClick:t[0]||(t[0]=a=>o.receiveCoupon())},{default:p((()=>[f("領取")])),_:1})):(c(),d(D,{key:3,type:"default",class:"f26 coupon-btn btn-gray white"},{default:p((()=>[f("已領取")])),_:1}))])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})])),_:1}),10!=s.apply_range?(c(),d(C,{key:0,class:"redF6 f26 fb pt30 d-c-c"},{default:p((()=>[_(v,{class:"decorate",src:F,mode:"aspectFill"}),_(i,{class:"ml10 mr10"},{default:p((()=>[f("指定以下商品使用")])),_:1}),_(v,{class:"decorate",src:F,mode:"aspectFill"})])),_:1})):r("",!0),10!=s.apply_range?(c(),d(C,{key:1,class:"o-h pro_list"},{default:p((()=>[_(C,{class:"d-b-c f-w"},{default:p((()=>[(c(!0),m(h,null,A(s.listData,((t,e)=>(c(),d(C,{class:"pro_item",key:e,onClick:e=>a.gotoPage("/pages/product/detail/detail?product_id="+t.product_id)},{default:p((()=>[_(C,{class:"pro_item_image"},{default:p((()=>[_(v,{src:t.product_image||"/static/default.png",mode:"aspectFill"},null,8,["src"])])),_:2},1024),_(C,{class:"f26 gray3 text-ellipsis mt20 tc"},{default:p((()=>[f(g(t.product_name),1)])),_:2},1024),_(C,{class:"fb redF6 tc"},{default:p((()=>[_(i,{class:"f22"},{default:p((()=>[f("￥")])),_:1}),_(i,{class:"f32"},{default:p((()=>[f(g(t.product_price),1)])),_:2},1024)])),_:2},1024),_(C,{class:"d-c-c"},{default:p((()=>[_(D,{class:"add_btn"},{default:p((()=>[f("加入購物車")])),_:1})])),_:1})])),_:2},1032,["onClick"])))),128))])),_:1}),0!=s.listData.length||s.loading?(c(),d(B,{key:1,loadingType:o.loadingType},null,8,["loadingType"])):(c(),d(C,{key:0,class:"d-c-c p30 ww100"},{default:p((()=>[_(i,{class:"iconfont icon-wushuju"}),_(i,{class:"cont"},{default:p((()=>[f("親，暫無相關記錄哦")])),_:1})])),_:1}))])),_:1})):r("",!0)])),_:1})])),_:1},8,["data-theme","class"]))}],["__scopeId","data-v-839ccb6f"]]);export{D as default};
