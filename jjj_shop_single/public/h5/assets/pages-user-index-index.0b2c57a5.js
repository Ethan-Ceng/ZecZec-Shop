import{_ as e,v as t,A as a,s as o,z as i,B as s,D as n,a as d,o as r,c as l,w as u,n as c,g as m,b as p,d as g,e as _,h as f,G as h,k as b}from"./index-6e5c77a7.js";import{_ as y}from"./diy.e1652478.js";import{r as P}from"./uni-app.es.5424dc16.js";import"./countdown-act.34a2c1ec.js";import"./upload.182a2719.js";const v=e({components:{diy:y},data:()=>({items:[],loadding:!0,detail:{balance:0,points:0,grade:{name:""}},orderCount:{},coupon:0,sessionKey:"",wxBinding:!1,getPhone:!1}),onShow(){this.getData()},onReady(){t()},onLoad(e){this.wxBinding=a("wxBinding"),e.invitation_id&&o("invitation_id",e.invitation_id),e.referee_id&&o("referee_id",e.referee_id)},methods:{getData(){let e=this;e._post("user.index/detail",{source:e.getPlatform()},(function(t){e.getPage(),e.getPhone=t.data.getPhone,e.detail=t.data.userInfo,e.coupon=t.data.coupon,e.orderCount=t.data.orderCount}))},getPage(){let e=this;i({title:"載入中"}),e._post("user.index/center",{},(function(t){e.items=t.data.page.items,e.setPage(t.data.page.page),e.loadding=!1,s()}))},setPage(e){n({title:e.params.name})},bindMobile(){this.gotoPage("/pages/user/modify-phone/modify-phone")},getPhoneNumber(e){var t=this;if(console.log(e.detail),"getPhoneNumber:ok"!==e.detail.errMsg)return!1;i({title:"正在提交",mask:!0}),t._post("user.user/bindMobile",{session_key:t.sessionKey,encrypted_data:e.detail.encryptedData,iv:e.detail.iv},(e=>{d({title:"繫結成功"}),t.detail.mobile=e.data.mobile}),!1,(()=>{s()}))}}},[["render",function(e,t,a,o,i,s){const n=m,d=f,v=P(h("diy"),y),x=b("tabBar");return r(),l(n,{"data-theme":e.theme(),class:c(e.theme()||"")},{default:u((()=>[p(v,{style:{position:"relative"},diyItems:i.items,userInfo:{detail:i.detail,coupon:i.coupon,orderCount:i.orderCount}},{default:u((()=>[i.getPhone?(r(),l(n,{key:0,class:"bind_phone"},{default:u((()=>[p(n,{class:"bind_content"},{default:u((()=>[p(n,{class:"bind_txt"},{default:u((()=>[g("確保賬戶安全，請繫結手機號")])),_:1}),p(d,{class:"bind_btn",onClick:s.bindMobile},{default:u((()=>[g("去繫結")])),_:1},8,["onClick"])])),_:1})])),_:1})):_("",!0)])),_:1},8,["diyItems","userInfo"]),p(x)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-b05d1a4c"]]);export{v as default};
