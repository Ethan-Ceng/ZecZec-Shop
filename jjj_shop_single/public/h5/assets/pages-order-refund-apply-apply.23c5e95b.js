import{_ as t,A as e,x as a,z as s,B as l,o as d,c as o,w as r,a as i,g as c,b as n,d as u,t as p,n as f,e as m,f as g,r as _,F as b,G as h,K as y,q as x,i as k,j as S,h as w,a0 as I,k as v,a4 as A}from"./index-6e5c77a7.js";import{U}from"./upload.182a2719.js";const F=t({components:{Upload:U},data:()=>({loadding:!0,indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,type:10,isUpload:!1,order_product_id:0,product:{},images:[],temlIds:[],urldata:"",btnAtrrpx:{},mpState:null,form:{}}),onLoad(t){this.order_product_id=t.order_product_id},mounted(){let t=e("mpState");this.mpState=t,this.isWeixin()&&(this.urldata=window.location.href,this.getBtnInfo(),this.getTemplateId()),this.getData()},methods:{subscribeSuccess(){this.formSubmit(),console.log("呼叫成功")},subscribeFail(){this.temlIds=[],this.formSubmit(),console.log("呼叫失敗")},getBtnInfo(){let t=this,e={width:130,height:70,paddingLeft:28,fontSize:28};a({success:function(a){let s=a.screenWidth/750,l={};for(let t in e)l[t]=e[t]*s;t.btnAtrrpx=l},fail(){t.btnAtrrpx=e}})},getTemplateId(){let t=this;t._post("index/getSignPackage",{url:t.urldata,paySource:t.getPlatform()},(function(e){t.mpMessage(e.data.signPackage)}))},getData(){let t=this;s({title:"載入中"});let e=t.order_product_id;t._get("user.refund/apply",{order_product_id:e,platform:t.getPlatform()},(function(e){t.product=e.data.detail,t.temlIds=e.data.template_arr,30==t.product.orderM.delivery_type.value&&(t.type=30),l()}))},tabType(t){this.type=t},formSubmit:function(t){let e=this;var a=e.form;a.type=e.type,a.order_product_id=e.order_product_id,a.content=e.form.content||"",a.images=JSON.stringify(e.images);e.subMessage(e.temlIds,(function(){s({title:"正在提交",mask:!0}),e._post("user.refund/apply",a,(function(t){l(),i({title:t.msg,duration:3e3,complete:function(){e.gotoPage("/pages/order/refund/index/index")}})}))}))},openUpload(){this.isUpload=!0},getImgsFunc(t){let e=this;if(e.isUpload=!1,t&&void 0!==t){let a=e.images.length;if(a+t.length<7)e.images=e.images.concat(t);else{let s=6-a;for(let a=0;a<s;a++)e.images.push(t[a])}}},deleteFunc(t){this.images.splice(t,1)}}},[["render",function(t,e,a,s,l,i){const U=k,F=c,C=S,M=w,T=I,z=v("wx-open-subscribe"),L=A,P=v("Upload");return d(),o(F,{class:"refund-apply pb100"},{default:r((()=>[n(L,{onSubmit:i.formSubmit,onReset:t.formReset},{default:r((()=>[n(F,{class:"one-product d-s-c p30 bg-white"},{default:r((()=>[n(F,{class:"cover"},{default:r((()=>[n(U,{src:l.product.image&&l.product.image.file_path,mode:"aspectFit"},null,8,["src"])])),_:1}),n(F,{class:"flex-1"},{default:r((()=>[n(F,{class:"pro-info"},{default:r((()=>[u(p(l.product.product_name),1)])),_:1}),n(F,{class:"pt10 p-0-30 f24 gray9"},{default:r((()=>[n(C,{class:""},{default:r((()=>[u(" 單價：¥"+p(l.product.line_price),1)])),_:1}),n(C,{class:"ml20"},{default:r((()=>[u(" 數量："+p(l.product.total_num),1)])),_:1})])),_:1})])),_:1})])),_:1}),n(F,{class:"group bg-white"},{default:r((()=>[n(F,{class:"group-hd border-b-e"},{default:r((()=>[n(F,{class:"left"},{default:r((()=>[n(C,{class:"min-name"},{default:r((()=>[u("服務型別")])),_:1})])),_:1})])),_:1}),l.product.orderM?(d(),o(F,{key:0,class:"d-s-c p-20-0"},{default:r((()=>[30!=l.product.orderM.delivery_type.value?(d(),o(M,{key:0,type:"default",class:f(10==l.type?"btn-red-border":""),onClick:e[0]||(e[0]=t=>i.tabType(10))},{default:r((()=>[u("退貨/退款")])),_:1},8,["class"])):m("",!0),30!=l.product.orderM.delivery_type.value?(d(),o(M,{key:1,type:"default",class:f(20==l.type?"ml20 btn-red-border":"ml20"),onClick:e[1]||(e[1]=t=>i.tabType(20))},{default:r((()=>[u("換貨")])),_:1},8,["class"])):m("",!0),n(M,{type:"default",class:f(30==l.type?"ml20 btn-red-border":"ml20"),onClick:e[2]||(e[2]=t=>i.tabType(30))},{default:r((()=>[u("僅退款")])),_:1},8,["class"])])),_:1})):m("",!0)])),_:1}),n(F,{class:"group bg-white"},{default:r((()=>[n(F,{class:"group-hd"},{default:r((()=>[n(F,{class:"left"},{default:r((()=>[n(C,{class:"min-name"},{default:r((()=>[u("申請原因")])),_:1})])),_:1})])),_:1}),n(F,{class:"d-s-c"},{default:r((()=>[n(T,{modelValue:l.form.content,"onUpdate:modelValue":e[3]||(e[3]=t=>l.form.content=t),class:"p10 box-s-b border flex-1 f28 lh150",name:"content",placeholder:"請詳細填寫申請原因，注意保持商品的完好，建議您先與賣家溝通"},null,8,["modelValue"])])),_:1})])),_:1}),10==l.type||30==l.type?(d(),o(F,{key:0,class:"group bg-white"},{default:r((()=>[n(F,{class:"group-hd"},{default:r((()=>[n(F,{class:"left"},{default:r((()=>[n(C,{class:"min-name"},{default:r((()=>[u("退款金額：")])),_:1}),n(C,{class:"red f30"},{default:r((()=>[u("¥"+p(l.product.total_pay_price),1)])),_:1})])),_:1})])),_:1})])),_:1})):m("",!0),n(F,{class:"group bg-white"},{default:r((()=>[n(F,{class:"group-hd"},{default:r((()=>[n(F,{class:"left"},{default:r((()=>[n(C,{class:"min-name"},{default:r((()=>[u("上傳憑證")])),_:1}),n(C,{class:"gray9"},{default:r((()=>[u("(最多6張)")])),_:1})])),_:1})])),_:1}),n(F,{class:"upload-list d-s-c"},{default:r((()=>[(d(!0),g(b,null,_(l.images,((t,e)=>(d(),o(F,{class:"item",key:e,onClick:e=>i.deleteFunc(t)},{default:r((()=>[n(U,{src:t.file_path,mode:"aspectFit"},null,8,["src"])])),_:2},1032,["onClick"])))),128)),l.images.length<6?(d(),o(F,{key:0,class:"item d-c-c d-stretch"},{default:r((()=>[n(F,{class:"upload-btn d-c-c d-c flex-1",onClick:e[4]||(e[4]=t=>i.openUpload())},{default:r((()=>[n(C,{class:"icon iconfont icon-xiangji f34"}),n(C,{class:"gray9"},{default:r((()=>[u("上傳圖片")])),_:1})])),_:1})])),_:1})):m("",!0)])),_:1})])),_:1}),n(F,{class:"foot-btns"},{default:r((()=>[t.isWeixin()&&1==l.mpState&&""!=l.temlIds?(d(),o(z,{key:0,template:l.temlIds,id:"subscribe-btn",onSuccess:i.subscribeSuccess,onError:i.subscribeFail},{default:r((()=>[(d(),o(h("script"),{type:"text/wxtag-template",slot:"style"},{default:r((()=>[(d(),o(h("style"),null,{default:r((()=>[u(" #subscribe-btn{ width: 100%; } .subscribe-btn{ border: 1px solid #f6220c; background: #f6220c; color: #fff; border-radius:5px; float: right; } ")])),_:1}))])),_:1})),(d(),o(h("script"),{type:"text/wxtag-template"},{default:r((()=>[y("div",{class:"subscribe-btn",style:x({width:l.btnAtrrpx.width+"px",height:l.btnAtrrpx.height+"px",lineHeight:l.btnAtrrpx.height+"px",paddingLeft:l.btnAtrrpx.paddingLeft+"px",paddingRight:l.btnAtrrpx.paddingLeft+"px",fontSize:l.btnAtrrpx.fontSize+"px"})}," 確認提交 ",4)])),_:1}))])),_:1},8,["template","onSuccess","onError"])):(d(),o(M,{key:1,class:"btn-red",onClick:i.formSubmit},{default:r((()=>[u("確認提交")])),_:1},8,["onClick"]))])),_:1})])),_:1},8,["onSubmit","onReset"]),l.isUpload?(d(),o(P,{key:0,onGetImgs:i.getImgsFunc},null,8,["onGetImgs"])):m("",!0)])),_:1})}]]);export{F as default};
