import{_ as e,x as s,a as o,z as l,s as t,A as a,B as i,J as d,L as n,o as r,c,w as u,n as p,q as g,g as f,b as _,d as m,t as b,e as w,u as h,j as x,I as v,h as k,i as C}from"./index-6e5c77a7.js";const A=e({data:()=>({formData:{mobile:"",code:""},loging_password:"",register:{mobile:"",password:"",repassword:"",code:""},resetpassword:{mobile:"",password:"",repassword:"",code:""},is_send:!1,send_btn_txt:"獲取驗證碼",second:60,ip:"",isShow:!0,is_login:1,is_code:!1,phoneHeight:0,isRead:!1,showWeixin:!1,showApple:!1}),onShow(){this.init()},methods:{init(){let e=this;s({success(s){e.phoneHeight=s.windowHeight}}),plus.runtime.isApplicationExist({pname:"com.tencent.mm",action:"weixin://"})&&(e.showWeixin=!0),s({success:s=>{s.system.replace(/iOS /,""),"ios"==s.platform&&(e.showApple=!0)}})},formSubmit(){let e=this,s={mobile:e.formData.mobile},d="";if(e.isRead){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile))return console.log(e.formData.mobile),void o({title:"手機有誤,請重填！",duration:2e3,icon:"none"});if(e.is_code){if(console.log(e.is_code),""==e.formData.code)return void o({title:"驗證碼不能為空！",duration:2e3,icon:"none"});s.code=e.formData.code,d="user.useropen/smslogin"}else{if(""==e.loging_password)return void o({title:"密碼不能為空！",duration:2e3,icon:"none"});s.password=e.loging_password,d="user.useropen/phonelogin"}l({title:"正在提交"}),e._post(d,s,(s=>{t("token",s.data.token),t("user_id",s.data.user_id);let o=a("currentPage"),l=a("currentPageOptions");if(Object.keys(l).length>0){o+="?";for(let e in l)o+=e+"="+l[e]+"&";o=o.substring(0,o.length-1)}e.gotoPage(o)}),!1,(()=>{i()}))}else o({title:"請同意並勾選協議內容",duration:2e3,icon:"none"})},registerSub(){let e=this;if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.register.mobile))return console.log(e.register.mobile),void o({title:"手機有誤,請重填！",duration:2e3,icon:"none"});""!=e.register.code?e.register.password.length<6?o({title:"密碼至少6位數！",duration:2e3,icon:"none"}):e.register.password===e.register.repassword?e.isRead?(e.register.invitation_id=a("invitation_id")?a("invitation_id"):0,e.register.reg_source="app",e.register.referee_id=a("referee_id"),l({title:"正在提交"}),e._post("user.useropen/register",e.register,(s=>{o({title:"註冊成功",duration:3e3}),e.formData.mobile=e.register.mobile,e.register={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{i()}))):o({title:"請同意並勾選協議內容",duration:2e3,icon:"none"}):o({title:"兩次密碼輸入不一致！",duration:2e3,icon:"none"}):o({title:"驗證碼不能為空！",duration:2e3,icon:"none"})},resetpasswordSub(){let e=this;/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile)?""!=e.resetpassword.code?e.resetpassword.password.length<6?o({title:"密碼至少6位數！",duration:2e3,icon:"none"}):e.resetpassword.password===e.resetpassword.repassword?(l({title:"正在提交"}),e._post("user.useropen/resetpassword",e.resetpassword,(s=>{o({title:"重置成功",duration:3e3}),e.formData.mobile=e.resetpassword.mobile,e.resetpassword={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{i()}))):o({title:"兩次密碼輸入不一致！",duration:2e3,icon:"none"}):o({title:"驗證碼不能為空！",duration:2e3,icon:"none"}):o({title:"手機有誤,請重填！",duration:2e3,icon:"none"})},isCode(){this.is_code?this.is_code=!1:this.is_code=!0,console.log(this.is_code)},sendCode(){let e=this;if(1==e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile))return void o({title:"手機有誤,請重填！",duration:2e3,icon:"none"})}else if(2==e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.register.mobile))return void o({title:"手機有誤,請重填！",duration:2e3,icon:"none"})}else if(0==e.is_login&&!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile))return void o({title:"手機有誤,請重填！",duration:2e3,icon:"none"});let s="register",l=e.register.mobile;1==e.is_login?(s="login",l=e.formData.mobile):0==e.is_login&&(s="login",l=e.resetpassword.mobile),e._post("user.useropen/sendCode",{mobile:l,type:s},(s=>{1==s.code&&(o({title:"傳送成功"}),e.is_send=!0,e.changeMsg())}))},login(){let e=this;plus.oauth.getServices((function(s){let o=s[0];o.authResult?console.log("已經登陸認證"):o.authorize((function(s){l({title:"登入中",mask:!0}),e._post("user.useropen/login",{code:s.code,source:"app"},(s=>{t("token",s.data.token),t("user_id",s.data.user_id);let o=a("currentPage");console.log("url="+o);let l=a("currentPageOptions");if(Object.keys(l).length>0){o+="?";for(let e in l)o+=e+"="+l[e]+"&";o=o.substring(0,o.length-1)}console.log("url 1="+o),e.gotoPage(o)}),!1,(()=>{i()}))}),(function(e){console.log("登陸認證失敗!"),d({title:"認證失敗1",content:JSON.stringify(e)})}))}),(function(e){console.log("獲取服務列表失敗："+JSON.stringify(e))}))},changeMsg(){this.second>0?(this.send_btn_txt=this.second+"秒",this.second--,setTimeout(this.changeMsg,1e3)):(this.send_btn_txt="獲取驗證碼",this.second=60,this.is_send=!1)},xieyi(e){this.gotoPage("/pages/webview/ue?type="+e)},appleLogin(){let e=this;n({provider:"apple",success:function(s){uni.getUserInfo({provider:"apple",success(s){if("getUserInfo:ok"!==s.errMsg)return!1;l({title:"正在登入",mask:!0}),e._post("user.userapple/login",{invitation_id:e.invitation_id,openId:s.userInfo.openId,nickName:s.userInfo.fullName.giveName?s.userInfo.fullName.giveName:"",referee_id:a("referee_id"),source:"apple"},(s=>{t("token",s.data.token),t("user_id",s.data.user_id);let o=a("currentPage"),l=a("currentPageOptions");if(Object.keys(l).length>0){o+="?";for(let e in l)o+=e+"="+l[e]+"&";o=o.substring(0,o.length-1)}e.gotoPage(o)}),!1,(()=>{i()}))}})},fail:function(e){console.log("登入失敗"),console.log(e)}})}}},[["render",function(e,s,o,l,t,a){const i=f,d=x,n=v,A=k,y=C;return r(),c(i,{"data-theme":e.theme(),class:p([e.theme()||"","login-container"]),style:g("height: "+t.phoneHeight+"px;")},{default:u((()=>[_(i,{class:"skip",onClick:s[0]||(s[0]=s=>e.gotoPage("/pages/index/index"))},{default:u((()=>[m("跳過→")])),_:1}),2==t.is_login?(r(),c(i,{key:0,class:"p-30-75"},{default:u((()=>[_(i,{class:"login_topbpx"},{default:u((()=>[_(i,{class:"login_tit"},{default:u((()=>[m("註冊")])),_:1}),_(i,{class:"login_top"},{default:u((()=>[m("已有賬戶，"),_(d,{class:"dominant",onClick:s[1]||(s[1]=e=>t.is_login=1)},{default:u((()=>[m("立即登入")])),_:1})])),_:1})])),_:1}),_(i,{class:"group-bd"},{default:u((()=>[_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",modelValue:t.register.mobile,"onUpdate:modelValue":s[2]||(s[2]=e=>t.register.mobile=e),placeholder:"請填寫手機號",disabled:t.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",password:"true",modelValue:t.register.password,"onUpdate:modelValue":s[3]||(s[3]=e=>t.register.password=e),placeholder:"請輸入密碼"},null,8,["modelValue"])])),_:1})])),_:1}),_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",password:"true",modelValue:t.register.repassword,"onUpdate:modelValue":s[4]||(s[4]=e=>t.register.repassword=e),placeholder:"請確認密碼"},null,8,["modelValue"])])),_:1})])),_:1}),_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 d-b-c input_botom"},{default:u((()=>[_(n,{class:"flex-1",type:"number",modelValue:t.register.code,"onUpdate:modelValue":s[5]||(s[5]=e=>t.register.code=e),placeholder:"請填寫驗證碼"},null,8,["modelValue"]),_(A,{class:"get-code-btn",type:"default",onClick:a.sendCode,disabled:t.is_send},{default:u((()=>[m(b(t.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})])),_:1})):w("",!0),1==t.is_login?(r(),c(i,{key:1,class:"p-30-75"},{default:u((()=>[_(i,{class:"login_topbpx"},{default:u((()=>[_(i,{class:"login_tit"},{default:u((()=>[m("登入")])),_:1}),_(i,{class:"login_top"},{default:u((()=>[m("還沒有賬號，"),_(d,{class:"dominant",onClick:s[6]||(s[6]=e=>t.is_login=2)},{default:u((()=>[m("立即註冊")])),_:1})])),_:1})])),_:1}),_(i,{class:"group-bd"},{default:u((()=>[_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",modelValue:t.formData.mobile,"onUpdate:modelValue":s[7]||(s[7]=e=>t.formData.mobile=e),placeholder:"請填寫手機號"},null,8,["modelValue"])])),_:1})])),_:1}),t.is_code?w("",!0):(r(),c(i,{key:0,class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",password:"true",modelValue:t.loging_password,"onUpdate:modelValue":s[8]||(s[8]=e=>t.loging_password=e),placeholder:"請輸入密碼"},null,8,["modelValue"])])),_:1})])),_:1})),t.is_code?(r(),c(i,{key:1,class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 d-b-c input_botom"},{default:u((()=>[_(n,{class:"flex-1",type:"number",modelValue:t.formData.code,"onUpdate:modelValue":s[9]||(s[9]=e=>t.formData.code=e),placeholder:"請填寫驗證碼"},null,8,["modelValue"]),_(A,{class:"get-code-btn",type:"default",onClick:a.sendCode,disabled:t.is_send},{default:u((()=>[m(b(t.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})):w("",!0)])),_:1})])),_:1})):w("",!0),0==t.is_login?(r(),c(i,{key:2,class:"p-30-75"},{default:u((()=>[_(i,{class:"login_topbpx"},{default:u((()=>[_(i,{class:"login_tit"},{default:u((()=>[m("重置密碼")])),_:1}),_(i,{class:"login_top"},{default:u((()=>[_(d,{class:"dominant",onClick:s[10]||(s[10]=e=>t.is_login=1)},{default:u((()=>[m("立即登入")])),_:1})])),_:1})])),_:1}),_(i,{class:"group-bd"},{default:u((()=>[_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",modelValue:t.resetpassword.mobile,"onUpdate:modelValue":s[11]||(s[11]=e=>t.resetpassword.mobile=e),placeholder:"請填寫手機號",disabled:t.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",password:"true",modelValue:t.resetpassword.password,"onUpdate:modelValue":s[12]||(s[12]=e=>t.resetpassword.password=e),placeholder:"請輸入密碼"},null,8,["modelValue"])])),_:1})])),_:1}),_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 input_botom"},{default:u((()=>[_(n,{type:"text",password:"true",modelValue:t.resetpassword.repassword,"onUpdate:modelValue":s[13]||(s[13]=e=>t.resetpassword.repassword=e),placeholder:"請確認密碼"},null,8,["modelValue"])])),_:1})])),_:1}),_(i,{class:"form-level d-s-c"},{default:u((()=>[_(i,{class:"val flex-1 d-b-c input_botom"},{default:u((()=>[_(n,{class:"flex-1",type:"number",modelValue:t.resetpassword.code,"onUpdate:modelValue":s[14]||(s[14]=e=>t.resetpassword.code=e),placeholder:"請填寫驗證碼"},null,8,["modelValue"]),_(A,{class:"get-code-btn",type:"default",onClick:a.sendCode,disabled:t.is_send},{default:u((()=>[m(b(t.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})])),_:1})):w("",!0),1==t.is_login?(r(),c(i,{key:3,class:p(["gray6 p-0-75",t.is_code?"d-e-c":"d-b-c"])},{default:u((()=>[t.is_code?w("",!0):(r(),c(i,{key:0,onClick:s[15]||(s[15]=e=>t.is_login=0)},{default:u((()=>[m("忘記密碼?")])),_:1})),_(i,{onClick:s[16]||(s[16]=e=>a.isCode())},{default:u((()=>[m(b(t.is_code?"使用密碼登入":"使用驗證碼登入"),1)])),_:1})])),_:1},8,["class"])):w("",!0),_(i,{onClick:s[19]||(s[19]=e=>t.isRead=!t.isRead),class:"d-s-c gray6 p-0-75 mt20"},{default:u((()=>[_(i,{class:p(t.isRead?"active agreement":"agreement")},null,8,["class"]),m("我已閱讀並接受"),_(d,{class:"dominant",onClick:s[17]||(s[17]=h((e=>a.xieyi("service")),["stop"]))},{default:u((()=>[m("《使用者協議》")])),_:1}),m("和"),_(d,{class:"dominant",onClick:s[18]||(s[18]=h((e=>a.xieyi("privacy")),["stop"]))},{default:u((()=>[m("《隱私政策》")])),_:1})])),_:1}),2==t.is_login?(r(),c(i,{key:4,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[_(A,{onClick:a.registerSub},{default:u((()=>[m("註冊")])),_:1},8,["onClick"])])),_:1})):w("",!0),1==t.is_login?(r(),c(i,{key:5,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[_(A,{onClick:a.formSubmit},{default:u((()=>[m("登入")])),_:1},8,["onClick"])])),_:1})):w("",!0),0==t.is_login?(r(),c(i,{key:6,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[_(A,{onClick:a.resetpasswordSub},{default:u((()=>[m("重置密碼")])),_:1},8,["onClick"])])),_:1})):w("",!0),1==t.is_login?(r(),c(i,{key:7,class:"bottom_nav"},{default:u((()=>[_(i,{class:"bottom-box"},{default:u((()=>[_(i,{class:"other_tit"},{default:u((()=>[_(d,{class:"bg-white p-0-20"},{default:u((()=>[m("其他方式登入")])),_:1})])),_:1}),t.showWeixin?(r(),c(i,{key:0,class:"pt30 d-c-c"},{default:u((()=>[_(i,{class:"weixin_box",onClick:a.login},{default:u((()=>[_(d,{class:"icon iconfont icon-weixin"})])),_:1},8,["onClick"])])),_:1})):w("",!0),t.showApple?(r(),c(i,{key:1},{default:u((()=>[_(y,{onClick:a.appleLogin,class:"ios-login",src:"data:image/png;base64,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",mode:"aspectFill"},null,8,["onClick"])])),_:1})):w("",!0)])),_:1})])),_:1})):w("",!0)])),_:1},8,["data-theme","class","style"])}],["__scopeId","data-v-8205a707"]]);export{A as default};
