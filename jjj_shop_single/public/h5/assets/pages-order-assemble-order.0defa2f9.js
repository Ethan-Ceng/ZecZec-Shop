import{_ as e,x as t,y as a,z as s,J as o,B as l,a as r,o as i,c,w as d,n,g as u,b as p,d as _,f,r as h,F as g,q as m,j as y,i as k,S as v,k as b,t as w,e as C,h as D}from"./index-6e5c77a7.js";import{P}from"./uni-popup.f3f35788.js";import{u as T}from"./uni-load-more.58b2601d.js";import{p as F}from"./pay.b165a721.js";/* empty css                                                                  */const x=e({components:{Popup:P,uniLoadMore:T},data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:0,topRefresh:!1,listData:[],dataType:10,isPayPopup:!1,pay_type:20,order_id:0,last_page:0,page:1,list_rows:10,no_more:!1,loading:!0,isCodeImg:!1,codeImg:""}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onLoad(e){},mounted(){this.init()},onShow(){this.page=1,this.listData=[],this.getData()},methods:{init(){let e=this;t({success(t){e.phoneHeight=t.windowHeight,a().select(".top-tabbar").boundingClientRect((t=>{let a=e.phoneHeight-t.height;e.scrollviewHigh=a})).exec()}})},stateFunc(e){let t=this;if(t.state_active!=e&&!t.loading){switch(t.page=1,t.loading=!0,t.state_active=e,e){case 0:t.listData=[],t.dataType=10;break;case 1:t.listData=[],t.dataType=20;break;case 2:t.listData=[],t.dataType=30;break;case 3:t.listData=[],t.dataType=40;break;case 4:t.listData=[],t.dataType=50}t.getData()}},scrolltolowerFunc(){let e=this;e.no_more||(e.page++,e.page<=e.last_page?e.getData():e.no_more=!0)},getData(){let e=this;e.loading=!0;let t=e.dataType;e._get("user.Assemble/lists",{type:t,page:e.page,list_rows:e.list_rows},(function(t){e.loading=!1,e.listData=e.listData.concat(t.data.list.data),e.last_page=t.data.list.last_page,t.data.list.last_page<=1?e.no_more=!0:e.no_more=!1}))},countDown(e){let t=e-Date.now()/1e3,a=Math.floor(t/86400),s=t%86400,o=Math.floor(s/3600);s%=3600;let l=Math.floor(s/60),r=s%60;return a=this.convertTwo(a),o=this.convertTwo(o),l=this.convertTwo(l),r=this.convertTwo(r),parseInt(a)>0?parseInt(a)+"天 ":parseInt(o)+"時"+parseInt(l)+"分"+parseInt(r)+"秒"},gotoOrder(e){this.gotoPage("/pages/order/order-detail?order_id="+e)},hidePopupFunc(){this.isPayPopup=!1},payTypeFunc(e){let t=this;t.isPayPopup=!1,s({title:"載入中"}),t._post("user.order/pay",{payType:e,order_id:t.order_id,pay_source:t.getPlatform()},(function(e){F(e,t)}))},depositPay(e){this.gotoPage("/pages/order/confirm-order?order_type=retainage&order_id="+e)},onPayOrder(e){this.gotoPage("/pages/order/cashier?order_id="+e)},orderReceipt(e){let t=this;o({title:"提示",content:"您確定要收貨嗎?",success:function(a){a.confirm?(s({title:"正在處理"}),t._post("user.order/receipt",{order_id:e},(function(e){l(),r({title:e.msg,duration:2e3,icon:"success"}),t.listData=[],t.getData()}))):r({title:"取消收貨",duration:1e3,icon:"none"})}})},cancelAdvance(e){let t=this,a=e;o({title:"提示",content:"您確定要取消嗎?",success:function(e){e.confirm&&(s({title:"正在處理"}),t._get("plus.advance.Order/cancelFront",{order_id:a},(function(e){l(),r({title:"操作成功",duration:2e3,icon:"success"}),t.listData=[],t.getData()})))}})},cancelOrder(e){let t=this,a=e;o({title:"提示",content:"您確定要取消嗎?",success:function(e){e.confirm&&(s({title:"正在處理"}),t._get("user.order/cancel",{order_id:a},(function(e){l(),r({title:"操作成功",duration:2e3,icon:"success"}),t.listData=[],t.getData()})))}})},nowOverTime:e=>(new Date).getTime()>=new Date(1e3*e).getTime(),gotoEvaluate(e){this.gotoPage("/pages/order/evaluate/evaluate?order_id="+e)},onQRCode(e){let t=this;s({title:"載入中"});let a=e;t._get("user.order/qrcode",{order_id:a,source:t.getPlatform()},(function(e){l(),t.isCodeImg=!0,t.codeImg=e.data.qrcode}))},hideCodePopupFunc(){this.isCodeImg=!1},gotoAssembleShare(e){let t="/pages/plus/assemble/fight-group-detail/fight-group-detail?assemble_bill_id="+e;this.gotoPage(t)}}},[["render",function(e,t,a,s,o,l){const r=u,P=y,T=k,F=v,x=D,I=b("uni-load-more"),H=b("Popup"),O=b("tabBar");return i(),c(r,{"data-theme":e.theme(),class:n(e.theme()||"")},{default:d((()=>[p(r,{class:"top-tabbar"},{default:d((()=>[p(r,{class:n(0==o.state_active?"tab-item active":"tab-item"),onClick:t[0]||(t[0]=e=>l.stateFunc(0))},{default:d((()=>[_("全部")])),_:1},8,["class"]),p(r,{class:n(1==o.state_active?"tab-item active":"tab-item"),onClick:t[1]||(t[1]=e=>l.stateFunc(1))},{default:d((()=>[_("待付款")])),_:1},8,["class"]),p(r,{class:n(2==o.state_active?"tab-item active":"tab-item"),onClick:t[2]||(t[2]=e=>l.stateFunc(2))},{default:d((()=>[_("拼團中")])),_:1},8,["class"]),p(r,{class:n(3==o.state_active?"tab-item active":"tab-item"),onClick:t[3]||(t[3]=e=>l.stateFunc(3))},{default:d((()=>[_("拼團成功")])),_:1},8,["class"]),p(r,{class:n(4==o.state_active?"tab-item active":"tab-item"),onClick:t[4]||(t[4]=e=>l.stateFunc(4))},{default:d((()=>[_("拼團失敗")])),_:1},8,["class"])])),_:1}),p(F,{"scroll-y":"true",class:"scroll-Y",style:m("height:"+o.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:l.scrolltolowerFunc},{default:d((()=>[p(r,{class:n(o.topRefresh?"top-refresh open":"top-refresh")},{default:d((()=>[(i(),f(g,null,h(3,((e,t)=>p(r,{class:"circle",key:t}))),64))])),_:1},8,["class"]),p(r,{class:"order-list"},{default:d((()=>[(i(!0),f(g,null,h(o.listData,((e,t)=>(i(),c(r,{class:"item",key:t},{default:d((()=>[p(r,{class:"order-head d-b-c"},{default:d((()=>[p(r,null,{default:d((()=>[p(P,{class:"state-text"},{default:d((()=>[_(w(e.order_source_text),1)])),_:2},1024),p(P,{class:"shop-name flex-1 fb"},{default:d((()=>[_("訂單號："+w(e.order_no),1)])),_:2},1024)])),_:2},1024),p(r,{class:"state"},{default:d((()=>[p(P,{class:"red"},{default:d((()=>[_(w(e.state_text),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.product.length>1?(i(),c(r,{key:0,class:"product-list pr",onClick:t=>l.gotoOrder(e.order_id)},{default:d((()=>[p(F,{"scroll-x":"true"},{default:d((()=>[p(r,{class:"list d-s-c pr100"},{default:d((()=>[(i(!0),f(g,null,h(e.product,((e,t)=>(i(),c(r,{class:"cover mr10",key:t},{default:d((()=>[p(T,{src:e.image.file_path,mode:"aspectFit"},null,8,["src"])])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024),p(r,{class:"total-count"},{default:d((()=>[p(r,{class:"left-shadow"}),p(r,{class:"price f22 theme-price"},{default:d((()=>[_(" ¥ "),p(P,{class:"f40 theme-price"},{default:d((()=>[_(w(e.pay_price),1)])),_:2},1024)])),_:2},1024),p(r,{class:"count"},{default:d((()=>[_("共"+w(e.product.length)+"件",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):(i(),c(r,{key:1,class:"one-product d-s-c",onClick:t=>l.gotoOrder(e.order_id)},{default:d((()=>[(i(!0),f(g,null,h(e.product,((e,t)=>(i(),c(r,{class:"cover",key:t},{default:d((()=>[p(T,{src:e.image.file_path,mode:"aspectFit"},null,8,["src"])])),_:2},1024)))),128)),p(r,{class:"pro-info flex-1"},{default:d((()=>[_(w(e.product[0].product_name),1)])),_:2},1024),p(r,{class:"total-count"},{default:d((()=>[p(r,{class:"left-shadow"}),p(r,{class:"price theme-price f22"},{default:d((()=>[_(" ¥ "),80==e.order_source?(i(),c(P,{key:0,class:"f40 theme-price"},{default:d((()=>[_(w((1*e.pay_price+1*e.advance.pay_price).toFixed(2)),1)])),_:2},1024)):(i(),c(P,{key:1,class:"f40 theme-price"},{default:d((()=>[_(w(e.pay_price),1)])),_:2},1024))])),_:2},1024),p(r,{class:"count"},{default:d((()=>[_("共"+w(e.product[0].total_num)+"件",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])),p(r,{class:"order-bts"},{default:d((()=>[10==e.order_status.value?(i(),f(g,{key:0},[10==e.pay_status.value?(i(),c(x,{key:0,onClick:t=>l.cancelOrder(e.order_id),class:"theme-borderbtn"},{default:d((()=>[_("取消")])),_:2},1032,["onClick"])):C("",!0),20==e.pay_status.value&&10==e.delivery_status.value?(i(),c(x,{key:1,onClick:t=>l.cancelOrder(e.order_id),class:"theme-borderbtn"},{default:d((()=>[_("申請取消")])),_:2},1032,["onClick"])):C("",!0),20==e.pay_status.value&&20==e.delivery_type.value&&10==e.delivery_status.value?(i(),f(g,{key:2},[30==e.order_source&&20==e.assemble_status?(i(),c(x,{key:0,onClick:t=>l.onQRCode(e.order_id),class:"theme-borderbtn"},{default:d((()=>[_("核銷碼")])),_:2},1032,["onClick"])):C("",!0),30!=e.order_source?(i(),c(x,{key:1,onClick:t=>l.onQRCode(e.order_id),class:"theme-borderbtn"},{default:d((()=>[_("核銷碼")])),_:2},1032,["onClick"])):C("",!0)],64)):C("",!0),10==e.pay_status.value?(i(),c(x,{key:3,class:"theme-btn",onClick:t=>l.onPayOrder(e.order_id)},{default:d((()=>[_("付款")])),_:2},1032,["onClick"])):C("",!0),20==e.delivery_status.value&&10==e.receipt_status.value?(i(),c(x,{key:4,class:"theme-btn",onClick:t=>l.orderReceipt(e.order_id)},{default:d((()=>[_("確認收貨")])),_:2},1032,["onClick"])):C("",!0)],64)):C("",!0),21==e.order_status.value?(i(),c(P,{key:1,class:"count"},{default:d((()=>[_("取消申請中")])),_:1})):C("",!0),30==e.order_status.value&&0==e.is_comment?(i(),c(x,{key:2,class:"theme-btn",onClick:t=>l.gotoEvaluate(e.order_id)},{default:d((()=>[_("評價")])),_:2},1032,["onClick"])):C("",!0),10==e.assemble_status&&30==e.order_source?(i(),c(x,{key:3,class:"theme-btn",onClick:t=>l.gotoAssembleShare(e.product[0].bill_source_id)},{default:d((()=>[_("邀請好友拼單")])),_:2},1032,["onClick"])):C("",!0)])),_:2},1024)])),_:2},1024)))),128)),0!=o.listData.length||o.loading?(i(),c(I,{key:1,loadingType:l.loadingType},null,8,["loadingType"])):(i(),c(r,{key:0,class:"d-c-c p30"},{default:d((()=>[p(P,{class:"iconfont icon-wushuju"}),p(P,{class:"cont"},{default:d((()=>[_("親，暫無相關記錄哦")])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"]),p(H,{show:o.isCodeImg,type:"middle",onHidePopup:l.hideCodePopupFunc},{default:d((()=>[p(r,{class:"ww100 p20 box-s-b"},{default:d((()=>[p(T,{class:"ww100",src:o.codeImg,mode:"widthFix"},null,8,["src"])])),_:1})])),_:1},8,["show","onHidePopup"]),p(O)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-4c5c14e6"]]);export{x as default};
