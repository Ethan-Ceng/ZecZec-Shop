import{_ as t,x as e,y as a,z as s,J as o,B as l,a as i,o as c,c as d,w as r,n,g as u,b as p,d as _,f as g,r as h,F as f,q as m,j as y,k as b,S as v,t as w,e as D,i as T}from"./index-6e5c77a7.js";import{u as P}from"./uni-load-more.58b2601d.js";const k=t({components:{uniLoadMore:P},data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:0,topRefresh:!1,listData:[],dataType:"all",isPayPopup:!1,pay_type:20,order_id:0,last_page:0,page:1,list_rows:10,no_more:!1,loading:!0,isCodeImg:!1,codeImg:""}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onLoad(t){void 0!==t.dataType&&(this.dataType=t.dataType),"wait"==this.dataType?this.state_active=1:"send"==this.dataType&&(this.state_active=2)},mounted(){this.init(),this.getData()},methods:{init(){let t=this;e({success(e){t.phoneHeight=e.windowHeight,a().select(".top-tabbar").boundingClientRect((e=>{let a=t.phoneHeight-e.height;t.scrollviewHigh=a})).exec()}})},stateFunc(t){let e=this;if(e.state_active!=t){switch(e.page=1,e.loading=!0,e.state_active=t,t){case 0:e.listData=[],e.dataType="all";break;case 1:e.listData=[],e.dataType="wait";break;case 2:e.listData=[],e.dataType="send"}e.getData()}},scrolltolowerFunc(){let t=this;t.no_more||(t.page++,t.page<=t.last_page?t.getData():t.no_more=!0)},getData(){let t=this;t.loading=!0;let e=t.dataType;t._get("card.order/lists",{dataType:e,page:t.page,list_rows:t.list_rows},(function(e){t.loading=!1,t.listData=t.listData.concat(e.data.list.data),t.last_page=e.data.list.last_page,e.data.list.last_page<=1?t.no_more=!0:t.no_more=!1}))},gotoOrder(t){this.gotoPage("/pages/order/code-order-detail?order_id="+t)},hidePopupFunc(){this.isPayPopup=!1},payTypeFunc(t){let e=this;e.isPayPopup=!1,s({title:"載入中"}),e._post("user.order/pay",{payType:t,order_id:e.order_id,pay_source:e.getPlatform()},(function(t){pay(t,e)}))},onPayOrder(t){this.isPayPopup=!0,this.order_id=t},orderReceipt(t){let e=this;o({title:"提示",content:"您確定要收貨嗎?",success:function(a){a.confirm?(s({title:"正在處理"}),e._post("card.order/receipt",{order_id:t},(function(t){l(),i({title:t.msg,duration:2e3,icon:"success"}),e.listData=[],e.getData()}))):i({title:"取消收貨",duration:1e3,icon:"none"})}})},cancelOrder(t){let e=this,a=t;o({title:"提示",content:"您確定要取消嗎?",success:function(t){t.confirm&&(s({title:"正在處理"}),e._get("card.order/cancel",{order_id:a},(function(t){l(),i({title:"操作成功",duration:2e3,icon:"success"}),e.listData=[],e.getData()})))}})},gotoEvaluate(t){this.gotoPage("/pages/order/evaluate/evaluate?order_id="+t)},onQRCode(t){let e=this;s({title:"載入中"});let a=t;e._get("user.order/qrcode",{order_id:a,source:e.getPlatform()},(function(t){l(),e.isCodeImg=!0,e.codeImg=t.data.qrcode}))},hideCodePopupFunc(){this.isCodeImg=!1},gotoAssembleShare(t){let e="/pages/plus/assemble/fight-group-detail/fight-group-detail?assemble_bill_id="+t;this.gotoPage(e)}}},[["render",function(t,e,a,s,o,l){const i=u,P=y,k=T,C=b("uni-load-more"),F=v,x=b("tabBar");return c(),d(i,{"data-theme":t.theme(),class:n(t.theme()||"")},{default:r((()=>[p(i,{class:"top-tabbar"},{default:r((()=>[p(i,{class:n(0==o.state_active?"tab-item active":"tab-item"),onClick:e[0]||(e[0]=t=>l.stateFunc(0))},{default:r((()=>[_("全部訂單")])),_:1},8,["class"]),p(i,{class:n(1==o.state_active?"tab-item active":"tab-item"),onClick:e[1]||(e[1]=t=>l.stateFunc(1))},{default:r((()=>[_("待發貨")])),_:1},8,["class"]),p(i,{class:n(2==o.state_active?"tab-item active":"tab-item"),onClick:e[2]||(e[2]=t=>l.stateFunc(2))},{default:r((()=>[_("已發貨")])),_:1},8,["class"])])),_:1}),p(F,{"scroll-y":"true",class:"scroll-Y",style:m("height:"+o.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:l.scrolltolowerFunc},{default:r((()=>[p(i,{class:n(o.topRefresh?"top-refresh open":"top-refresh")},{default:r((()=>[(c(),g(f,null,h(3,((t,e)=>p(i,{class:"circle",key:e}))),64))])),_:1},8,["class"]),p(i,{class:"order-list"},{default:r((()=>[(c(!0),g(f,null,h(o.listData,((t,e)=>(c(),d(i,{class:"item",key:e},{default:r((()=>[p(i,{class:"order-head d-b-c"},{default:r((()=>[p(i,null,{default:r((()=>[p(P,{class:"shop-name flex-1 fb"},{default:r((()=>[_("訂單號："+w(t.order_no),1)])),_:2},1024)])),_:2},1024),p(i,{class:"state"},{default:r((()=>[0==t.delivery_status?(c(),d(P,{key:0,class:"red"},{default:r((()=>[_("待發貨")])),_:1})):D("",!0),1==t.delivery_status?(c(),d(P,{key:1,class:"red"},{default:r((()=>[_("已發貨")])),_:1})):D("",!0)])),_:2},1024)])),_:2},1024),p(i,{class:"one-product d-s-c",onClick:e=>l.gotoOrder(t.order_id)},{default:r((()=>[p(i,{class:"cover"},{default:r((()=>[p(k,{src:t.product_image,mode:"aspectFit"},null,8,["src"])])),_:2},1024),p(i,{class:"pro-info flex-1"},{default:r((()=>[_(w(t.product_name),1)])),_:2},1024),p(i,{class:"total-count"},{default:r((()=>[p(i,{class:"left-shadow"}),p(i,{class:"price theme-price f22"},{default:r((()=>[_(" ¥ "),p(P,{class:"f40 theme-price"},{default:r((()=>[_(w(t.product_price),1)])),_:2},1024)])),_:2},1024),p(i,{class:"count"},{default:r((()=>[_("共1件")])),_:1})])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128)),0!=o.listData.length||o.loading?(c(),d(C,{key:1,loadingType:l.loadingType},null,8,["loadingType"])):(c(),d(i,{key:0,class:"d-c-c p30"},{default:r((()=>[p(P,{class:"iconfont icon-wushuju"}),p(P,{class:"cont"},{default:r((()=>[_("親，暫無相關記錄哦")])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"]),p(x)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-a015b013"]]);export{k as default};
