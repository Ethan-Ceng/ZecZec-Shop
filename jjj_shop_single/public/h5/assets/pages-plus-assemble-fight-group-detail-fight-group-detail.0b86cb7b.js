import{_ as a,z as e,B as l,o as s,c as t,w as r,e as i,g as d,b as o,d as u,t as p,f as c,r as n,F as _,i as m,j as f,k as b,h}from"./index-6e5c77a7.js";import{C as g}from"./countdown.ae2f98a7.js";import{s as D}from"./mp-share.5df2fe0f.js";import{A as S}from"./app-share.6adf735f.js";import"./share.0e953495.js";const y=a({components:{Countdown:g,share:D,AppShare:S},data:()=>({loadding:!0,assemble_bill_id:null,billData:{},productData:{},countdownConfig:{type:"text",startstamp:0,endstamp:0},isMpShare:!1,dif_people:0,reallyAssemble:!1,isAppShare:!1,appParams:{title:"",summary:"",path:""},url:""}),onLoad(a){this.assemble_bill_id=a.assemble_bill_id,this.url=window.location.href},onShareAppMessage(){let a=this,e=a.getShareUrlParams({assemble_bill_id:a.assemble_bill_id});return{title:"【僅限"+a.dif_people+"個名額】，快來參與拼團吧",path:"/pages/plus/assemble/fight-group-detail/fight-group-detail?"+e}},mounted(){this.getData()},methods:{getData(){let a=this;e({title:"載入中"}),a._get("plus.assemble.bill/detail",{assemble_bill_id:a.assemble_bill_id,url:a.url},(function(e){if(a.billData=e.data.bill,a.productData=e.data.product,a.countdownConfig.startstamp=0,a.countdownConfig.endstamp=a.billData.end_time,a.dif_people=a.productData.assemble_num-a.billData.billUser.length<0?0:a.productData.assemble_num-a.billData.billUser.length,""!=a.url){let l={assemble_bill_id:a.assemble_bill_id};a.configWx(e.data.share.signPackage,e.data.share.shareParams,l)}a.reallyAssemble=a.hasAssemble(a.billData.billUser),a.loadding=!1,l()}))},hasAssemble(a){let e=!1,l=this.getUserId();for(let s=0;s<a.length;s++)if(l==a[s].user_id){e=!0;break}return e},shareFunc(){this.isMpShare=!0},closeShare(){this.isMpShare=!1},closeAppShare(a){this.isAppShare=!1},returnValFunc(){},gotoAssemble(a){let e="pages/plus/assemble/detail/detail?assemble_product_id="+a.assemble_product_id+"&assemble_bill_id="+a.assemble_bill_id;this.gotoPage(e)}}},[["render",function(a,e,l,g,D,S){const y=m,A=d,k=f,C=b("Countdown"),w=h,F=b("share"),P=b("AppShare");return D.loadding?i("",!0):(s(),t(A,{key:0,class:"fight-group-detail"},{default:r((()=>[o(A,{class:"product-info p30 d-s-c bg-white"},{default:r((()=>[o(A,{class:"product-cover"},{default:r((()=>[o(y,{src:D.productData.product.image[0].file_path,mode:"aspectFit"},null,8,["src"])])),_:1}),o(A,{class:"info flex-1 ml30 f30"},{default:r((()=>[o(k,null,{default:r((()=>[u(p(D.productData.product.product_name),1)])),_:1}),o(A,{class:"mt20"},{default:r((()=>[o(k,null,{default:r((()=>[u(p(D.productData.assemble_num)+"人團：",1)])),_:1}),o(k,{class:"ml30 red"},{default:r((()=>[u("￥")])),_:1}),o(k,{class:"fb red f34"},{default:r((()=>[u(p(D.productData.assembleSku[0].assemble_price),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(A,{class:"fight-users mt20 bg-white"},{default:r((()=>[o(A,{class:"user-list d-c-c"},{default:r((()=>[(s(!0),c(_,null,n(D.billData.billUser,((a,e)=>(s(),t(A,{class:"user-box pr",key:e},{default:r((()=>[0==e?(s(),t(k,{key:0,class:"leader"},{default:r((()=>[u("團長")])),_:1})):i("",!0),o(y,{src:a.user.avatarUrl,mode:"aspectFit"},null,8,["src"])])),_:2},1024)))),128)),D.dif_people>0?(s(),t(A,{key:0,class:"user-box user-who d-c-c"},{default:r((()=>[u(" ? ")])),_:1})):i("",!0)])),_:1}),D.dif_people>0?(s(),t(A,{key:0,class:"d-c-c mt30 gray3"},{default:r((()=>[u(" 還差"),o(k,{class:"fb"},{default:r((()=>[u(p(D.dif_people),1)])),_:1}),u("人成團 ")])),_:1})):(s(),t(A,{key:1,class:"d-c-c mt30 gray3"},{default:r((()=>[u(" 拼團已完成 ")])),_:1})),o(A,{class:"mt20 d-c-c gray6 f34"},{default:r((()=>[o(C,{config:D.countdownConfig,onReturnVal:S.returnValFunc},null,8,["config","onReturnVal"])])),_:1})])),_:1}),o(A,{class:"leader-info d-b-c p30"},{default:r((()=>[o(A,{class:"photo d-s-c"},{default:r((()=>[o(y,{src:D.billData.user.avatarUrl,mode:"aspectFit"},null,8,["src"]),o(k,{class:"ml20"},{default:r((()=>[u(p(D.billData.user.nickName),1)])),_:1})])),_:1}),o(A,{class:"gray9"},{default:r((()=>[o(k,null,{default:r((()=>[u(p(D.billData.create_time),1)])),_:1}),o(k,{class:"ml10"},{default:r((()=>[u("開團")])),_:1})])),_:1})])),_:1}),o(A,{class:"fight-group-btns"},{default:r((()=>[D.reallyAssemble?(s(),t(w,{key:1,type:"default",class:"btn-red","open-type":"share",onClick:S.shareFunc},{default:r((()=>[u("分享拼團")])),_:1},8,["onClick"])):(s(),t(w,{key:0,type:"default",class:"btn-red",onClick:e[0]||(e[0]=a=>S.gotoAssemble(D.billData))},{default:r((()=>[u("去拼團")])),_:1}))])),_:1}),o(F,{isMpShare:D.isMpShare,product_id:a.product_id,onClose:S.closeShare},null,8,["isMpShare","product_id","onClose"]),o(P,{isAppShare:D.isAppShare,appParams:D.appParams,onClose:S.closeAppShare},null,8,["isAppShare","appParams","onClose"])])),_:1}))}],["__scopeId","data-v-8e577417"]]);export{y as default};
