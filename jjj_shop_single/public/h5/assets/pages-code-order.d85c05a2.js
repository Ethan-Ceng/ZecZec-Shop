import{_ as e,A as t,x as a,a as o,o as s,c as i,w as r,g as l,b as d,d as c,t as n,G as u,K as p,q as m,e as f,j as g,i as _,I as h,a0 as b,k as x,h as y}from"./index-6e5c77a7.js";import{m as w}from"./mpvueCityPicker.d23ed411.js";const k=e({components:{mpvueCityPicker:w},data:()=>({order_id:0,product:{},cityPickerValueDefault:[0,0,0],selectCity:"選擇省,市,區",detail:{},address:{},delta:1,province:[],city:[],area:[],is_load:!1,form:{name:"",mobile:"",province_id:0,city_id:0,region_id:0,detail:""},temlIds:[],urldata:"",btnAtrrpx:{},mpState:null}),onLoad(e){let a=t("mpState");this.mpState=a,this.isWeixin()&&(this.urldata=window.location.href,this.getBtnInfo(),this.getTemplateId()),this.order_id=e.order_id,this.getData(),this.getRegionData()},methods:{subscribeSuccess(e){console.log(e),this.submit(),console.log("呼叫成功")},subscribeFail(e){console.log(e),this.submit(),console.log("呼叫失敗")},getBtnInfo(){let e=this,t={width:600,height:80,marginTop:40,fontSize:32};a({success:function(a){let o=a.screenWidth/750,s={};for(let e in t)s[e]=t[e]*o;e.btnAtrrpx=s},fail(){e.btnAtrrpx=t}})},getTemplateId(){let e=this;e._post("index/getSignPackage",{url:e.urldata,paySource:e.getPlatform()},(function(t){e.mpMessage(t.data.signPackage)}))},getData(){let e=this;e._get("card.code/order",{order_id:e.order_id,platform:e.getPlatform()},(function(t){e.detail=t.data.detail,e.product=t.data.product,e.temlIds=t.data.template_arr}))},getRegionData(){let e=this;e._post("settings/getRegion",{},(function(t){e.province=t.data.regionData[0],e.city=t.data.regionData[1],e.area=t.data.regionData[2],e.is_load=!0}))},showMulLinkageThreePicker(){this.$refs.mpvueCityPicker.show()},onConfirm(e){this.selectCity=e.label,this.form.province_id=e.cityCode[0],this.form.city_id=e.cityCode[1],this.form.region_id=e.cityCode[2]},submit(){let e=this;if(console.log(e.form),""==e.form.name)return o({title:"請輸入收貨人姓名",duration:1e3,icon:"none"}),!1;if(""==e.form.mobile)return o({title:"請輸入手機號碼",duration:1e3,icon:"none"}),!1;if(0==e.form.province_id||0==e.form.city_id||0==e.form.region_id)return o({title:"請選擇所在地區",duration:1e3,icon:"none"}),!1;if(""==e.form.detail)return o({title:"請輸入街道小區樓牌號等",duration:1e3,icon:"none"}),!1;e.form.order_id=e.order_id;e.subMessage(e.temlIds,(function(){e._post("card.code/order",e.form,(function(t){e.showSuccess(t.msg,(function(){e.gotoPage("/pages/order/codeorder")}))}))}))}}},[["render",function(e,t,a,o,w,k){const C=g,V=l,v=_,S=h,P=b,A=x("wx-open-subscribe"),D=y,I=x("mpvue-city-picker");return s(),i(V,{class:"user-index"},{default:r((()=>[d(V,{class:"thbox"},{default:r((()=>[d(V,{class:"spbox"},{default:r((()=>[d(V,{class:"spbt"},{default:r((()=>[d(C,{class:"sptit"},{default:r((()=>[c("訂單號：")])),_:1}),d(C,{class:"sptit2"},{default:r((()=>[c(n(w.detail.order_no),1)])),_:1})])),_:1}),d(V,{class:"spcon"},{default:r((()=>[d(v,{class:"sptu",src:w.product.image&&w.product.image[0].file_path},null,8,["src"]),d(V,{class:"sptxt"},{default:r((()=>[d(C,{class:"h1"},{default:r((()=>[c(n(w.product.product_name),1)])),_:1}),d(C,{class:"guige"},{default:r((()=>[c(n(w.detail.card&&w.detail.card.product_attr),1)])),_:1}),d(V,{class:"num"},{default:r((()=>[d(C,{class:"price"},{default:r((()=>[c("￥"+n(w.product.product_price),1)])),_:1}),d(C,{class:"numshu"},{default:r((()=>[c("X1")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),d(V,{class:"addbox"},{default:r((()=>[d(C,{class:"addbt"},{default:r((()=>[c("提貨地址")])),_:1}),d(V,{class:"row"},{default:r((()=>[d(C,{class:"rowtxt"},{default:r((()=>[c("收貨人")])),_:1}),d(S,{class:"rowsr",modelValue:w.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>w.form.name=e),placeholder:"請輸入收貨人姓名"},null,8,["modelValue"])])),_:1}),d(V,{class:"row"},{default:r((()=>[d(C,{class:"rowtxt"},{default:r((()=>[c("手機號碼")])),_:1}),d(S,{class:"rowsr",modelValue:w.form.mobile,"onUpdate:modelValue":t[1]||(t[1]=e=>w.form.mobile=e),placeholder:"請輸入手機號碼"},null,8,["modelValue"])])),_:1}),d(V,{class:"row"},{default:r((()=>[d(C,{class:"rowtxt"},{default:r((()=>[c("所在地區")])),_:1}),d(S,{class:"rowsr",placeholder:"","placeholder-class":"grary9",modelValue:w.selectCity,"onUpdate:modelValue":t[2]||(t[2]=e=>w.selectCity=e),disabled:"true",onClick:k.showMulLinkageThreePicker},null,8,["modelValue","onClick"])])),_:1}),d(V,{class:"row"},{default:r((()=>[d(C,{class:"rowtxt"},{default:r((()=>[c("詳細地址")])),_:1}),d(P,{class:"rowdz",modelValue:w.form.detail,"onUpdate:modelValue":t[3]||(t[3]=e=>w.form.detail=e),placeholder:"請輸入詳細地址"},null,8,["modelValue"])])),_:1})])),_:1}),e.isWeixin()&&1==w.mpState&&""!=w.temlIds?(s(),i(A,{key:0,template:w.temlIds,id:"subscribe-btn",onSuccess:k.subscribeSuccess,onError:k.subscribeFail},{default:r((()=>[(s(),i(u("script"),{type:"text/wxtag-template",slot:"style"})),(s(),i(u("script"),{type:"text/wxtag-template"},{default:r((()=>[p("div",{class:"subscribe-btn",style:m({width:w.btnAtrrpx.width+"px",marginTop:w.btnAtrrpx.marginTop+"px",height:w.btnAtrrpx.height+"px",lineHeight:w.btnAtrrpx.height+"px",background:"linear-gradient(to bottom, #ff7220, #fbb700)",borderRadius:w.btnAtrrpx.marginTop+"px",color:"#fff",fontSize:w.btnAtrrpx.fontSize+"px",textAlign:"center"})}," 確認兌換 ",4)])),_:1}))])),_:1},8,["template","onSuccess","onError"])):(s(),i(D,{key:1,class:"qubtn",onClick:k.submit},{default:r((()=>[c("確認兌換")])),_:1},8,["onClick"]))])),_:1}),w.is_load?(s(),i(I,{key:0,ref:"mpvueCityPicker",province:w.province,city:w.city,area:w.area,pickerValueDefault:w.cityPickerValueDefault,onOnConfirm:k.onConfirm},null,8,["province","city","area","pickerValueDefault","onOnConfirm"])):f("",!0)])),_:1})}],["__scopeId","data-v-d9bfe91c"]]);export{k as default};
