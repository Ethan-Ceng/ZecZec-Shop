import{s as t,A as e,aj as i,ai as s,T as a,al as l,H as o,_ as n,am as r,an as d,B as h,y as g,o as u,c,w as p,q as m,b as f,d as y,t as x,n as w,i as A,g as _,j as I,ao as L,x as v,z as b,a as R,e as z,f as S,r as C,F as T,G as k,h as D,Y as F,k as B,S as M,X as P}from"./index-6e5c77a7.js";import{r as H}from"./uni-app.es.5424dc16.js";import{P as N}from"./uni-popup.f3f35788.js";import{u as W}from"./uni-load-more.58b2601d.js";import{_ as j}from"./bg-rule.c18db2ba.js";/* empty css                                                                  */const O=(e,i)=>{e&&("string"!=typeof i&&(i=JSON.stringify(i)),t(e,i))},E=t=>{if(t)return e(t)},Q=t=>{if(!t)return{byteLen:0,realLen:0};t+="";let e=0;for(let i=0;i<t.length;i++)t.charCodeAt(i)<0||t.charCodeAt(i)>255?e+=2:e+=1;return{byteLen:e,realLen:e/2}},q=t=>new Promise((e=>{a({url:t,success:t=>{200===t.statusCode?e({ok:!0,data:t.errMsg,tempFilePath:t.tempFilePath}):e({ok:!1,data:t.errMsg,msg:"圖片下載失敗"})},fail:t=>{e({ok:!1,data:t.errMsg,msg:"圖片下載失敗"})}})})),Z=t=>new Promise(((e,i)=>{if("object"==typeof window&&"document"in window){if("function"==typeof FileReader){let s=new XMLHttpRequest;return s.open("GET",t,!0),s.responseType="blob",s.onload=function(){if(200===this.status){let t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=i,t.readAsDataURL(this.response)}},s.onerror=i,void s.send()}let s=document.createElement("canvas"),a=s.getContext("2d"),l=new Image;return l.onload=function(){s.width=l.width,s.height=l.height,a.drawImage(l,0,0),e(s.toDataURL()),s.height=s.width=0},l.onerror=i,void(l.src=t)}if("object"!=typeof plus)"object"==typeof wx&&l("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:t=>{e("data:image/png;base64,"+t.data)},fail:t=>{i(t)}}):i(new Error("not support"));else{let s=(t=>{if(0===t.indexOf("_www")||0===t.indexOf("_doc")||0===t.indexOf("_documents")||0===t.indexOf("_downloads"))return t;if(0===t.indexOf("/storage/emulated/0/"))return t;if(0===t.indexOf("/storage/sdcard0/"))return t;if(0===t.indexOf("/var/mobile/"))return t;if(0===t.indexOf("file://"))return t;if(0===t.indexOf("/")){let e="iOS"===plus.os.name?t:plus.io.convertLocalFileSystemURL(t);if(e!==t)return e;t=t.substring(1)}return"_www/"+t})(t);plus.io.resolveLocalFileSystemURL(s,(t=>{t.file((t=>{let s=new plus.io.FileReader;s.onload=function(t){e(t.target.result)},s.onerror=function(t){console.log(t),i(t)},s.readAsDataURL(t)}),(t=>{i(t)}))}),(t=>{i(t)}))}})),U=o();const $=n({name:"AlmostLottery",props:{canvasId:{type:String,default:"almostLotteryCanvas"},canvasWidth:{type:Number,default:268},canvasHeight:{type:Number,default:268},outerWidth:{type:Number,default:300},outerHeight:{type:Number,default:300},canvasMargin:{type:Number,default:0},actionWidth:{type:Number,default:90},actionHeight:{type:Number,default:90},prizeList:{type:Array,required:!0,validator:t=>t.length>1},prizeIndex:{type:Number,required:!0},colors:{type:Array,default:()=>["#fbe7bb","#fcd68c"]},lotteryBg:{type:String,default:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__bg2x.png"},actionBg:{type:String,default:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__action2x.png"},prizeNameDrawed:{type:Boolean,default:!0},stroked:{type:Boolean,default:!1},strokeColor:{type:String,default:"#FFE9AA"},rotateType:{type:String,default:"roulette"},duration:{type:Number,default:8},ringCount:{type:Number,default:8},pointerPosition:{type:String,default:"edge",validator:t=>"edge"===t||"middle"===t},strDirection:{type:String,default:"horizontal"},strFontColor:{type:String,default:"#A62A2A"},strFontSize:{type:Number,default:9},strMarginOutside:{type:Number,default:0},imgMarginStr:{type:Number,default:25},strLineHeight:{type:Number,default:1.2},strKey:{type:String,default:"name"},strMaxLen:{type:Number,default:12},strLineLen:{type:Number,default:6},imgWidth:{type:Number,default:30},imgHeight:{type:Number,default:30},successMsg:{type:String,default:"獎品準備就緒，快來參與抽獎吧"},failMsg:{type:String,default:"獎品仍在準備中，請稍後再來..."},canvasCached:{type:Boolean,default:!1}},data:()=>({className:"almost-lottery__canvas",lotteryImg:"",targetAngle:0,targetActionAngle:0,transitionDuration:0,isRotate:!1,stayIndex:0,targetIndex:0,isCacheImg:!1,oldLotteryImg:"",almostLotteryTip:"獎品準備中...",measureText:""}),computed:{higtCanvasSize(){return this.canvasWidth*U.pixelRatio},higtFontSize(){return this.strFontSize*U.pixelRatio},higtHeightMultiple(){return this.strFontSize*this.strLineHeight*U.pixelRatio},higtCanvasMargin(){return this.canvasMargin*U.pixelRatio},canvasAngle(){let t=0,e=360/this.prizeList.length,i=90/e;return t="edge"===this.pointerPosition||"pointer"===this.rotateType?-e*i:-(e*i+e/2),t},actionAngle:()=>0,outsideRadius(){return this.higtCanvasSize/2},insideRadius:()=>20*U.pixelRatio,textRadius(){return this.strMarginOutside*U.pixelRatio||this.higtFontSize/2},textDistance(){return Math.round(this.outsideRadius-this.insideRadius/2)-this.textRadius}},watch:{prizeIndex(t,e){t>-1?(this.targetIndex=t,this.onRotateStart()):console.info("旋轉結束，prizeIndex 已重置")}},methods:{onRotateStart(){if(this.isRotate)return;this.isRotate=!0;let t=360/this.prizeList.length,e=0;"pointer"===this.rotateType?(e=0===this.targetActionAngle?(this.targetIndex-this.stayIndex)*t+t/2-this.actionAngle:(this.targetIndex-this.stayIndex)*t,this.stayIndex=this.targetIndex,this.targetActionAngle+=e+360*this.ringCount,console.log("targetActionAngle",this.targetActionAngle)):(e=0===this.targetAngle?270-(this.targetIndex-this.stayIndex)*t-t/2-this.canvasAngle:-(this.targetIndex-this.stayIndex)*t,this.stayIndex=this.targetIndex,this.targetAngle+=e+360*this.ringCount);let i=1e3*this.transitionDuration+100,s=setTimeout((()=>{clearTimeout(s),s=null,this.isRotate=!1,this.$emit("draw-end")}),i),a=setTimeout((()=>{clearTimeout(a),a=null,this.$emit("reset-index")}),i+50)},handleActionStart(){this.lotteryImg&&(this.isRotate||this.$emit("draw-start"))},async onCreateCanvas(){const t=this.canvasId,e=r(t,this);let i=this.higtCanvasSize,s=this.higtCanvasSize,a=this.prizeList.length,l=2*Math.PI/a;e.setFontSize(this.higtFontSize);for(let o=0;o<a;o++){let t=this.prizeList[o],a=o*l;e.save(),e.beginPath(),e.arc(.5*i,.5*s,this.outsideRadius,a,a+l,!1),e.arc(.5*i,.5*s,this.insideRadius,a+l,a,!0),2===this.colors.length?e.setFillStyle(this.colors[o%2]):e.setFillStyle(this.colors[o]),e.fill(),this.stroked&&(e.setStrokeStyle(`${this.strokeColor}`),e.stroke());let n=.5*i+Math.cos(a+l/2)*this.textDistance,r=.5*s+Math.sin(a+l/2)*this.textDistance;e.translate(n,r),e.setFillStyle(this.strFontColor);let d=this.strLimit(t[this.strKey]);if(e.rotate(a+l/2+Math.PI/2),"horizontal"===this.strDirection){if(d&&this.prizeNameDrawed){if(Q(d).realLen>this.strLineLen){let t="",i="",s=0;for(let e=0;e<d.length;e++)s+=Q(d[e]).byteLen,s<=2*this.strLineLen?t+=d[e]:i+=d[e];d=t+","+i;let a=d.split(",");for(let l=0;l<a.length;l++)if(e.measureText&&e.measureText(a[l]).width>0){let t=-(e.measureText(a[l]).width/2).toFixed(2);e.fillText(a[l],t,l*this.higtHeightMultiple)}else{this.measureText=a[l],await this.$nextTick();let t=-(await this.getTextWidth()/2).toFixed(2);e.fillText(a[l],t,l*this.higtHeightMultiple)}}else if(e.measureText&&e.measureText(d).width>0){let t=-(e.measureText(d).width/2).toFixed(2);e.fillText(d,t,0)}else{this.measureText=d,await this.$nextTick();let t=-(await this.getTextWidth()/2).toFixed(2);e.fillText(d,t,0)}}}else{let t=d.split("");for(let i=0;i<t.length;i++)if(e.measureText&&e.measureText(t[i]).width>0){let s=-(e.measureText(t[i]).width/2).toFixed(2);e.fillText(t[i],s,i*this.higtHeightMultiple)}else{this.measureText=t[i],await this.$nextTick();let s=-(await this.getTextWidth()/2).toFixed(2);e.fillText(t[i],s,i*this.higtHeightMultiple)}}if(t.image&&"vertical"!==this.strDirection){if(/^(https|http)/g.test(t.image)){let e="";e="需要處理好跨域問題，",console.warn(`###當前資料列表中的獎品圖片為網路圖片，${e}開始嘗試下載圖片...###`);let i=await q(t.image);if(console.log("處理遠端圖片",i),i.ok){let e=i.tempFilePath;t.image=await Z(e)}else this.handlePrizeImgSuc({ok:!1,data:i.data,msg:i.msg})}else console.log("處理非遠端圖片",t.image),-1===t.image.indexOf(";base64,")&&(t.image=await Z(t.image));let i=-this.imgWidth*U.pixelRatio/2,s=this.imgMarginStr*U.pixelRatio,a=this.imgWidth*U.pixelRatio,l=this.imgHeight*U.pixelRatio;e.drawImage(t.image,i,s,a,l)}e.restore()}e.draw(!0,(()=>{let t=setTimeout((()=>{clearTimeout(t),t=null,d({canvasId:this.canvasId,success:t=>{this.handlePrizeImg({ok:!0,data:t.tempFilePath,msg:"畫布匯出生成圖片成功"})},fail:t=>{this.handlePrizeImg({ok:!1,data:t,msg:"畫布匯出生成圖片失敗"})}},this)}),500)}))},handlePrizeImg(t){if(t.ok){let e=t.data;if(!this.canvasCached)return this.lotteryImg=e,void this.handlePrizeImgSuc(t);O(`${this.canvasId}LotteryImg`,e),this.lotteryImg=e,this.handlePrizeImgSuc(t);let i=this.isCacheImg?"快取":"匯出";console.info(`當前為 H5 端，使用${i}中的 base64 圖`)}else console.error("處理匯出的圖片失敗",t),h(),console.error("###當前為 H5 端，下載網路圖片需要後端配置允許跨域###")},handlePrizeImgSuc(t){h(),this.$emit("finish",{ok:t.ok,data:t.data,msg:t.ok?this.successMsg:this.failMsg}),this.almostLotteryTip=t.ok?this.successMsg:this.failMsg},getTextWidth(){console.warn("正在採用相容方式獲取文字的 size 資訊，雖然沒有任何問題，如果可以，請將此 systemInfo 及 hbx 版本號 反饋給作者",U);let t=g().in(this).select(".almost-lottery__measureText");return new Promise(((e,i)=>{t.fields({size:!0},(t=>{e(t.width)})).exec()}))},strLimit(t){let e=this.strMaxLen;return t&&e&&Q(t).realLen>e?t.slice(0,e-1)+"..":t},checkCacheImg(){console.log("檢查本地快取中是否存在轉盤圖"),this.oldLotteryImg=E(`${this.canvasId}LotteryImg`);let t=E(`${this.canvasId}PrizeList`),e=JSON.stringify(this.prizeList);if(this.oldLotteryImg&&t===e)return console.log(`經查，本地快取中存在轉盤圖 => ${this.oldLotteryImg}`),this.isCacheImg=!0,console.log("需要繼續判斷這張快取圖是否可用"),void this.handlePrizeImg({ok:!0,data:this.oldLotteryImg,msg:"畫布匯出生成圖片成功"});console.log("經查，本地快取中不存在轉盤圖"),this.initCanvasDraw()},initCanvasDraw(){var t;console.log("開始初始化轉盤繪製"),this.isCacheImg=!1,this.lotteryImg="",(t=`${this.canvasId}LotteryImg`)?i(t):(console.log("清理本地全部快取"),s()),O(`${this.canvasId}PrizeList`,this.prizeList),this.onCreateCanvas()}},mounted(){this.$nextTick((()=>{let t=setTimeout((()=>{clearTimeout(t),t=null,this.canvasCached?this.checkCacheImg():this.onCreateCanvas(),this.transitionDuration=this.duration}),50)}))}},[["render",function(t,e,i,s,a,l){const o=A,n=_,r=I,d=L;return u(),c(n,{class:"almost-lottery"},{default:p((()=>[a.lotteryImg?(u(),c(n,{key:0,class:"almost-lottery__wrap",style:m({width:i.outerWidth+l.higtCanvasMargin+"px",height:i.outerWidth+l.higtCanvasMargin+"px"})},{default:p((()=>[f(o,{class:"almost-lottery__bg",mode:"widthFix",src:i.lotteryBg,style:m({width:i.outerWidth+l.higtCanvasMargin+"px",height:i.outerWidth+l.higtCanvasMargin+"px"})},null,8,["src","style"]),f(o,{class:"almost-lottery__canvas-img",mode:"widthFix",src:a.lotteryImg,style:m({width:i.canvasWidth+"px",height:i.canvasWidth+"px",transform:`rotate(${l.canvasAngle+a.targetAngle}deg)`,transitionDuration:`${a.transitionDuration}s`})},null,8,["src","style"]),f(o,{class:"almost-lottery__action almost-lottery__action-bg",mode:"widthFix",src:i.actionBg,style:m({width:i.actionWidth+"px",height:i.actionHeight+"px",transform:`rotate(${l.actionAngle+a.targetActionAngle}deg)`,transitionDuration:`${a.transitionDuration}s`}),onClick:l.handleActionStart},null,8,["src","style","onClick"])])),_:1},8,["style"])):(u(),c(r,{key:1,class:"almost-lottery__tip"},{default:p((()=>[y(x(a.almostLotteryTip),1)])),_:1})),f(r,{class:"almost-lottery__measureText",style:m({fontSize:l.higtFontSize+"px"})},{default:p((()=>[y(x(a.measureText),1)])),_:1},8,["style"]),f(d,{class:w(a.className),"canvas-id":i.canvasId,width:l.higtCanvasSize,height:l.higtCanvasSize,style:m({width:l.higtCanvasSize+"px",height:l.higtCanvasSize+"px"})},null,8,["class","canvas-id","width","height","style"])])),_:1})}],["__scopeId","data-v-90d5380c"]]);const G=n({components:{AlmostLottery:$,popup:N,uniLoadMore:W},data:()=>({loading:!0,finish:!1,times:0,points:"",user_points:"",bg_image:"",content:"",prizeList:[],onStock:!0,prizeIndex:-1,result:{},listData:[],styleValue:"",index_num:0,lineHeight:0,maxSize:0,timer:null,isPopup:!1,isRecord:!1,recordList:[],list_rows:10,last_page:0,page:1,no_more:!1,isRule:!1}),computed:{loadingType(){return this.loading?1:0!=this.recordList.length&&this.no_more?2:0}},onShow(){this.isRecord=!1,this.restoreData(),this.handleInitCanvas()},methods:{gotoList(t){this.loading||this.gotoPage(t)},init(){let t=this;this.listData.length>1&&v({success(e){t.lineHeight=e.windowWidth/750*60,t.maxSize=t.listData.length,t.timer=setInterval((function(){t.animation()}),3e3)}})},animation(){let t=this;t.index_num++,t.index_num>=t.maxSize&&(t.index_num=0),this.styleValue=-t.lineHeight*t.index_num},async getPrizeList(){b({title:"獎品準備中..."}),this.loading=!0;let t=await this.requestApiGetPrizeList();if(t.ok){let e=t.data;e.length&&(this.prizeList=e,this.prizeIndex=-1)}else h(),R({title:"獲取獎品失敗"})},requestApiGetPrizeList(){let t=this;return new Promise(((e,i)=>{t._post("plus.lottery.Lottery/getLottery",{},(function(i){t.loading=!1,t.bg_image=i.data.data.file_path,t.content=i.data.data.content,t.prizeList=i.data.data.prize,t.listData=i.data.recordList,t.listData.forEach(((e,i)=>{let s=t.GetDateDiff(e.create_time),a=e.user?e.user.nickName:"匿名使用者";e.showText=s+a+"抽中了"+e.record_name})),t.times=i.data.nums,t.points=i.data.data.points,t.user_points=i.data.data.user_points,t.init(),e({ok:!0,data:t.prizeList})}))}))},GetDateDiff(t){var e=new Date(t.replace(/-/g,"/"));let i=(new Date).getTime()-e.getTime();var s=parseInt(i/864e5),a=i%864e5,l=parseInt(a/36e5),o=a%36e5,n=parseInt(o/6e4),r=parseInt(o%6e4/1e3);let d="";return d=s>0?`${s}天前`:l>0?`${l}小時前`:n>0?`${n}分鐘前`:`${r}秒前`,console.log(s),d},handleInitCanvas(){this.loading=!0,this.prizeList=[],this.getPrizeList()},handleDrawStart(){console.log("start");let t=this;!t.loading&&t.finish&&(t.times<=0?t.showError("次數不足"):(t.loading=!0,t._post("plus.lottery.Lottery/draw",{},(function(e){t.times--,t.loading=!1,t.result=e.data.result;let i=[...t.prizeList],s=e.data.result.prize_id;for(let a=0;a<i.length;a++){if(i[a].prize_id===s){t.prizeIndex=a;break}}console.log("本次抽中獎品 =>",t.prizeList[t.prizeIndex].name)}),(function(e){t.loading=!1}))))},hidePopup(){this.isPopup=!1},hideRecordPopup(){this.isRecord=!1},handleDrawEnd(){this.isPopup=!0,this.handleInitCanvas(),console.log("本次抽獎結束")},handleDrawFinish(t){this.finish=!0},restoreData(){this.recordList=[],this.page=1,this.no_more=!1,this.last_page=1},getList(){let t=this;t.loading=!0,t._post("plus.lottery.Lottery/record",{list_rows:t.list_rows,page:t.page||1},(function(e){t.loading=!1,t.recordList=t.recordList.concat(e.data.list.data),t.last_page=e.data.list.last_page,e.data.list.last_page<=1&&(t.no_more=!0)}))},getRecord(){this.restoreData(),this.getList(),this.isRecord=!0},scrolltolowerFunc(){let t=this;if(t.page++,t.loading=!0,t.page>t.last_page)return t.loading=!1,void(t.no_more=!0);t.getList()}}},[["render",function(t,e,i,s,a,l){const o=A,n=I,r=_,d=H(k("almost-lottery"),$),h=D,g=P,w=F,L=B("popup"),v=M;return u(),c(r,{class:"bg-lottery pr",style:m("background-image: url("+a.bg_image+");")},{default:p((()=>[f(r,{class:"d-b-c top-box ww100"},{default:p((()=>[f(r,{class:"d-s-c"},{default:p((()=>[f(o,{class:"lottery-points",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAABAlBMVEUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAABAQACAQD/xBn+xBm3jRH+xBn6wRj6wRjjrxaXdQ69kRKdeQ/8wxn5wRj2vhjwuhfeqxWfew+BYwz/xRn6wRn6wRj+xBn5wBj2vhj2vhjfrBbYpxXxuhfvuReBYw21ixFgSgl6Xgv+xBn+xBn9wxn8wxn4wBjzuxj8wxnuuBf3vxjosxfptBfwuhf6wRjmsRb0vBjcqhXlsRbirxbrthbQoRTUpBWNbQ78wxn8wxn1vRj1vRj5wBjwuhfksRb1vRjerBbRoRTuuBferBbHmhPAlBOWdA7TohTuuBfptBfHmhTxuhjMnhT/xRmkfbj2AAAAVXRSTlMABwQLFA4YERwe+NRN9drASiooDtLQr1RURC7x4tfNyrWlhWhPQTQvGxbr597CvbympZyYkoyLinRvZFpKSj0h4aygk4GBenl0dHBpWkI5F6+hYEs3fmNdhQAAAvhJREFUSMfN1md32jAUgOFKtmxsM0IIYSeQAIHsvUczmtGsrvv//0qvsK1RCUg/9Jy+n3q4fSJHqkU//YMo9tfmvXt3XYiiwvVd951+nHW3cyBqbP+kH2O9DfijQo9OZ/QQLB1SOsWVNsDaRolOdhGMKZokKZmDsS0QOt51YELbQhquAlrtb6BVQWmHDf0QgmAL1BoIre4YtGpBUAOtY5QWR9ZArRxgZVBbIyhNeA5a2QyWBa0ZCyRkF5TCR89zXc87yedAtkuIuaAjznDr+9JyHRmGtF7LPuWTyZxDqAGHYTJdCoIMMp9hPtJMEDylzzE0ICGXIGDsHIyxkdxJZ78IMZ60CmnL6JARnoOLeidyd8SzSngKUqJDRCnl0n2WkzMLPAPZKUL+BnLJTkFWtcALUJpNjhrhLCi9WmBRP2mSDqqgdGWB/pqxIqav+Nm3wXkQrfPfMfmcrYNo3gqflb+AkNBeb7SrHWW7bZANQHSCx99dAFi4xHO8Fx+HA2aD7g6kbRVXkgf/4rub4uMd14C4CcxX9jWUr+UiiIo+4874Jd0jmNhRsqD5rF5rkmt5AhpL1sPxLqy7vnDGktnxMCsW1Cs94M6jzNlZDh2e0XHJWLAChw5/a9/KNrf4NnpHb6FibE4E8DW+KZZyxnJH8Z3wABBRndFzACH7e02VNff7I+cfAHZOqQpJlPw74dLLZH7sFZohQNhc3HvBK8hzEXaAFxGquhmIu0EZ00zQr9X6Af4BGXbRkpeydPJ7ce4SKbcYN7Hyi7fK9yRRF5QdXDGGWOb7g5tQ/7YTcBWUVocOwzhnccN0lC/nV2FTgbvtzsH9fvIeFByjs/jieMEHH6zMKtBhox3Zj+8bh+gl10dY9+IbXoPxMbTEtaHEIb/qHlOnwFS+4nxF/Ej15+Yh77rSqZJTtw1tX4zUabVxMWJ8qEBKElrc5AsS841jV7jHOJJOUic+Bcd46ZKZI5czKY8gNCTO5GrGOIlaRzozV7WP6bT/Z/Px/9pvgsFdeDHk3OAAAAAASUVORK5CYII=",mode:""}),f(n,{class:"yellow f28"},{default:p((()=>[y("賬戶"+x(t.points_name()),1)])),_:1}),f(n,{class:"white f36 ml10"},{default:p((()=>[y(x(a.user_points),1)])),_:1})])),_:1}),f(r,{class:"points-rule",onClick:e[0]||(e[0]=t=>a.isRule=!0)},{default:p((()=>[y("活動規則")])),_:1})])),_:1}),f(r,{class:"rule-title"},{default:p((()=>[f(r,{class:"tc mt20 f28"},{default:p((()=>[y("每次抽獎消耗 "+x(a.points)+" "+x(t.points_name())+",今日剩餘"+x(a.times)+"次",1)])),_:1})])),_:1}),f(r,{class:"lottery-title"},{default:p((()=>[a.prizeList.length?(u(),c(d,{key:0,prizeList:a.prizeList,prizeIndex:a.prizeIndex,lotteryBg:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__bg.png",actionBg:"/uni_modules/almost-lottery/static/almost-lottery/almost-lottery__action.png",onResetIndex:e[1]||(e[1]=t=>a.prizeIndex=-1),onDrawStart:l.handleDrawStart,onDrawEnd:l.handleDrawEnd,onFinish:l.handleDrawFinish},null,8,["prizeList","prizeIndex","lotteryBg","actionBg","onDrawStart","onDrawEnd","onFinish"])):z("",!0)])),_:1}),f(r,{class:"ww100 mb23 mt40"},{default:p((()=>[f(h,{type:"default",class:"record",onClick:e[2]||(e[2]=t=>l.gotoList("/pages/plus/lottery/WinningRecord"))},{default:p((()=>[y(" 中獎記錄 "),f(n,{class:"icon iconfont icon-bofang"})])),_:1})])),_:1}),a.listData.length>0?(u(),c(r,{key:0,class:"content"},{default:p((()=>[f(w,{class:"swiper",vertical:"",circular:"",autoplay:"",interval:"2000","display-multiple-items":a.listData.length>=5?5:a.listData.length},{default:p((()=>[(u(!0),S(T,null,C(a.listData,((e,i)=>(u(),c(g,{key:i},{default:p((()=>[f(r,{class:"box"},{default:p((()=>[f(r,{class:"text-ellipsis"},{default:p((()=>[y(x(t.points_name(e.showText)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["display-multiple-items"])])),_:1})):z("",!0),f(L,{show:a.isPopup,type:"middle",backgroundColor:"#ea564c",padding:40,width:638,onHidePopup:l.hidePopup},{default:p((()=>[f(r,{class:"pr ww100 tc mb38"},{default:p((()=>[f(r,{class:"pop-tit-line"}),f(r,{class:"pop-tit-text"},{default:p((()=>[y("恭喜，中獎啦")])),_:1})])),_:1}),f(r,{class:"d-c-c d-c ww100 product-box pr"},{default:p((()=>[f(r,{class:"circular-left"}),f(r,{class:"circular-right"}),f(r),f(r,{class:"pop_img"},{default:p((()=>[f(o,{src:a.result.image,mode:""},null,8,["src"])])),_:1}),3==a.result.type?(u(),c(r,{key:0,class:"targetLink",onClick:e[3]||(e[3]=e=>t.gotoPage("/pages/plus/lottery/WinningRecord"))},{default:p((()=>[f(r,{class:"f26 text-ellipsis fb"},{default:p((()=>[y(x(a.result.name),1)])),_:1})])),_:1})):(u(),c(r,{key:1,class:""},{default:p((()=>[f(r,{class:"f26 text-ellipsis fb"},{default:p((()=>[y(x(a.result.name),1)])),_:1})])),_:1}))])),_:1})])),_:1},8,["show","onHidePopup"]),f(L,{show:a.isRule,width:575,height:550,padding:0,onHidePopup:e[4]||(e[4]=t=>a.isRule=!1),backgroundColor:"none"},{default:p((()=>[f(r,{class:"pop-center"},{default:p((()=>[f(o,{class:"bg-rule",src:j,mode:""}),f(r,{class:"pop-title"},{default:p((()=>[y("活動規則")])),_:1}),f(v,{"scroll-y":"true",style:{height:"473rpx"}},{default:p((()=>[f(r,{class:"pop-title-box"},{default:p((()=>[y(x(a.content),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1},8,["style"])}],["__scopeId","data-v-9cbedc78"]]);export{G as default};
