System.register(["./element-plus-legacy-4010b94c.js","./file-legacy-6c270a09.js","./Upload.vue_vue_type_style_index_0_scoped_18afb026_lang-legacy-88947798.js","./index-legacy-a1d733aa.js","./@vue-legacy-a5eb5da2.js","./AddCategory-legacy-00041d02.js"],(function(e,t){"use strict";var i,n,a,l,o,c,s,r,u,g,f,d,p,h,y,m,C,_,v,k,F,S,b,z,w,L,T;return{setters:[function(e){i=e.k,n=e.p,a=e.f,l=e.q,o=e.a,c=e.E,s=e.u,r=e.h,u=e.w},function(e){g=e.F},null,function(e){f=e._},function(e){d=e.ae,p=e.o,h=e.c,y=e.P,m=e.S,C=e.a,_=e.W,v=e.Q,k=e.a9,F=e.M,S=e.X,b=e.Y,z=e.V,w=e.T,L=e.a1},function(e){T=e._}],execute:function(){var t={class:"upload-wrap"},x={class:"fileContainer"},D={class:"file-type"},I=["onClick"],P={class:"file-content"},j={class:"fileContainerUI clearfix"},V=["onClick"],U={key:0,class:"selectedIcon"},B=["scr"],N={class:"desc"},W={class:"pagination-wrap"},$={class:"dialog-footer"},E=f({components:{},data:function(){return{dialogWidth:"910px",activeType:null,category_id:"",typeList:[],imageUrl:null,dialogVisible:!0,fileList:[],addLoading:!1,this_config:{total:1,fileType:"image"},record:0,loading:!0,tableData:[],pageSize:36,totalDataNumber:0,curPage:1,isShowCategory:!1,category:null,fileIds:[],accept:""}},props:["config"],created:function(){if("[object object]"===Object.prototype.toString.call(this.config).toLowerCase()){for(var e in this.config)this.config[e]&&(this.this_config[e]=this.config[e]);"image"==this.this_config.fileType?this.accept="image/jpeg,image/png,image/jpg":this.accept="video/mp4"}this.getFileCategory(),this.getData()},methods:{getFileCategory:function(){var e=this,t={page:e.curPage,list_rows:e.pageSize,parentId:e.activeType,fileType:e.this_config.fileType};g.SystemPictureList(t,!0).then((function(t){e.loading=!1,e.fileList=t.data.list.data,e.totalDataNumber=t.data.list.total})).catch((function(t){e.loading=!1}))},getData:function(){var e=this;g.PictureIndex({type:e.this_config.fileType},!0).then((function(t){e.typeList=[{category_id:null,name:"全部"}].concat(t.data.list),e.category_id=e.typeList.category_id})).catch((function(t){e.loading=!1}))},selectTypeFunc:function(e){this.activeType=e,this.curPage=1,this.getFileCategory()},handleCurrentChange:function(e){this.curPage=e,this.getFileCategory()},handleSizeChange:function(e){this.curPage=1,this.pageSize=e,this.getFileCategory()},fileChange:function(e){},selectFileFunc:function(e,t){e.selected?(e.selected=!1,this.record--):(e.selected=!0,this.record++),this.fileList[t]=e},confirmFunc:function(){for(var e=[],t=0,i=0;i<this.fileList.length;i++){var n=this.fileList[i];if(n.selected){var a={file_path:n.image};e.push(a),t++}if(t>this.this_config.total)break}this.$emit("closeSystem",e)},cancelFunc:function(){this.$emit("closeSystem",null)}}},[["render",function(e,o,c,s,r,u){var g=d("Check"),f=i,w=n,L=a,T=l;return p(),h("div",t,[y(T,{title:"系統圖標",modelValue:r.dialogVisible,"onUpdate:modelValue":o[0]||(o[0]=function(e){return r.dialogVisible=e}),"close-on-click-modal":!1,"custom-class":"upload-dialog","close-on-press-escape":!1,onClose:u.cancelFunc,width:r.dialogWidth,"append-to-body":!0},{footer:m((function(){return[C("div",$,[y(L,{size:"small",onClick:u.cancelFunc},{default:m((function(){return[_("取 消")]})),_:1},8,["onClick"]),y(L,{size:"small",type:"primary",onClick:u.confirmFunc},{default:m((function(){return[_("確 定")]})),_:1},8,["onClick"])])]})),default:m((function(){return[C("div",x,[C("div",D,[C("ul",null,[(p(!0),h(v,null,k(r.typeList,(function(e,t){return p(),h("li",{class:F(r.activeType==e.category_id?"item active":"item"),key:t,onClick:function(t){return u.selectTypeFunc(e.category_id)}},S(e.name),11,I)})),128))])]),C("div",P,[C("ul",j,[(p(!0),h(v,null,k(r.fileList,(function(e,t){return p(),h("li",{class:"file",key:t,onClick:function(i){return u.selectFileFunc(e,t)}},[1==e.selected?(p(),h("div",U,[y(f,null,{default:m((function(){return[y(g)]})),_:1})])):b("",!0),"image"==r.this_config.fileType?(p(),h("img",{key:1,scr:e.image,style:z("background-image:url("+e.image+")"),alt:""},null,12,B)):b("",!0),C("p",N,S(e.name),1)],8,V)})),128))])])]),C("div",W,[y(w,{onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange,"current-page":r.curPage,"page-sizes":[12,24,36,42,48],"page-size":r.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:r.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]})),_:1},8,["modelValue","onClose","width"])])}],["__scopeId","data-v-e1085942"]]),q={class:"upload-wrap"},A={class:"upload-wrap-inline mb16 clearfix"},M={class:"leval-item"},O={class:"move-type"},Q=["onClick"],X={class:"leval-item upload-btn"},Y={class:"fileContainer"},G={class:"file-type"},H=["onClick"],J=["onClick"],K=["onClick"],R={class:"file-content"},Z={class:"fileContainerUI clearfix"},ee=["onClick"],te={key:0,class:"selectedIcon"},ie={class:"iconBox"},ne=["scr"],ae=["src"],le={class:"desc"},oe=["onClick"],ce={class:"pagination-wrap"};e("_",f({components:{AddCategory:T,System:E},data:function(){return{dialogWidth:"910px",activeType:null,typeList:[],imageUrl:null,dialogVisible:!0,fileList:[],addLoading:!1,this_config:{total:1,file_type:"image"},record:0,loading:!0,tableData:[],pageSize:36,totalDataNumber:0,curPage:1,isShowCategory:!1,isShowSystemPicture:!1,category:null,system:null,fileIds:[],accept:""}},props:["config","uploadimage","selectedIndex"],created:function(){if("[object object]"===Object.prototype.toString.call(this.config).toLowerCase()){for(var e in this.config)this.this_config[e]=this.config[e];"image"==this.this_config.file_type?this.accept="image/jpeg,image/png,image/jpg":this.accept="video/mp4"}this.getFileCategory(),this.getData()},methods:{getFileCategory:function(){var e=this;g.fileCategory({type:e.this_config.file_type},!0).then((function(t){e.typeList=[{group_id:null,group_name:"全部"}].concat(t.data.group_list)})).catch((function(t){e.loading=!1}))},addCategory:function(){this.isShowCategory=!0,this.category=null},addSystem:function(){this.isShowSystemPicture=!0,this.system=null},editCategoryFunc:function(e){this.isShowCategory=!0,this.category=e},closeCategoryFunc:function(e){null!=e&&this.getFileCategory(),this.isShowCategory=!1},closeSystemFunc:function(e){this.isShowSystemPicture=!1,e&&this.$emit("returnImgs",e)},deleteCategoryFunc:function(e){var t=this;o.confirm("此操作將永久刪除該記錄, 是否繼續?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteCategory(e)})).catch((function(){c({type:"info",message:"已取消刪除"})}))},deleteCategory:function(e){var t=this;g.deleteCategory({group_id:e}).then((function(e){c({message:"刪除成功",type:"success"}),t.getFileCategory()})).catch((function(e){c.error("刪除失敗")}))},selectTypeFunc:function(e){this.activeType=e,this.curPage=1,this.getData()},handleCurrentChange:function(e){this.curPage=e,this.getData()},handleSizeChange:function(e){this.curPage=1,this.pageSize=e,this.getData()},getData:function(){var e=this,t={page:e.curPage,pageSize:e.pageSize,group_id:e.activeType,type:e.this_config.file_type};g.fileList(t,!0).then((function(t){e.loading=!1,e.fileList=t.data.file_list,e.totalDataNumber=e.fileList.total})).catch((function(t){e.loading=!1}))},moveTypeFunc:function(e){var t=this,i=[];t.fileList.data.forEach((function(e){e.selected&&i.push(e.file_id)})),0!=i.length?o.confirm("確定移動選中的檔案嗎, 是否繼續?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){g.moveFile({group_id:e,fileIds:i},!0).then((function(e){c({message:"移動成功",type:"success"}),t.getFileCategory(),t.getData()})).catch((function(e){}))})).catch((function(){})):c({message:"請選擇檔案",type:"warning"})},fileChange:function(e){},onBeforeUploadImage:function(e){return!0},UploadImage:function(e){var t=this,i=s.service({lock:!0,text:"圖片上傳中,請等待",background:"rgba(0, 0, 0, 0.7)"}),n=new FormData;n.append("iFile",e.file),n.append("group_id",t.activeType),n.append("file_type",t.this_config.file_type),g.uploadFile(n).then((function(n){i.close(),t.getData(),e.onSuccess()})).catch((function(t){i.close(),c({message:"本次上傳圖片失敗",type:"warning"}),e.onError()}))},selectFileFunc:function(e,t){if(e.selected)e.selected=!1,this.record--;else{if(e.selected=!0,this.record++,this.record>=this.this_config.total)return void c({message:"本次最多隻能上傳 "+this.this_config.total+" 個檔案",type:"warning"});e.selected=!0,this.record++}},deleteFileFunc:function(e){var t=this;o.confirm("此操作將永久刪除該記錄, 是否繼續?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=s.service({lock:!0,text:"圖片上傳中,請等待",background:"rgba(0, 0, 0, 0.7)"}),n=[];if(e)n.push(e.file_id);else for(var a=0;a<t.fileList.data.length;a++){var l=t.fileList.data[a];l.selected&&n.push(l.file_id)}g.deleteFiles({fileIds:n},!0).then((function(e){i.close(),c({message:"刪除成功",type:"success"}),t.getData()})).catch((function(e){i.close()}))})).catch((function(){loading.close(),c({message:"刪除失敗",type:"warning"})}))},confirmFunc:function(){for(var e=[],t=0,i=0;i<this.fileList.data.length;i++){var n=this.fileList.data[i];if(n.selected){var a={file_id:n.file_id,file_path:n.file_path};e.push(a),t++}if(t>this.this_config.total)break}this.$emit("returnImgs",e)},cancelFunc:function(){this.$emit("returnImgs",null)}}},[["render",function(e,t,o,c,s,g){var f=a,x=r,D=u,I=d("Edit"),P=i,j=d("Delete"),V=d("Select"),U=n,B=l,N=T,W=E;return p(),h("div",q,[y(B,{title:"檔案管理",modelValue:s.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=function(e){return s.dialogVisible=e}),"close-on-click-modal":!1,"custom-class":"upload-dialog","close-on-press-escape":!1,onClose:g.cancelFunc,width:s.dialogWidth,"append-to-body":!0},{footer:m((function(){return[y(f,{size:"small",onClick:g.cancelFunc},{default:m((function(){return[_("取 消")]})),_:1},8,["onClick"]),y(f,{size:"small",type:"primary",onClick:g.confirmFunc},{default:m((function(){return[_("確 定")]})),_:1},8,["onClick"])]})),default:m((function(){return[C("div",A,[C("div",M,[y(f,{size:"small",icon:"Plus",onClick:g.addCategory},{default:m((function(){return[_("新增分類")]})),_:1},8,["onClick"]),y(x,{placement:"bottom",width:"200",trigger:"click",value:!0},{reference:m((function(){return[y(f,{size:"small",icon:"CaretBottom"},{default:m((function(){return[_("移動至")]})),_:1})]})),default:m((function(){return[C("ul",O,[(p(!0),h(v,null,k(s.typeList,(function(e,t){return p(),h("li",{key:t,onClick:function(t){return g.moveTypeFunc(e.group_id)}},S(e.group_name),9,Q)})),128))])]})),_:1}),y(f,{size:"small",type:"danger",icon:"Delete",onClick:t[0]||(t[0]=function(e){return g.deleteFileFunc(!1)})},{default:m((function(){return[_("批次刪除")]})),_:1}),null!=o.selectedIndex?(p(),w(f,{key:0,size:"small",type:"danger",icon:"Menu",style:{"background-color":"#FF7300"},onClick:g.addSystem},{default:m((function(){return[_(" 系統圖標")]})),_:1},8,["onClick"])):b("",!0)]),C("div",X,[y(D,{class:"avatar-uploader",multiple:"",ref:"upload",action:"string",accept:s.accept,"before-upload":g.onBeforeUploadImage,"http-request":g.UploadImage,"show-file-list":!1,"on-change":g.fileChange},{default:m((function(){return[y(f,{size:"small",icon:"Upload",type:"primary"},{default:m((function(){return[_("點選上傳")]})),_:1})]})),_:1},8,["accept","before-upload","http-request","on-change"])])]),C("div",Y,[C("div",G,[C("ul",null,[(p(!0),h(v,null,k(s.typeList,(function(e,i){return p(),h("li",{class:F(s.activeType==e.group_id?"item active":"item"),key:i,onClick:function(t){return g.selectTypeFunc(e.group_id)}},[_(S(e.group_name)+" ",1),null!=e.group_id?(p(),h("div",{key:0,class:"operation",onClick:t[1]||(t[1]=L((function(){}),["stop"]))},[C("p",{onClick:function(t){return g.editCategoryFunc(e)}},[y(P,null,{default:m((function(){return[y(I)]})),_:1})],8,J),C("p",{onClick:function(t){return g.deleteCategoryFunc(e.group_id)}},[y(P,null,{default:m((function(){return[y(j)]})),_:1})],8,K)])):b("",!0)],10,H)})),128))])]),C("div",R,[C("ul",Z,[(p(!0),h(v,null,k(s.fileList.data,(function(e,i){return p(),h("li",{class:"file",key:i,onClick:function(t){return g.selectFileFunc(e,i)}},[1==e.selected?(p(),h("div",te,[C("div",ie,[y(P,null,{default:m((function(){return[y(V)]})),_:1})])])):b("",!0),"image"==s.this_config.file_type?(p(),h("img",{key:1,scr:e.file_path,style:z("background-image:url("+e.file_path+")"),alt:""},null,12,ne)):b("",!0),"video"==s.this_config.file_type?(p(),h("video",{key:2,height:"100",width:"100",src:e.file_path,autoplay:!1}," 您的瀏覽器不支援 video 標籤 ",8,ae)):b("",!0),C("p",le,S(e.real_name),1),C("div",{class:"bottom-shade",onClick:t[2]||(t[2]=L((function(){}),["stop"]))},[C("a",{href:"javascript:void(0)",onClick:function(t){return g.deleteFileFunc(e)}},[y(P,null,{default:m((function(){return[y(j)]})),_:1})],8,oe)])],8,ee)})),128))])])]),C("div",ce,[y(U,{onSizeChange:g.handleSizeChange,onCurrentChange:g.handleCurrentChange,"current-page":s.curPage,"page-sizes":[12,24,36,42,48],"page-size":s.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:s.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])]})),_:1},8,["modelValue","onClose","width"]),s.isShowCategory?(p(),w(N,{key:0,category:s.category,file_type:s.this_config.file_type,onCloseCategory:g.closeCategoryFunc},null,8,["category","file_type","onCloseCategory"])):b("",!0),s.isShowSystemPicture?(p(),w(W,{key:1,system:s.system,onCloseSystem:g.closeSystemFunc},null,8,["system","onCloseSystem"])):b("",!0)])}],["__scopeId","data-v-18afb026"]]))}}}));
