System.register(["./Specs-legacy-3284f260.js","./Product-legacy-39b78924.js","./element-plus-legacy-4010b94c.js","./buy-legacy-b3e82e60.js","./index-legacy-a1d733aa.js","./@vue-legacy-a5eb5da2.js","./product-legacy-4257f291.js","./@vueuse-legacy-7e5b8ef2.js","./lodash-es-legacy-93596df5.js","./async-validator-legacy-aa1fd2de.js","./dayjs-legacy-4687536e.js","./call-bind-legacy-b90429f9.js","./get-intrinsic-legacy-4f34f38e.js","./has-symbols-legacy-afcc0593.js","./has-proto-legacy-d280ab1e.js","./function-bind-legacy-b76e1749.js","./has-legacy-06d86c07.js","./@element-plus-legacy-f19c70ad.js","./escape-html-legacy-ae962a8c.js","./normalize-wheel-es-legacy-13d39621.js","./@ctrl-legacy-33dbca08.js","./vue-router-legacy-b3eb717b.js","./pinia-legacy-9406b588.js","./vue-demi-legacy-97cfbb01.js","./axios-legacy-3cda2001.js","./qs-legacy-5fc46ed9.js","./side-channel-legacy-8f83241e.js","./object-inspect-legacy-2e2b0934.js","./vue-clipboard2-legacy-b2d9783e.js","./clipboard-legacy-b868140c.js","./vue-ueditor-wrap-legacy-53d1452b.js"],(function(t,e){"use strict";var u,l,o,r,n,c,a,i,d,s,p,m,f,_,y,h,g,x,b,D,k,v,j,P;return{setters:[function(t){u=t._},function(t){l=t.P},function(t){o=t.E,r=t.d,n=t.e,c=t.m,a=t.g,i=t.J,d=t.f,s=t.l,p=t.i,m=t.c},function(t){f=t.B},function(t){_=t._,y=t.f},function(t){h=t.o,g=t.c,x=t.a,b=t.P,D=t.S,k=t.W,v=t.T,j=t.Y,P=t.X},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var e={components:{Product:l,Specs:u},data:function(){return{form:{buy_id:0,name:"",status:1,start_time:"",end_time:"",sort:"",limit_product:[],product_ids:[],send_type:"",max_times:""},tableData:[],prodcutData:[],limitProdcutData:[],loading:!1,isproduct:!1,exclude_ids:[],islimitproduct:!1,formLabelWidth:"120px",curProduct:{product_id:0},SpecExcludeIds:[],isspecs:!1,limit_exclude_ids:[]}},created:function(){this.getData()},methods:{checkTimes:function(){this.form.max_times=Math.max(1,parseInt(this.form.max_times))},deleteClick:function(t,e){var u=this.prodcutData[t];u.spec_sku_id=0,u.product_attr=""},addProduct:function(){var t=this;this.exclude_ids=[],this.prodcutData.length>0?this.prodcutData.forEach((function(e,u){t.exclude_ids=t.exclude_ids.concat(e.product_id),u==t.prodcutData.length-1&&(t.isproduct=!0)})):this.isproduct=!0},closeProductFunc:function(t){this.isproduct=t.openDialog,"success"==t.type&&this.prodcutData.push({product_id:t.params.product_id,product_name:t.params.product_name,product_num:1,product_attr:"",spec_type:t.params.spec_type,spec_sku_id:0})},getData:function(){var t=this,e=t.$route.query.buy_id;f.detailBuy({buy_id:e},!0).then((function(e){t.form=y(t.form,e.data.model),t.form.product_ids=[],t.prodcutData=e.data.model.product_ids,t.limitProdcutData=e.data.model.limit_product,t.form.start_time=e.data.model.start_time_text,t.form.end_time=e.data.model.end_time_text})).catch((function(t){}))},delProduct:function(t){var e=this.prodcutData.indexOf(t);this.prodcutData.splice(e,1)},onSubmit:function(){var t=this;if(t.checkGroup()){var e=t.form;e.product_ids=t.prodcutData,e.product_ids=JSON.stringify(e.product_ids),e.limit_product=t.limitProdcutData,t.$refs.form.validate((function(u){u&&(t.loading=!0,f.editBuy(e,!0).then((function(e){t.loading=!1,1==e.code?(o({message:e.msg,type:"success"}),t.$router.push("/plus/buyactivity/index")):t.loading=!1})).catch((function(e){t.loading=!1})))}))}else o.error("未選擇規格")},checkGroup:function(){if(0==this.form.is_product)return!0;var t=!0;return this.prodcutData.forEach((function(e,u){20!=e.spec_type||e.spec_sku_id||(t=!1)})),t},gotoBack:function(){this.$router.back(-1)},addLimitProduct:function(){var t=this;this.limit_exclude_ids=[],this.limitProdcutData.length>0?this.limitProdcutData.forEach((function(e,u){t.limit_exclude_ids=t.limit_exclude_ids.concat(1*e.product_id),u==t.limitProdcutData.length-1&&(t.islimitproduct=!0)})):this.islimitproduct=!0},closeLimitProductFunc:function(t){this.islimitproduct=t.openDialog,"success"==t.type&&this.limitProdcutData.push({product_id:t.params.product_id,product_name:t.params.product_name,product_num:1})},delLimitProduct:function(t){var e=this.limitProdcutData.indexOf(t);this.limitProdcutData.splice(e,1)},specsFunc:function(t,e,u){this.curProduct=e,this.curIndex=t,this.specType=!!u,this.isspecs=!0},closeSpecs:function(t){this.isspecs=!1,t&&"success"==t.type&&(this.prodcutData[this.curIndex].spec_sku_id=t.params.spec_sku_id,this.prodcutData[this.curIndex].product_sku_id=t.params.product_sku_id,this.prodcutData[this.curIndex].product_attr=t.params.spec_name)}}},V={class:"user"},C=x("div",{class:"common-form"},"買送設定",-1),w={class:"product-content"},I=x("span",null,"-",-1),S=x("div",{class:"gray9 f12"},"單次為達到贈送條件只贈送一次；倍數贈送為買2件A商品送1件B商品，買4件A商品送2件B商品",-1),U=x("div",{class:"gray9 f12"},"贈送型別為倍數贈送時的最大贈送倍數，最小數值為1",-1),q=x("div",{class:"tips"},"值越小越靠前",-1),Y=x("div",{class:"common-form"},"購買商品",-1),B=x("div",{class:"gray9 f12"},"滿足任一條件贈送",-1),L=x("div",{class:"common-form"},"贈送商品",-1),E=x("div",{class:"gray9 f12"},"活動商品（拼團秒殺砍價等...）不參與贈送",-1),F={key:0},$={key:1,rules:[{required:!0,message:" "}]},z={key:2},M={class:"common-button-wrapper"};t("default",_(e,[["render",function(t,e,o,f,_,y){var H=r,T=n,A=c,J=a,O=i,G=d,W=s,N=p,R=m,X=l,K=u;return h(),g("div",V,[C,x("div",w,[b(R,{ref:"form",model:_.form,rules:t.formRules,"label-width":"150px"},{default:D((function(){return[b(T,{label:"名稱",prop:"name",rules:[{required:!0,message:" "}]},{default:D((function(){return[b(H,{type:"text",modelValue:_.form.name,"onUpdate:modelValue":e[0]||(e[0]=function(t){return _.form.name=t}),placeholder:t.請輸入活動名稱,class:"max-w460"},null,8,["modelValue","placeholder"])]})),_:1}),b(T,{label:"活動狀態"},{default:D((function(){return[b(J,{modelValue:_.form.status,"onUpdate:modelValue":e[1]||(e[1]=function(t){return _.form.status=t})},{default:D((function(){return[b(A,{label:1},{default:D((function(){return[k("開啟")]})),_:1}),b(A,{label:0},{default:D((function(){return[k("關閉")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),b(T,{label:"活動時間",rules:[{required:!0,message:" "}],prop:"start_time"},{default:D((function(){return[b(O,{modelValue:_.form.start_time,"onUpdate:modelValue":e[2]||(e[2]=function(t){return _.form.start_time=t}),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"選擇開始日期"},null,8,["modelValue"]),I,b(O,{modelValue:_.form.end_time,"onUpdate:modelValue":e[3]||(e[3]=function(t){return _.form.end_time=t}),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"選擇結束日期"},null,8,["modelValue"])]})),_:1}),b(T,{label:"贈送型別"},{default:D((function(){return[b(J,{modelValue:_.form.send_type,"onUpdate:modelValue":e[4]||(e[4]=function(t){return _.form.send_type=t})},{default:D((function(){return[b(A,{label:10},{default:D((function(){return[k("單次")]})),_:1}),b(A,{label:20},{default:D((function(){return[k("倍數贈送")]})),_:1})]})),_:1},8,["modelValue"]),S]})),_:1}),20==_.form.send_type?(h(),v(T,{key:0,label:"最大贈送倍數",prop:"max_times",rules:[{required:!0,message:" "}]},{default:D((function(){return[b(H,{type:"number",min:"1",modelValue:_.form.max_times,"onUpdate:modelValue":e[5]||(e[5]=function(t){return _.form.max_times=t}),placeholder:t.請輸入最大贈送倍數,class:"max-w460",onInput:e[6]||(e[6]=function(t){return y.checkTimes()})},null,8,["modelValue","placeholder"]),U]})),_:1})):j("",!0),b(T,{label:"排序",prop:"sort",rules:[{required:!0,message:" "}]},{default:D((function(){return[b(H,{type:"text",modelValue:_.form.sort,"onUpdate:modelValue":e[7]||(e[7]=function(t){return _.form.sort=t}),placeholder:"請輸入排序",class:"max-w460"},null,8,["modelValue"]),q]})),_:1}),Y,b(T,{label:""},{default:D((function(){return[b(G,{style:{"margin-bottom":"10px"},type:"primary",onClick:e[8]||(e[8]=function(t){return y.addLimitProduct()})},{default:D((function(){return[k("新增購買商品")]})),_:1}),B,b(N,{data:_.limitProdcutData,style:{width:"60%"}},{default:D((function(){return[b(W,{prop:"product_id",label:"商品id"}),b(W,{prop:"product_name",label:"商品名稱"}),b(W,{prop:"product_num",label:"數量",rules:[{required:!0,message:" "}]},{default:D((function(t){return[b(H,{type:"number",modelValue:t.row.product_num,"onUpdate:modelValue":function(e){return t.row.product_num=e},placeholder:"",min:"1"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),b(W,{label:"操作"},{default:D((function(t){return[b(G,{type:"text",size:"small",onClick:function(e){return y.delLimitProduct(t.row)}},{default:D((function(){return[k("刪除 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]})),_:1}),L,b(T,{label:""},{default:D((function(){return[b(G,{type:"primary",onClick:e[9]||(e[9]=function(t){return y.addProduct()})},{default:D((function(){return[k("新增贈送商品")]})),_:1}),E,b(N,{data:_.prodcutData,style:{width:"60%"}},{default:D((function(){return[b(W,{prop:"product_id",label:"商品id"}),b(W,{prop:"product_name",label:"商品名稱"}),b(W,{prop:"product_num",label:"規格"},{default:D((function(t){return[20==t.row.spec_type&&t.row.spec_sku_id?(h(),g("span",F,[k(P(t.row.product_attr)+" ",1),b(G,{icon:"CloseBold",text:"",onClick:function(e){return y.deleteClick(t.$index)}},null,8,["onClick"])])):j("",!0),20!=t.row.spec_type||t.row.spec_sku_id?j("",!0):(h(),g("span",$,[b(G,{size:"small",icon:"Plus",onClick:function(e){return y.specsFunc(t.$index,t.row)}},{default:D((function(){return[k("選擇規格 ")]})),_:2},1032,["onClick"])])),10==t.row.spec_type?(h(),g("span",z,"單規格")):j("",!0)]})),_:1}),b(W,{prop:"product_num",label:"數量",rules:[{required:!0,message:" "}]},{default:D((function(t){return[b(H,{type:"number",modelValue:t.row.product_num,"onUpdate:modelValue":function(e){return t.row.product_num=e},placeholder:"",min:"1"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),b(W,{prop:"product_",label:"操作"},{default:D((function(t){return[b(G,{type:"text",size:"small",onClick:function(e){return y.delProduct(t.row)}},{default:D((function(){return[k(" 刪除 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]})),_:1})]})),_:1},8,["model","rules"]),x("div",M,[b(G,{type:"info",onClick:y.gotoBack},{default:D((function(){return[k("返回")]})),_:1},8,["onClick"]),b(G,{type:"primary",onClick:y.onSubmit,loading:_.loading},{default:D((function(){return[k("提交")]})),_:1},8,["onClick","loading"])])]),b(X,{isproduct:_.isproduct,excludeIds:_.exclude_ids,islist:!1,onCloseDialog:y.closeProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"]),b(X,{isproduct:_.islimitproduct,islist:!1,excludeIds:_.limit_exclude_ids,onCloseDialog:y.closeLimitProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"]),b(K,{isspecs:_.isspecs,productId:_.curProduct.product_id,excludeIds:_.SpecExcludeIds,islist:!1,onClose:y.closeSpecs},null,8,["isspecs","productId","excludeIds","onClose"])])}]]))}}}));
