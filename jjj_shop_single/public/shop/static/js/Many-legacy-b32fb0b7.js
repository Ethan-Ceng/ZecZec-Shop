System.register(["./element-plus-legacy-4010b94c.js","./product-legacy-4257f291.js","./@vue-legacy-a5eb5da2.js","./index-legacy-a1d733aa.js","./Upload-legacy-596c1172.js","./@vueuse-legacy-7e5b8ef2.js","./lodash-es-legacy-93596df5.js","./async-validator-legacy-aa1fd2de.js","./dayjs-legacy-4687536e.js","./call-bind-legacy-b90429f9.js","./get-intrinsic-legacy-4f34f38e.js","./has-symbols-legacy-afcc0593.js","./has-proto-legacy-d280ab1e.js","./function-bind-legacy-b76e1749.js","./has-legacy-06d86c07.js","./@element-plus-legacy-f19c70ad.js","./escape-html-legacy-ae962a8c.js","./normalize-wheel-es-legacy-13d39621.js","./@ctrl-legacy-33dbca08.js","./vue-router-legacy-b3eb717b.js","./pinia-legacy-9406b588.js","./vue-demi-legacy-97cfbb01.js","./axios-legacy-3cda2001.js","./qs-legacy-5fc46ed9.js","./side-channel-legacy-8f83241e.js","./object-inspect-legacy-2e2b0934.js","./vue-clipboard2-legacy-b2d9783e.js","./clipboard-legacy-b868140c.js","./vue-ueditor-wrap-legacy-53d1452b.js","./file-legacy-6c270a09.js","./Upload.vue_vue_type_style_index_0_scoped_18afb026_lang-legacy-88947798.js","./AddCategory-legacy-00041d02.js"],(function(e,l){"use strict";var t,a,o,n,r,u,s,c,d,p,i,m,f,_,g,h,y,b,v,w,V,x,k,j,G,U,z,A,D,F,S=document.createElement("style");return S.textContent="[data-v-3532ee49] .spec-wrap .el-tag{padding:0 10px!important;height:32px!important}.spec-many-type[data-v-3532ee49]{margin-left:180px;margin-top:16px;padding:20px;border:1px solid #e5ecf4;background:#f6f9fc}.spec-wrap .spec-hd[data-v-3532ee49]{padding:10px;display:flex;justify-content:space-between;align-items:center;background:#fff;font-weight:700}.spec-wrap .spec-hd .el-icon-delete-solid[data-v-3532ee49]{font-size:16px;color:#999}.spec-wrap .min-spc[data-v-3532ee49]{border:1px solid #dfecf8}.spec-wrap .spec-bd[data-v-3532ee49]{padding:5px;display:flex;justify-content:flex-start;flex-wrap:wrap;border-top:1px solid #dfecf8;background:#ffffff}.spec-wrap .spec-bd .el-tag[data-v-3532ee49]{color:#333}.spec-wrap .spec-bd .item[data-v-3532ee49]{position:relative;padding:5px}.spec-wrap .spec-bd .item input[data-v-3532ee49]{padding-right:30px}.spec-wrap .spec-hd a[data-v-3532ee49],.spec-wrap .spec-hd .svg-icon[data-v-3532ee49],.spec-wrap .spec-bd .item .svg-icon[data-v-3532ee49]{display:block;width:16px;height:16px}.spec-wrap .spec-bd .item a[data-v-3532ee49]{position:absolute;top:6px;right:5px;width:30px;height:30px;display:flex;justify-content:center;align-items:center}.add-spec .from-box[data-v-3532ee49]{display:flex;justify-content:flex-start}.add-spec .item[data-v-3532ee49]{display:flex;justify-content:flex-start;align-items:center;width:200px;margin-right:20px}.add-spec .item .key[data-v-3532ee49]{display:block;white-space:nowrap}\n",document.head.appendChild(S),{setters:[function(e){t=e.E,a=e.a,o=e.K,n=e.d,r=e.f,u=e.l,s=e.e,c=e.m,d=e.g,p=e.i},function(e){i=e.P},function(e){m=e.o,f=e.c,_=e.a,g=e.Q,h=e.a9,y=e.X,b=e.P,v=e.S,w=e.W,V=e.Y,x=e.$,k=e.a0,j=e.bb,G=e.b9,U=e.ap,z=e.T,A=e.ae},function(e){D=e._},function(e){F=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var l={data:function(){return{showAddGroupBtn:!0,showAddGroupForm:!1,addGroupFrom:{specName:"",specValue:""},groupLoading:!1}},inject:["form"],created:function(){this.form.model.spec_many&&this.form.model.spec_many.spec_list.length>0&&this.buildSkulist()},methods:{onToggleAddGroupForm:function(){this.showAddGroupBtn=!this.showAddGroupBtn,this.showAddGroupForm=!this.showAddGroupForm},onSubmitAddGroup:function(){var e=this;if(""===e.addGroupFrom.specName||""===e.addGroupFrom.specValue)return t("請填寫規則名或規則值"),!1;e.groupLoading=!0;var l={spec_name:e.addGroupFrom.specName,spec_value:e.addGroupFrom.specValue};i.addSpec(l,!0).then((function(l){e.groupLoading=!1,e.form.model.spec_many.spec_attr.push({group_id:l.data.spec_id,group_name:e.addGroupFrom.specName,spec_items:[{item_id:l.data.spec_value_id,spec_value:e.addGroupFrom.specValue}],tempValue:"",loading:!1}),e.addGroupFrom.specName="",e.addGroupFrom.specValue="",e.onToggleAddGroupForm(),e.buildSkulist()})).catch((function(l){e.groupLoading=!1}))},onSubmitAddValue:function(e){var l=this;if(!e.hasOwnProperty("tempValue")||""===e.tempValue)return t("規格值不能為空"),!1;e.loading=!0;var a={spec_id:e.group_id,spec_value:e.tempValue};i.addSpecValue(a,!0).then((function(t){e.loading=!1,e.spec_items.push({item_id:t.data.spec_value_id,spec_value:e.tempValue}),e.tempValue="",l.buildSkulist()})).catch((function(l){e.loading=!1}))},buildSkulist:function(){for(var e=this,l=e.form.model.spec_many.spec_attr,t=[],a=0;a<l.length;a++)t.push(l[a].spec_items);for(var o=e.calcDescartes(t),n=[],r=0;r<o.length;r++){var u=[],s=[];Array.isArray(o[r])?u=o[r]:u.push(o[r]);for(var c=0;c<u.length;c++)s.push(u[c].item_id);n.push({product_sku_id:0,spec_sku_id:s.join("_"),rows:u,spec_form:{}})}if(e.form.model.spec_many.spec_list.length>0&&n.length>0)for(var d=function(l){var t=e.form.model.spec_many.spec_list.filter((function(e){return e.spec_sku_id===n[l].spec_sku_id}));t.length>0&&(n[l].spec_form=t[0].spec_form,n[l].product_sku_id=t[0].product_sku_id)},p=0;p<n.length;p++)d(p);e.form.model.spec_many.spec_list=n},calcDescartes:function(e){return e.length<2?e[0]||[]:[].reduce.call(e,(function(e,l){var t=[];return e.forEach((function(e){l.forEach((function(l){var a=[].concat(Array.isArray(e)?e:[e]);a.push(l),t.push(a)}))})),t}))},onDeleteGroup:function(e){var l=this;a.confirm("刪除後不可恢復，確認刪除該記錄嗎?","提示",{type:"warning"}).then((function(){l.form.model.spec_many.spec_attr.splice(e,1),l.buildSkulist()}))},onDeleteValue:function(e,l){var o=this;o.form.isSpecLocked?t({message:"本商品正在搞活動，不能刪除規格！",type:"warning"}):a.confirm("刪除後不可恢復，確認刪除該記錄嗎?","提示",{type:"warning"}).then((function(){o.form.model.spec_many.spec_attr[e].spec_items.splice(l,1),o.buildSkulist()}))}}},S=function(e){return j("data-v-3532ee49"),e=e(),G(),e},C={class:"spec-many-type"},I={class:"spec-wrap"},T={class:"spec-hd"},B={class:"input-box"},L={class:"spec-bd"},N={class:"item"},$={class:"item"},q={key:1},E={class:"add-spec mb16"},P={class:"from-box"},M={class:"item"},O=S((function(){return _("span",{class:"key"},"規格名：",-1)})),R={class:"item"},K=S((function(){return _("span",{class:"key"},"規格值：",-1)})),Q={class:"mt16"},W=["onClick"];e("default",D({components:{Type:D(l,[["render",function(e,l,t,a,u,s){var c,d,p,i=o,j=n,G=r;return m(),f("div",C,[_("div",I,[s.form.model&&s.form.model.spec_many&&s.form.model.spec_many.spec_attr?(m(!0),f(g,{key:0},h(s.form.model.spec_many.spec_attr,(function(e,l){return m(),f("div",{class:"mb16 min-spc",key:e.group_name},[_("div",T,[_("div",B,y(e.group_name),1)]),_("div",L,[(m(!0),f(g,null,h(e.spec_items,(function(e,t){return m(),f("div",{class:"item",key:e.spec_value},[b(i,{closable:"",onClose:function(e){return s.onDeleteValue(l,t)}},{default:v((function(){return[w(y(e.spec_value),1)]})),_:2},1032,["onClose"])])})),128)),_("div",N,[b(j,{size:"small",modelValue:e.tempValue,"onUpdate:modelValue":function(l){return e.tempValue=l},style:{width:"160px"}},null,8,["modelValue","onUpdate:modelValue"])]),_("div",$,[b(G,{size:"small",onClick:function(l){return s.onSubmitAddValue(e)},loading:e.loading},{default:v((function(){return[w("新增")]})),_:2},1032,["onClick","loading"])])])])})),128)):V("",!0),s.form.isSpecLocked||0!==(null===(c=s.form.model)||void 0===c||null===(d=c.spec_many)||void 0===d||null===(p=d.spec_attr)||void 0===p?void 0:p.length)?V("",!0):(m(),f("div",q,[x(b(G,{size:"small",class:"el-icon-circle-plus",onClick:s.onToggleAddGroupForm},{default:v((function(){return[w("新增規格")]})),_:1},8,["onClick"]),[[k,u.showAddGroupBtn]])])),x(_("div",E,[_("div",P,[_("div",M,[O,b(j,{size:"small",modelValue:u.addGroupFrom.specName,"onUpdate:modelValue":l[0]||(l[0]=function(e){return u.addGroupFrom.specName=e}),placeholder:"請輸入規格名稱"},null,8,["modelValue"])]),_("div",R,[K,b(j,{size:"small",modelValue:u.addGroupFrom.specValue,"onUpdate:modelValue":l[1]||(l[1]=function(e){return u.addGroupFrom.specValue=e}),placeholder:"請輸入規格值"},null,8,["modelValue"])]),b(G,{type:"primary",size:"small",loading:u.groupLoading,onClick:s.onSubmitAddGroup,plain:""},{default:v((function(){return[w("確定")]})),_:1},8,["loading","onClick"]),b(G,{size:"small",onClick:s.onToggleAddGroupForm},{default:v((function(){return[w("取消")]})),_:1},8,["onClick"])])],512),[[k,!u.showAddGroupBtn]])])])}],["__scopeId","data-v-3532ee49"]]),Table:D({components:{Upload:F},data:function(){return{batchData:{detail:"",type:0,product_price:"",line_price:"",low_price:"",stock_num:"",product_weight:""},isupload:!1,spec_index:-1}},inject:["form"],created:function(){},methods:{objectSpanMethod:function(e){e.row,e.column;var l=e.rowIndex,t=e.columnIndex,a=this.form.model.spec_many.spec_attr,o=1;if(t<a.length-1){for(var n=t+1,r=a.length-1,u=n;u<=r;u++)o*=a[u].spec_items.length;return l%o==0?{rowspan:o,colspan:1}:{rowspan:0,colspan:0}}},onSubmitBatchData:function(){var e=this;e.form.model.spec_many.spec_list.forEach((function(l){for(var t in e.batchData)e.batchData.hasOwnProperty(t)&&e.batchData[t]&&(l.spec_form[t]=e.batchData[t])}))},chooseSpecImage:function(e){this.isupload=!0,this.spec_index=e},returnImgsFunc:function(e){this.isupload=!1,this.form.model.spec_many.spec_list[this.spec_index].spec_form.image_id=e[0].file_id,this.form.model.spec_many.spec_list[this.spec_index].spec_form.image_path=e[0].file_path}}},[["render",function(e,l,t,a,o,i){var k=n,j=r,G=u,A=s,D=c,S=d,C=p,I=F,T=U("img-url");return m(),f("div",Q,[i.form.model.spec_many&&i.form.model.spec_many.spec_list.length>0?(m(),z(A,{key:0,label:"規格明細："},{default:v((function(){return[_("div",null,[w(" 批次設定 "),b(k,{size:"small",modelValue:o.batchData.product_price,"onUpdate:modelValue":l[0]||(l[0]=function(e){return o.batchData.product_price=e}),placeholder:"銷售價",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),b(k,{size:"small",modelValue:o.batchData.line_price,"onUpdate:modelValue":l[1]||(l[1]=function(e){return o.batchData.line_price=e}),placeholder:"劃線價",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),b(k,{size:"small",modelValue:o.batchData.low_price,"onUpdate:modelValue":l[2]||(l[2]=function(e){return o.batchData.low_price=e}),placeholder:"成本價",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),b(k,{size:"small",modelValue:o.batchData.stock_num,"onUpdate:modelValue":l[3]||(l[3]=function(e){return o.batchData.stock_num=e}),placeholder:"庫存",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),b(k,{size:"small",modelValue:o.batchData.product_weight,"onUpdate:modelValue":l[4]||(l[4]=function(e){return o.batchData.product_weight=e}),placeholder:"重量",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),b(j,{size:"small",onClick:i.onSubmitBatchData,style:{"margin-left":"4px"}},{default:v((function(){return[w("應用")]})),_:1},8,["onClick"])]),i.form.model&&i.form.model.spec_many&&i.form.model.spec_many.spec_attr?(m(),z(C,{key:0,size:"small",data:i.form.model.spec_many.spec_list,"span-method":i.objectSpanMethod,border:"",style:{width:"100%","margin-top":"20px"}},{default:v((function(){return[(m(!0),f(g,null,h(i.form.model.spec_many.spec_attr,(function(e,l){return m(),z(G,{label:e.group_name,key:e.group_name},{default:v((function(e){return[w(y(e.row.rows[l].spec_value),1)]})),_:2},1032,["label"])})),128)),b(G,{label:"詳情",width:"240"},{default:v((function(e){return[b(A,{label:"",rules:[{required:!0,message:" "}],style:{"margin-bottom":"0"},prop:"model.spec_many.spec_list."+e.$index+".spec_form.detail"},{default:v((function(){return[b(k,{prop:"detail",modelValue:e.row.spec_form.detail,"onUpdate:modelValue":function(l){return e.row.spec_form.detail=l},autosize:"",type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1}),b(G,{label:"型別"},{default:v((function(e){return[b(A,{label:"",rules:[{required:!0,message:""}],style:{"margin-bottom":"0"},prop:"model.spec_many.spec_list."+e.$index+".spec_form.type"},{default:v((function(){return[b(S,{modelValue:e.row.spec_form.type,"onUpdate:modelValue":function(l){return e.row.spec_form.type=l},size:"lager"},{default:v((function(){return[b(D,{label:0},{default:v((function(){return[w("主商品")]})),_:1}),b(D,{label:1},{default:v((function(){return[w("推薦加購")]})),_:1})]})),_:2},1032,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1}),b(G,{label:"規格圖片"},{default:v((function(e){return[x(_("img",{alt:"",width:35,height:35,onClick:function(l){return i.chooseSpecImage(e.$index)}},null,8,W),[[T,e.row.spec_form.image_path]])]})),_:1}),b(G,{label:"商品條碼"},{default:v((function(e){return[b(A,{label:"",style:{"margin-bottom":"0"}},{default:v((function(){return[b(k,{size:"small",prop:"product_no",modelValue:e.row.spec_form.product_no,"onUpdate:modelValue":function(l){return e.row.spec_form.product_no=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),b(G,{label:"銷售價"},{default:v((function(e){return[b(A,{label:"",rules:[{required:!0,message:" "}],prop:"model.spec_many.spec_list."+e.$index+".spec_form.product_price",style:{"margin-bottom":"0"}},{default:v((function(){return[b(k,{size:"small",prop:"product_price",modelValue:e.row.spec_form.product_price,"onUpdate:modelValue":function(l){return e.row.spec_form.product_price=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1}),b(G,{label:"劃線價"},{default:v((function(e){return[b(A,{label:"",style:{"margin-bottom":"0"}},{default:v((function(){return[b(k,{size:"small",prop:"line_price",modelValue:e.row.spec_form.line_price,"onUpdate:modelValue":function(l){return e.row.spec_form.line_price=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),b(G,{label:"成本價"},{default:v((function(e){return[b(A,{label:"",style:{"margin-bottom":"0"}},{default:v((function(){return[b(k,{size:"small",prop:"low_price",modelValue:e.row.spec_form.low_price,"onUpdate:modelValue":function(l){return e.row.spec_form.low_price=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),b(G,{label:"庫存"},{default:v((function(e){return[b(A,{label:"",rules:[{required:!0,message:" "}],prop:"model.spec_many.spec_list."+e.$index+".spec_form.stock_num",style:{"margin-bottom":"0"}},{default:v((function(){return[b(k,{size:"small",prop:"stock_num",modelValue:e.row.spec_form.stock_num,"onUpdate:modelValue":function(l){return e.row.spec_form.stock_num=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1}),b(G,{label:"重量(kg)"},{default:v((function(e){return[b(A,{label:"",rules:[{required:!0,message:" "}],prop:"model.spec_many.spec_list."+e.$index+".spec_form.product_weight",style:{"margin-bottom":"0"}},{default:v((function(){return[b(k,{size:"small",prop:"product_weight",modelValue:e.row.spec_form.product_weight,"onUpdate:modelValue":function(l){return e.row.spec_form.product_weight=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1})]})),_:1},8,["data","span-method"])):V("",!0)]})),_:1})):V("",!0),o.isupload?(m(),z(I,{key:1,isupload:o.isupload,onReturnImgs:i.returnImgsFunc},{default:v((function(){return[w("上傳圖片")]})),_:1},8,["isupload","onReturnImgs"])):V("",!0)])}]])}},[["render",function(e,l,t,a,o,n){var r=A("Type"),u=A("Table");return m(),f("div",null,[b(r),b(u)])}]]))}}}));
