!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var l=Object.prototype.toString.call(e).slice(8,-1);"Object"===l&&e.constructor&&(l=e.constructor.name);if("Map"===l||"Set"===l)return Array.from(e);if("Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}System.register(["./Product-legacy-39b78924.js","./GetCoupon-legacy-8e6141b9.js","./Upload-legacy-596c1172.js","./element-plus-legacy-4010b94c.js","./index-legacy-a1d733aa.js","./lottery-legacy-e3fd2f88.js","./@vue-legacy-a5eb5da2.js","./product-legacy-4257f291.js","./coupon-legacy-deb65708.js","./file-legacy-6c270a09.js","./Upload.vue_vue_type_style_index_0_scoped_18afb026_lang-legacy-88947798.js","./AddCategory-legacy-00041d02.js","./@vueuse-legacy-7e5b8ef2.js","./lodash-es-legacy-93596df5.js","./async-validator-legacy-aa1fd2de.js","./dayjs-legacy-4687536e.js","./call-bind-legacy-b90429f9.js","./get-intrinsic-legacy-4f34f38e.js","./has-symbols-legacy-afcc0593.js","./has-proto-legacy-d280ab1e.js","./function-bind-legacy-b76e1749.js","./has-legacy-06d86c07.js","./@element-plus-legacy-f19c70ad.js","./escape-html-legacy-ae962a8c.js","./normalize-wheel-es-legacy-13d39621.js","./@ctrl-legacy-33dbca08.js","./vue-router-legacy-b3eb717b.js","./pinia-legacy-9406b588.js","./vue-demi-legacy-97cfbb01.js","./axios-legacy-3cda2001.js","./qs-legacy-5fc46ed9.js","./side-channel-legacy-8f83241e.js","./object-inspect-legacy-2e2b0934.js","./vue-clipboard2-legacy-b2d9783e.js","./clipboard-legacy-b868140c.js","./vue-ueditor-wrap-legacy-53d1452b.js"],(function(t,n){"use strict";var l,a,o,i,r,u,c,s,d,p,f,m,g,y,h,_,b,v,w,j,C,k,D,V,x,z,P;return{setters:[function(e){l=e.P},function(e){a=e._},function(e){o=e._},function(e){i=e.E,r=e.d,u=e.e,c=e.O,s=e.f,d=e.C,p=e.l,f=e.i,m=e.c,g=e.q},function(e){y=e._,h=e.f},function(e){_=e.L},function(e){b=e.ap,v=e.o,w=e.c,j=e.a,C=e.P,k=e.S,D=e.W,V=e.Y,x=e.T,z=e.X,P=e.$},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var n={components:{GetCoupon:a,Product:l,Upload:o},data:function(){return{form:{prize:[],points:0,is_times:0,coupon_num:1,times:"",name:"",lottery_id:0,image_id:"",content:"",file_path:"",status:0},file_path:"",Grade:{},tableData:[],loading:!1,open_add:!1,isproduct:!1,exclude_ids:[],spec_type:10,isupload:!1,formRules:{image_id:[{required:!0,message:"請上傳背景圖",trigger:"blur"}]},formLabelWidth:"120px",isPoint:!1,point:"",isNothing:!1,isLottery:-1,prize_ids:[]}},created:function(){this.getData()},methods:{hasImages:function(e){return e||""},addCoupon:function(){this.open_add=!0},closeProductDialogFunc:function(e){if(this.open_add=e.openDialog,"success"==e.type){var t={prize_id:0,award_id:e.params.coupon_id,name:e.params.name,stock:1,type:1,image:"",points:0,is_default:0,is_play:0};this.tableData.push(t)}},addProduct:function(){this.isproduct=!0},closeProductFunc:function(e){if(this.isproduct=e.openDialog,"success"==e.type){var t={prize_id:0,award_id:e.params.product_id,name:e.params.product_name,stock:1,type:3,image:e.params.product_image,points:0,is_default:0,is_play:0};this.tableData.push(t)}},addPoint:function(){this.isPoint=!0},closePointFunc:function(e){this.isPoint=e.openDialog;var t=this.point;if(e){var n={prize_id:0,award_id:0,name:"積分",points:0,stock:1,type:2,image:"",is_default:0,is_play:0};n.points=t,n.name=t+"積分",this.tableData.push(n)}},addNothing:function(){this.tableData.push({prize_id:0,award_id:0,name:"祝你好運",stock:1,type:0,image:"",points:0,is_default:0,is_play:0})},getData:function(){var e=this;_.getData(!0).then((function(t){e.form=h(e.form,t.data.data),null!=e.form.prize&&(e.tableData=e.form.prize,e.prize_ids=[])})).catch((function(e){}))},delProduct:function(e){var t=this,n=t.prodcutData.indexOf(e);t.prodcutData.splice(n,1),t.form.product.splice(n,1)},delcoupon:function(t){var n=this,l=n.tableData.indexOf(t);t.prize_id&&(n.prize_ids=[].concat(e(n.prize_ids),[t.prize_id])),n.tableData.splice(l,1)},onSubmit:function(){var e=this,t=e.form;if(8==e.tableData.length){var n=!1;e.tableData.forEach((function(e,t){1!=e.is_default||(n=!0)})),n?(t.prize=e.tableData,e.prize_ids.length>0?t.prize_ids=e.prize_ids:t.prize_ids="",e.$refs.form.validate((function(n){n&&(e.loading=!0,_.EditLottery(t,!0).then((function(t){e.loading=!1,1==t.code?(i({message:t.msg,type:"success"}),e.tableData=[],e.getData()):e.loading=!1})).catch((function(t){e.loading=!1})))}))):i.error("請設定預設項")}else i.error("請設定8項禮品資訊")},changeImg:function(e){this.isLottery=this.tableData.indexOf(e),this.isupload=!0},openUpload:function(e){this.type=e,this.isupload=!0},returnImgsFunc:function(e){null!=e&&e.length>0&&(-1!=this.isLottery?this.tableData[this.isLottery].image=e[0].file_path:(this.form.file_path=e[0].file_path,this.form.image_id=e[0].file_id)),this.isLottery=-1,this.isupload=!1},gotoBack:function(){this.$router.back(-1)},setCurrent:function(e){this.$refs.singleTable.setCurrentRow(e)},handleCurrentChange:function(e){this.currentRow=e},changeSwitch:function(e){this.tableData.forEach((function(e,t){e.is_default=0})),e.is_default=1},changePlaySwitch:function(e,t){t.is_play=e}}},U={class:"user"},I=j("div",{class:"common-form"},"編輯轉盤",-1),S={class:"product-content"},q={key:0,class:"img"},A=["src"],F=j("div",null,"建議圖片上傳尺寸為750px*1340px",-1),L=j("div",{class:"common-form"},"禮品設定",-1),O=j("div",null,"建議圖片上傳尺寸為200px*200px",-1),R={key:1},$=["onClick"],E={key:0},T={key:1},G={key:2},N={key:3},B={class:"common-button-wrapper"},W={class:"dialog-footer"};t("default",y(n,[["render",function(e,t,n,i,y,h){var _=r,J=u,M=c,X=s,Y=d,H=p,K=f,Q=m,Z=g,ee=o,te=a,ne=l,le=b("img-url");return v(),w("div",U,[I,j("div",S,[C(Q,{ref:"form",model:y.form,rules:y.formRules,"label-width":"150px"},{default:k((function(){return[C(J,{label:"每日次數",prop:"times",rules:[{required:!0,message:" "}]},{default:k((function(){return[C(_,{type:"text",modelValue:y.form.times,"onUpdate:modelValue":t[0]||(t[0]=function(e){return y.form.times=e}),placeholder:"請輸入每日次數",class:"max-w460"},null,8,["modelValue"])]})),_:1}),C(J,{label:"消耗積分",prop:"points",rules:[{required:!0,message:" "}]},{default:k((function(){return[C(_,{type:"text",modelValue:y.form.points,"onUpdate:modelValue":t[1]||(t[1]=function(e){return y.form.points=e}),placeholder:"請輸入消耗積分",class:"max-w460"},null,8,["modelValue"])]})),_:1}),C(J,{label:"活動狀態",prop:"status",rules:[{required:!0,message:" "}]},{default:k((function(){return[C(M,{modelValue:y.form.status,"onUpdate:modelValue":t[2]||(t[2]=function(e){return y.form.status=e}),"active-color":"#13ce66","inactive-color":"#999999","active-value":1,"inactive-value":0},null,8,["modelValue"])]})),_:1}),C(J,{label:"活動規則",prop:"content",rules:[{required:!0,message:" "}]},{default:k((function(){return[C(_,{type:"textarea",rows:3,modelValue:y.form.content,"onUpdate:modelValue":t[3]||(t[3]=function(e){return y.form.content=e}),placeholder:"請輸入活動規則",class:"max-w460"},null,8,["modelValue"])]})),_:1}),C(J,{label:"背景圖",prop:"file_path"},{default:k((function(){return[C(Y,null,{default:k((function(){return[C(X,{type:"primary",onClick:h.openUpload,size:"small"},{default:k((function(){return[D("選擇圖片")]})),_:1},8,["onClick"]),""!=y.form.file_path?(v(),w("div",q,[j("img",{src:y.form.file_path,width:"100",height:"100"},null,8,A)])):V("",!0)]})),_:1}),F]})),_:1}),L,O,y.tableData.length<8?(v(),x(J,{key:0,label:""},{default:k((function(){return[C(X,{type:"primary",onClick:t[4]||(t[4]=function(e){return h.addCoupon()})},{default:k((function(){return[D("新增優惠券")]})),_:1}),C(X,{type:"primary",onClick:t[5]||(t[5]=function(e){return h.addProduct()})},{default:k((function(){return[D("新增商品")]})),_:1}),C(X,{type:"primary",onClick:t[6]||(t[6]=function(e){return h.addPoint()})},{default:k((function(){return[D("新增積分")]})),_:1}),C(X,{type:"primary",onClick:t[7]||(t[7]=function(e){return h.addNothing()})},{default:k((function(){return[D("新增空項")]})),_:1})]})),_:1})):V("",!0),C(J,null,{default:k((function(){return[C(K,{data:y.tableData,"highlight-current-row":"",onCurrentChange:h.handleCurrentChange,ref:"singleTable"},{default:k((function(){return[C(H,{prop:"lottery_id",label:"序號",type:"index"}),C(H,{prop:"name",label:"名稱",rules:[{required:!0,message:" "}]},{default:k((function(e){return[0==e.row.type?(v(),x(_,{key:0,type:"text",modelValue:e.row.name,"onUpdate:modelValue":function(t){return e.row.name=t},placeholder:"請輸入"},null,8,["modelValue","onUpdate:modelValue"])):(v(),w("span",R,z(e.row.name),1))]})),_:1}),C(H,{prop:"image",label:"圖片",width:"180"},{default:k((function(e){return[P(j("img",{alt:"",width:50,onClick:function(t){return h.changeImg(e.row)}},null,8,$),[[le,h.hasImages(e.row.image)]])]})),_:1}),C(H,{prop:"type",label:"型別"},{default:k((function(e){return[0==e.row.type?(v(),w("span",E,"無禮品")):V("",!0),1==e.row.type?(v(),w("span",T,"優惠券")):V("",!0),2==e.row.type?(v(),w("span",G,"積分")):V("",!0),3==e.row.type?(v(),w("span",N,"商品")):V("",!0)]})),_:1}),C(H,{prop:"stock",label:"活動庫存",rules:[{required:!0,message:" "}]},{default:k((function(e){return[C(_,{type:"number",modelValue:e.row.stock,"onUpdate:modelValue":function(t){return e.row.stock=t},placeholder:""},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),C(H,{prop:"draw_num",label:"已送出"}),C(H,{prop:"is_default",label:"是否預設",rules:[{required:!0,message:" "}]},{default:k((function(e){return[C(M,{onChange:function(t){return h.changeSwitch(e.row)},"model-value":1==e.row.is_default,"active-color":"#13ce66","inactive-color":"#999999"},null,8,["onChange","model-value"])]})),_:1}),C(H,{prop:"is_play",label:"是否播報",rules:[{required:!0,message:" "}]},{default:k((function(e){return[C(M,{onChange:function(t){return h.changePlaySwitch(t,e.row)},"active-value":1,"inactive-value":0,modelValue:e.row.is_play,"onUpdate:modelValue":function(t){return e.row.is_play=t},"active-color":"#13ce66","inactive-color":"#999999"},null,8,["onChange","modelValue","onUpdate:modelValue"])]})),_:1}),C(H,{prop:"address",label:"操作"},{default:k((function(e){return[C(X,{type:"text",size:"small",onClick:function(t){return h.delcoupon(e.row)}},{default:k((function(){return[D(" 刪除 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data","onCurrentChange"])]})),_:1})]})),_:1},8,["model","rules"]),j("div",B,[C(X,{type:"info",onClick:h.gotoBack},{default:k((function(){return[D("返回")]})),_:1},8,["onClick"]),C(X,{type:"primary",onClick:h.onSubmit,loading:y.loading},{default:k((function(){return[D("提交")]})),_:1},8,["onClick","loading"])])]),C(Z,{title:"新增積分",modelValue:y.isPoint,"onUpdate:modelValue":t[11]||(t[11]=function(e){return y.isPoint=e})},{footer:k((function(){return[j("div",W,[C(X,{onClick:t[9]||(t[9]=function(e){return h.closePointFunc(!1)})},{default:k((function(){return[D("取 消")]})),_:1}),C(X,{type:"primary",onClick:t[10]||(t[10]=function(e){return h.closePointFunc(!0)})},{default:k((function(){return[D("確 定")]})),_:1})])]})),default:k((function(){return[C(_,{modelValue:y.point,"onUpdate:modelValue":t[8]||(t[8]=function(e){return y.point=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1},8,["modelValue"]),y.isupload?(v(),x(ee,{key:0,isupload:y.isupload,type:e.type,onReturnImgs:h.returnImgsFunc},{default:k((function(){return[D("上傳圖片")]})),_:1},8,["isupload","type","onReturnImgs"])):V("",!0),y.open_add?(v(),x(te,{key:1,open_add:y.open_add,onCloseDialog:t[12]||(t[12]=function(e){return h.closeProductDialogFunc(e)})},{default:k((function(){return[D("選擇優惠券彈出層")]})),_:1},8,["open_add"])):V("",!0),C(ne,{isproduct:y.isproduct,excludeIds:y.exclude_ids,islist:!1,onCloseDialog:h.closeProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"])])}]]))}}}))}();
