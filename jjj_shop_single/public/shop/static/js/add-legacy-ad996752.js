System.register(["./Specs-legacy-3284f260.js","./Product-legacy-39b78924.js","./element-plus-legacy-4010b94c.js","./buy-legacy-b3e82e60.js","./index-legacy-a1d733aa.js","./@vue-legacy-a5eb5da2.js","./product-legacy-4257f291.js","./@vueuse-legacy-7e5b8ef2.js","./lodash-es-legacy-93596df5.js","./async-validator-legacy-aa1fd2de.js","./dayjs-legacy-4687536e.js","./call-bind-legacy-b90429f9.js","./get-intrinsic-legacy-4f34f38e.js","./has-symbols-legacy-afcc0593.js","./has-proto-legacy-d280ab1e.js","./function-bind-legacy-b76e1749.js","./has-legacy-06d86c07.js","./@element-plus-legacy-f19c70ad.js","./escape-html-legacy-ae962a8c.js","./normalize-wheel-es-legacy-13d39621.js","./@ctrl-legacy-33dbca08.js","./vue-router-legacy-b3eb717b.js","./pinia-legacy-9406b588.js","./vue-demi-legacy-97cfbb01.js","./axios-legacy-3cda2001.js","./qs-legacy-5fc46ed9.js","./side-channel-legacy-8f83241e.js","./object-inspect-legacy-2e2b0934.js","./vue-clipboard2-legacy-b2d9783e.js","./clipboard-legacy-b868140c.js","./vue-ueditor-wrap-legacy-53d1452b.js"],(function(e,t){"use strict";var u,l,o,n,r,c,a,i,s,d,p,m,f,_,y,h,g,x,b,k,v,j,D;return{setters:[function(e){u=e._},function(e){l=e.P},function(e){o=e.E,n=e.d,r=e.e,c=e.m,a=e.g,i=e.J,s=e.f,d=e.l,p=e.i,m=e.c},function(e){f=e.B},function(e){_=e._},function(e){y=e.o,h=e.c,g=e.a,x=e.P,b=e.S,k=e.W,v=e.T,j=e.Y,D=e.X},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t={components:{Product:l,Specs:u},data:function(){return{form:{name:"",status:1,start_time:"",end_time:"",sort:"",limit_product:[],product_ids:[],send_type:10,max_times:1},tableData:[],prodcutData:[],limitProdcutData:[],loading:!1,isproduct:!1,exclude_ids:[],islimitproduct:!1,formLabelWidth:"120px",curProduct:{product_id:0},SpecExcludeIds:[],isspecs:!1,limit_exclude_ids:[]}},created:function(){},methods:{checkTimes:function(){this.form.max_times=Math.max(1,parseInt(this.form.max_times))},deleteClick:function(e,t){var u=this.prodcutData[e];u.spec_sku_id=0,u.product_attr=""},addProduct:function(){var e=this;this.exclude_ids=[],this.prodcutData.length>0?this.prodcutData.forEach((function(t,u){e.exclude_ids=e.exclude_ids.concat(t.product_id),u==e.prodcutData.length-1&&(e.isproduct=!0)})):this.isproduct=!0},closeProductFunc:function(e){this.isproduct=e.openDialog,"success"==e.type&&this.prodcutData.push({product_id:e.params.product_id,product_name:e.params.product_name,product_num:1,product_attr:"",spec_type:e.params.spec_type,spec_sku_id:0})},delProduct:function(e){var t=this.prodcutData.indexOf(e);this.prodcutData.splice(t,1)},onSubmit:function(){var e=this;if(e.checkGroup()){var t=e.form;t.product_ids=e.prodcutData,t.product_ids=JSON.stringify(t.product_ids),t.limit_product=e.limitProdcutData,e.$refs.form.validate((function(u){u&&(e.loading=!0,f.saveBuy(t,!0).then((function(t){e.loading=!1,1==t.code?(o({message:t.msg,type:"success"}),e.$router.push("/plus/buyactivity/index")):e.loading=!1})).catch((function(t){e.loading=!1})))}))}else o.error("未選擇規格")},checkGroup:function(){if(0==this.is_product)return!0;var e=!0;return this.prodcutData.forEach((function(t,u){20!=t.spec_type||t.spec_sku_id||(e=!1)})),e},gotoBack:function(){this.$router.back(-1)},addLimitProduct:function(){var e=this;this.limit_exclude_ids=[],this.limitProdcutData.length>0?this.limitProdcutData.forEach((function(t,u){e.limit_exclude_ids=e.limit_exclude_ids.concat(1*t.product_id),u==e.limitProdcutData.length-1&&(e.islimitproduct=!0)})):this.islimitproduct=!0},closeLimitProductFunc:function(e){this.islimitproduct=e.openDialog,"success"==e.type&&this.limitProdcutData.push({product_id:e.params.product_id,product_name:e.params.product_name,product_num:1})},delLimitProduct:function(e){var t=this.limitProdcutData.indexOf(e);this.limitProdcutData.splice(t,1)},specsFunc:function(e,t,u){this.curProduct=t,this.curIndex=e,this.specType=!!u,this.isspecs=!0},closeSpecs:function(e){this.isspecs=!1,e&&"success"==e.type&&(this.prodcutData[this.curIndex].spec_sku_id=e.params.spec_sku_id,this.prodcutData[this.curIndex].product_sku_id=e.params.product_sku_id,this.prodcutData[this.curIndex].product_attr=e.params.spec_name)}}},P={class:"user"},V=g("div",{class:"common-form"},"買送設定",-1),C={class:"product-content"},w=g("span",null,"-",-1),I=g("div",{class:"gray9 f12"},"單次為達到贈送條件只贈送一次；倍數贈送為買2件A商品送1件B商品，買4件A商品送2件B商品",-1),S=g("div",{class:"gray9 f12"},"贈送型別為倍數贈送時的最大贈送倍數，最小數值為1",-1),U=g("div",{class:"tips"},"值越小越靠前",-1),Y=g("div",{class:"common-form"},"購買商品",-1),q=g("div",{class:"gray9 f12"},"滿足任一條件贈送",-1),L=g("div",{class:"common-form"},"贈送商品",-1),B=g("div",{class:"gray9 f12"},"活動商品（拼團秒殺砍價等...）不參與贈送",-1),E={key:0},F={key:1,rules:[{required:!0,message:" "}]},z={key:2},M={class:"common-button-wrapper"};e("default",_(t,[["render",function(e,t,o,f,_,$){var H=n,T=r,A=c,J=a,O=i,G=s,W=d,N=p,R=m,X=l,K=u;return y(),h("div",P,[V,g("div",C,[x(R,{ref:"form",model:_.form,rules:e.formRules,"label-width":"150px"},{default:b((function(){return[x(T,{label:"名稱",prop:"name",rules:[{required:!0,message:" "}]},{default:b((function(){return[x(H,{type:"text",modelValue:_.form.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return _.form.name=e}),placeholder:e.請輸入活動名稱,class:"max-w460"},null,8,["modelValue","placeholder"])]})),_:1}),x(T,{label:"活動狀態"},{default:b((function(){return[x(J,{modelValue:_.form.status,"onUpdate:modelValue":t[1]||(t[1]=function(e){return _.form.status=e})},{default:b((function(){return[x(A,{label:1},{default:b((function(){return[k("開啟")]})),_:1}),x(A,{label:0},{default:b((function(){return[k("關閉")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),x(T,{label:"活動時間",rules:[{required:!0,message:" "}],prop:"start_time"},{default:b((function(){return[x(O,{modelValue:_.form.start_time,"onUpdate:modelValue":t[2]||(t[2]=function(e){return _.form.start_time=e}),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"選擇開始日期"},null,8,["modelValue"]),w,x(O,{modelValue:_.form.end_time,"onUpdate:modelValue":t[3]||(t[3]=function(e){return _.form.end_time=e}),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"選擇結束日期"},null,8,["modelValue"])]})),_:1}),x(T,{label:"贈送型別"},{default:b((function(){return[x(J,{modelValue:_.form.send_type,"onUpdate:modelValue":t[4]||(t[4]=function(e){return _.form.send_type=e})},{default:b((function(){return[x(A,{label:10},{default:b((function(){return[k("單次")]})),_:1}),x(A,{label:20},{default:b((function(){return[k("倍數贈送")]})),_:1})]})),_:1},8,["modelValue"]),I]})),_:1}),20==_.form.send_type?(y(),v(T,{key:0,label:"最大贈送倍數",prop:"max_times",rules:[{required:!0,message:" "}]},{default:b((function(){return[x(H,{type:"number",min:"1",modelValue:_.form.max_times,"onUpdate:modelValue":t[5]||(t[5]=function(e){return _.form.max_times=e}),placeholder:e.請輸入最大贈送倍數,class:"max-w460",onInput:t[6]||(t[6]=function(e){return $.checkTimes()})},null,8,["modelValue","placeholder"]),S]})),_:1})):j("",!0),x(T,{label:"排序",prop:"sort",rules:[{required:!0,message:" "}]},{default:b((function(){return[x(H,{type:"text",modelValue:_.form.sort,"onUpdate:modelValue":t[7]||(t[7]=function(e){return _.form.sort=e}),placeholder:"請輸入排序",class:"max-w460"},null,8,["modelValue"]),U]})),_:1}),Y,x(T,{label:""},{default:b((function(){return[x(G,{style:{"margin-bottom":"10px"},type:"primary",onClick:t[8]||(t[8]=function(e){return $.addLimitProduct()})},{default:b((function(){return[k("新增購買商品")]})),_:1}),q,x(N,{data:_.limitProdcutData,style:{width:"60%"}},{default:b((function(){return[x(W,{prop:"product_id",label:"商品id"}),x(W,{prop:"product_name",label:"商品名稱"}),x(W,{prop:"product_num",label:"數量",rules:[{required:!0,message:" "}]},{default:b((function(e){return[x(H,{type:"number",modelValue:e.row.product_num,"onUpdate:modelValue":function(t){return e.row.product_num=t},placeholder:"",min:"1"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),x(W,{label:"操作"},{default:b((function(e){return[x(G,{type:"text",size:"small",onClick:function(t){return $.delLimitProduct(e.row)}},{default:b((function(){return[k("刪除 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]})),_:1}),L,x(T,{label:""},{default:b((function(){return[x(G,{type:"primary",onClick:t[9]||(t[9]=function(e){return $.addProduct()})},{default:b((function(){return[k("新增贈送商品")]})),_:1}),B,x(N,{data:_.prodcutData,style:{width:"60%"}},{default:b((function(){return[x(W,{prop:"product_id",label:"商品id"}),x(W,{prop:"product_name",label:"商品名稱"}),x(W,{prop:"product_num",label:"規格"},{default:b((function(e){return[20==e.row.spec_type&&e.row.spec_sku_id?(y(),h("span",E,[k(D(e.row.product_attr)+" ",1),x(G,{icon:"CloseBold",text:"",onClick:function(t){return $.deleteClick(e.$index)}},null,8,["onClick"])])):j("",!0),20!=e.row.spec_type||e.row.spec_sku_id?j("",!0):(y(),h("span",F,[x(G,{size:"small",icon:"Plus",onClick:function(t){return $.specsFunc(e.$index,e.row)}},{default:b((function(){return[k("選擇規格 ")]})),_:2},1032,["onClick"])])),10==e.row.spec_type?(y(),h("span",z,"單規格")):j("",!0)]})),_:1}),x(W,{prop:"product_num",label:"數量",rules:[{required:!0,message:" "}]},{default:b((function(e){return[x(H,{type:"number",modelValue:e.row.product_num,"onUpdate:modelValue":function(t){return e.row.product_num=t},placeholder:"",min:"1"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),x(W,{prop:"product_",label:"操作"},{default:b((function(e){return[x(G,{type:"text",size:"small",onClick:function(t){return $.delProduct(e.row)}},{default:b((function(){return[k(" 刪除 ")]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]})),_:1})]})),_:1},8,["model","rules"]),g("div",M,[x(G,{type:"info",onClick:$.gotoBack},{default:b((function(){return[k("返回")]})),_:1},8,["onClick"]),x(G,{type:"primary",onClick:$.onSubmit,loading:_.loading},{default:b((function(){return[k("提交")]})),_:1},8,["onClick","loading"])])]),x(X,{isproduct:_.isproduct,excludeIds:_.exclude_ids,islist:!1,onCloseDialog:$.closeProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"]),x(X,{isproduct:_.islimitproduct,islist:!1,excludeIds:_.limit_exclude_ids,onCloseDialog:$.closeLimitProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"]),x(K,{isspecs:_.isspecs,productId:_.curProduct.product_id,excludeIds:_.SpecExcludeIds,islist:!1,onClose:$.closeSpecs},null,8,["isspecs","productId","excludeIds","onClose"])])}]]))}}}));
