import{E as e,s as a,t,e as l,d as s,f as o,c as i,x as n,y as c,n as r,C as d,l as p,i as u,p as m,v as g}from"./element-plus-84a27f94.js";import{A as h,a as _}from"./Agent-36cbe738.js";import{_ as b}from"./index-5ae5860a.js";import{ae as y,ap as f,o as v,c as C,a as j,P as k,S as z,Q as A,a9 as S,T as D,W as V,Y as w,$ as N,X as x}from"./@vue-8fe4574d.js";import"./@vueuse-3cd91d51.js";import"./lodash-es-656e9c2f.js";import"./async-validator-cf877c1f.js";import"./dayjs-9faf8871.js";import"./call-bind-0c463fe3.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-06559b09.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-49f0fa2f.js";import"./pinia-265da389.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./qs-b80b041e.js";import"./side-channel-ba7aab8a.js";import"./object-inspect-860361a9.js";import"./vue-clipboard2-f8268db2.js";import"./clipboard-dd0324d2.js";import"./vue-ueditor-wrap-dff311b3.js";const F={components:{Agent:h},data:()=>({activeName:"-1",activeIndex:"0",loading:!0,pageSize:10,totalDataNumber:0,curPage:1,searchForm:{product_name:"",category_id:""},tableData:[],categoryList:[],product_count:{},open_agent:!1,productModel:{},selectAll:!1,checkList:[]}),created(){this.getData()},methods:{changSelection(e){this.checkList=e},handleCurrentChange(e){let a=this;a.loading=!0,a.curPage=e,a.getData()},handleSizeChange(e){this.pageSize=e,this.getData()},handleClick(e,a){let t=this;t.curPage=1,t.activeName=e,t.getData()},getData(){let e=this,a=e.searchForm;a.page=e.curPage,a.list_rows=e.pageSize,a.is_agent=e.activeName,e.loading=!0,_.getList(a,!0).then((a=>{e.loading=!1,e.selectAll=!1,e.tableData=a.data.list.data,e.categoryList=a.data.category,e.totalDataNumber=a.data.list.total,e.product_count=a.data.product_count})).catch((a=>{e.loading=!1}))},onSubmit(){this.curPage=1,this.getData()},reset(){this.curPage=1,this.searchForm={product_name:"",category_id:""},this.getData()},agentClick(e){this.productModel={product_id:e.product_id,product_name:e.product_name,is_agent:e.is_agent,is_ind_agent:e.is_ind_agent},this.open_agent=!0},closeDialogFunc(e,a){"Agent"==a&&(this.open_agent=e.openDialog,"success"==e.type&&this.getData())},allSelection(e){this.$refs.multipleTable.toggleAllSelection()},changeAgent(a){let t=this,l=this.checkList;if(l.length<=0)return;let s=[];l.forEach(((e,a)=>{s.push(e.product_id)})),_.setAgent({productIds:s.join(","),is_agent:a},!0).then((a=>{t.loading=!1,e({message:a.msg,type:"success"}),t.getData()})).catch((e=>{t.loading=!1}))}}},P={class:"product-list"},L={class:"common-seach-wrap"},M={class:"product-content"},T=j("span",null,"全部",-1),U=j("span",null,"參與",-1),E=j("span",null,"不參與",-1),I={class:"table-wrap"},$=j("span",{class:"mr10 ml4"},"當頁全選",-1),q={class:"product-info"},H={class:"pic"},Q={alt:""},W={class:"info"},X={class:"name"},Y={class:"gray3"},B={key:0,class:"green"},G={key:1,class:"gray3"},J={class:"table-btn-column"},K=j("span",{class:"mr10 ml4"},"當頁全選",-1),O={class:"pagination"};const R=b(F,[["render",function(e,h,_,b,F,R){const Z=a,ee=t,ae=l,te=s,le=o,se=i,oe=n,ie=c,ne=r,ce=d,re=p,de=u,pe=m,ue=y("Agent"),me=f("img-url"),ge=g;return v(),C("div",P,[j("div",L,[k(se,{size:"small",inline:!0,model:F.searchForm,class:"demo-form-inline"},{default:z((()=>[k(ae,{label:"商品分類"},{default:z((()=>[k(ee,{size:"small",modelValue:F.searchForm.category_id,"onUpdate:modelValue":h[0]||(h[0]=e=>F.searchForm.category_id=e),placeholder:"所有分類"},{default:z((()=>[k(Z,{label:"全部",value:"0"}),(v(!0),C(A,null,S(F.categoryList,((e,a)=>(v(),D(Z,{key:a,label:e.name,value:e.category_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),k(ae,{label:"商品名稱"},{default:z((()=>[k(te,{size:"small",modelValue:F.searchForm.product_name,"onUpdate:modelValue":h[1]||(h[1]=e=>F.searchForm.product_name=e),placeholder:"請輸入商品名稱"},null,8,["modelValue"])])),_:1}),k(ae,null,{default:z((()=>[k(le,{size:"small",type:"primary",icon:"Search",onClick:R.onSubmit},{default:z((()=>[V("查詢")])),_:1},8,["onClick"])])),_:1}),k(ae,null,{default:z((()=>[k(le,{size:"small",type:"success",onClick:R.reset},{default:z((()=>[V("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])]),j("div",M,[k(ie,{modelValue:F.activeName,"onUpdate:modelValue":h[2]||(h[2]=e=>F.activeName=e),onTabChange:R.handleClick},{default:z((()=>[k(oe,{label:"全部",name:"-1"},{label:z((()=>[T])),_:1}),k(oe,{label:"參與",name:"1"},{label:z((()=>[U])),_:1}),k(oe,{label:"不參與",name:"0"},{label:z((()=>[E])),_:1})])),_:1},8,["modelValue","onTabChange"]),j("div",I,[k(ce,{align:"middle",style:{"margin-bottom":"20px"}},{default:z((()=>[k(ne,{modelValue:F.selectAll,"onUpdate:modelValue":h[3]||(h[3]=e=>F.selectAll=e),onChange:R.allSelection},null,8,["modelValue","onChange"]),$,1!=F.activeName?(v(),D(le,{key:0,size:"small",type:"primary",onClick:h[4]||(h[4]=e=>R.changeAgent(1))},{default:z((()=>[V("參與推廣")])),_:1})):w("",!0),0!=F.activeName?(v(),D(le,{key:1,size:"small",onClick:h[5]||(h[5]=e=>R.changeAgent(0))},{default:z((()=>[V("不參與推廣")])),_:1})):w("",!0)])),_:1}),N((v(),D(de,{size:"small",data:F.tableData,border:"",style:{width:"100%"},ref:"multipleTable",onSelectionChange:R.changSelection},{default:z((()=>[k(re,{type:"selection",width:"55"}),k(re,{prop:"product_name",label:"產品",width:"300px"},{default:z((e=>[j("div",q,[j("div",H,[N(j("img",Q,null,512),[[me,e.row.image[0].file_path]])]),j("div",W,[j("div",X,x(e.row.product_name),1)])])])),_:1}),k(re,{prop:"product_price",label:"價格"},{default:z((e=>[j("div",Y,"￥"+x(e.row.product_price),1)])),_:1}),k(re,{prop:"product_stock",label:"庫存"}),k(re,{prop:"sales_actual",label:"實際銷量"}),k(re,{prop:"is_agent",label:"是否參與推廣"},{default:z((e=>[1==e.row.is_agent?(v(),C("div",B,"是")):(v(),C("div",G,"否"))])),_:1}),k(re,{fixed:"right",label:"操作",width:"80"},{default:z((e=>[j("div",J,[k(le,{onClick:a=>R.agentClick(e.row),type:"text",size:"small"},{default:z((()=>[V("設定")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data","onSelectionChange"])),[[ge,F.loading]]),k(ce,{align:"middle",style:{"margin-top":"20px"}},{default:z((()=>[k(ne,{modelValue:F.selectAll,"onUpdate:modelValue":h[6]||(h[6]=e=>F.selectAll=e),onChange:R.allSelection},null,8,["modelValue","onChange"]),K,1!=F.activeName?(v(),D(le,{key:0,size:"small",type:"primary",onClick:h[7]||(h[7]=e=>R.changeAgent(1))},{default:z((()=>[V("參與推廣")])),_:1})):w("",!0),0!=F.activeName?(v(),D(le,{key:1,size:"small",onClick:h[8]||(h[8]=e=>R.changeAgent(0))},{default:z((()=>[V("不參與推廣")])),_:1})):w("",!0)])),_:1})])]),j("div",O,[k(pe,{onSizeChange:R.handleSizeChange,onCurrentChange:R.handleCurrentChange,background:"","current-page":F.curPage,"page-size":F.pageSize,layout:"total, prev, pager, next, jumper",total:F.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),F.open_agent?(v(),D(ue,{key:0,open_agent:F.open_agent,productModel:F.productModel,onCloseDialog:h[9]||(h[9]=e=>R.closeDialogFunc(e,"Agent"))},null,8,["open_agent","productModel"])):w("",!0)])}]]);export{R as default};
