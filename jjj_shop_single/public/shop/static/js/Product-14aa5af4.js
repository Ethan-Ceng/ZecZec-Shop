import{E as e,s as a,t as l,e as t,f as i,d as o,c as s,l as d,i as n,p as r,q as c,v as u}from"./element-plus-84a27f94.js";import{P as p}from"./product-6ff3546d.js";import{_ as h}from"./index-5ae5860a.js";import{o as g,T as m,S as f,a as b,P as C,W as y,Y as _,c as k,Q as S,a9 as v,$ as z}from"./@vue-8fe4574d.js";const V={class:"common-seach-wrap"},w={class:"product-content"},x={class:"table-wrap"},I=["src"],D={class:"pagination"},L={class:"dialog-footer"};const P=h({data:()=>({loading:!0,curPage:1,pageSize:10,totalDataNumber:0,formInline:{},cateList:[],productList:[],status:[{id:10,name:"上架"},{id:20,name:"下架"}],multipleSelection:[],formLabelWidth:"120px",dialogVisible:!1,type:"error",params:null}),props:["isproduct","excludeIds","islist"],watch:{isproduct:function(e,a){e!=a&&e&&(this.dialogVisible=e,this.type="error",this.params=null,this.getData())}},created(){},methods:{selectableFunc:e=>"boolean"!=typeof e.noChoose||e.noChoose,handleCurrentChange(e){this.curPage=e,this.getData()},handleSizeChange(e){this.curPage=1,this.pageSize=e,this.getData()},getData(){let e=this,a=e.formInline;a.page=e.curPage,a.list_rows=e.pageSize,p.chooseLists(a,!0).then((a=>{1==a.code&&(e.loading=!1,e.cateList=a.data.category,e.excludeIds&&void 0!==e.excludeIds&&e.excludeIds.length>0?a.data.list.data.forEach((a=>{e.excludeIds.indexOf(a.product_id)>-1?a.noChoose=!1:a.noChoose=!0})):e.islist||a.data.list.data.forEach((e=>{e.noChoose=!0})),e.productList=a.data.list.data,e.totalDataNumber=a.data.list.total)})).catch((e=>{}))},SingleFunc(e){this.multipleSelection=[e],this.addClerk()},addClerk(){let a=this,l=null;a.multipleSelection.length<1?e({message:"請至少選擇一件產品商品！",type:"error"}):(a.islist&&void 0!==a.islist?(a.multipleSelection.forEach((e=>{e.image=e.image[0].file_path})),l=a.multipleSelection):(l=a.multipleSelection[0],l.image=l.image[0].file_path),a.params=l,a.type="success",a.dialogVisible=!1)},dialogFormVisible(){this.$emit("closeDialog",{type:this.type,openDialog:!1,params:this.params})},tableCurrentChange(e){this.multipleSelection=e}}},[["render",function(e,p,h,P,F,j){const E=a,N=l,U=t,W=i,$=o,q=s,O=d,Q=n,T=r,Y=c,A=u;return g(),m(Y,{title:"選擇商品",modelValue:F.dialogVisible,"onUpdate:modelValue":p[3]||(p[3]=e=>F.dialogVisible=e),onClose:j.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"900px"},{footer:f((()=>[b("div",L,[C(W,{size:"small",onClick:p[2]||(p[2]=e=>F.dialogVisible=!1)},{default:f((()=>[y("取 消")])),_:1}),h.islist?(g(),m(W,{key:0,size:"small",type:"primary",onClick:j.addClerk},{default:f((()=>[y("確 定")])),_:1},8,["onClick"])):_("",!0)])])),default:f((()=>[b("div",V,[C(q,{inline:!0,size:"small",model:F.formInline,class:"demo-form-inline"},{default:f((()=>[C(U,{label:"商品分類"},{default:f((()=>[C(N,{modelValue:F.formInline.category_id,"onUpdate:modelValue":p[0]||(p[0]=e=>F.formInline.category_id=e),placeholder:"請選擇商品分類"},{default:f((()=>[C(E,{value:0,label:"全部"}),(g(!0),k(S,null,v(F.cateList,(e=>(g(),k(S,{key:e.category_id},[C(E,{value:e.category_id,label:e.name},null,8,["value","label"]),e.child&&e.child.length>0?(g(!0),k(S,{key:0},v(e.child,(e=>(g(),k(S,{key:e.category_id},[C(E,{value:e.category_id,label:e.name,style:{"padding-left":"30px"}},null,8,["value","label"]),e.child&&e.child.length>0?(g(!0),k(S,{key:0},v(e.child,(e=>(g(),m(E,{key:e.category_id,value:e.category_id,label:e.name,style:{"padding-left":"60px"}},null,8,["value","label"])))),128)):_("",!0)],64)))),128)):_("",!0)],64)))),128))])),_:1},8,["modelValue"])])),_:1}),C(U,{label:"商品名稱"},{default:f((()=>[C($,{placeholder:"請輸入商品名稱",modelValue:F.formInline.search,"onUpdate:modelValue":p[1]||(p[1]=e=>F.formInline.search=e)},{append:f((()=>[C(W,{icon:"Search",onClick:j.getData},{default:f((()=>[y("查詢")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])]),b("div",w,[b("div",x,[z((g(),m(Q,{size:"small",data:F.productList,border:"",style:{width:"100%"},"highlight-current-row":"",onSelectionChange:j.tableCurrentChange},{default:f((()=>[C(O,{width:"70",label:"商品圖片"},{default:f((({row:e})=>[b("img",{src:e.image&&e.image[0].file_path,width:"30",height:"30"},null,8,I)])),_:1}),C(O,{prop:"product_name",label:"商品名稱"}),C(O,{prop:"category.name",width:"100",label:"商品分類"}),C(O,{prop:"create_time",width:"140",label:"新增時間"}),h.islist?(g(),m(O,{key:0,type:"selection",selectable:j.selectableFunc,width:"44"},null,8,["selectable"])):_("",!0),h.islist?_("",!0):(g(),m(O,{key:1,width:"80",label:"單選"},{default:f((({row:e})=>[e.noChoose?(g(),m(W,{key:0,size:"small",onClick:a=>j.SingleFunc(e)},{default:f((()=>[y("選擇")])),_:2},1032,["onClick"])):(g(),m(W,{key:1,size:"small",disabled:""},{default:f((()=>[y("已選")])),_:1}))])),_:1}))])),_:1},8,["data","onSelectionChange"])),[[A,F.loading]])]),b("div",D,[C(T,{onSizeChange:j.handleSizeChange,onCurrentChange:j.handleCurrentChange,background:"","current-page":F.curPage,"page-sizes":[2,10,20,50,100],"page-size":F.pageSize,layout:"total, prev, pager, next, jumper",total:F.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])])),_:1},8,["modelValue","onClose"])}],["__scopeId","data-v-3ca5fd40"]]);export{P};
