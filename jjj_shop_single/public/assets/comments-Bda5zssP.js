import{u as N}from"./loading-a_aMpdwj.js";import{b as C,l as L,d as S}from"./product-BXEgIn4-.js";import{d as B,e as f,N as V,f as Z,t as E,o as v,c as b,a as e,Z as F,i as x,y as n,b as d,w as u,g as i,F as y,x as M,S as P,j as T,r as R}from"./index-CCr7jDqf.js";import{g as p}from"./get-CAfd8AwD.js";const U={class:"border-t border-neutral-200"},A={class:"container cf"},G={class:"w-full flex"},H={class:"inline-block lg:float-left w-full lg:w-1/3"},I={class:"py-2 lg:px-2 px-4 flex-1"},J={class:"text-base mb-0 inline-block mt-1 text-base font-bold"},K={class:"text-neutral-600 text-xs mb-4"},O={class:"px-4 lg:px-0 lg:mt-0 mt-6 top-0 bg-gray-50 sticky"},Q={class:"container cf text-sm relative"},W={class:"-mx-4 flex"},X={class:"px-4 overflow-auto whitespace-nowrap flex flex-nowrap items-center space-x-8 my-1 tracking-widest lg:w-7/10"},Y={class:"text-xs font-bold ml-1 text-neutral-600"},tt={class:"inline-block py-2 hover:border-zec-green lg:border-b-2 text-black border-transparent border-zec-green font-bold"},et={class:"px-4 py-3 text-center w-full flex lg:static bg-gray-50 bottom-0 z-50 lg:w-3/10 fixed"},st={class:"container my-8"},ot={class:"lg:-mx-4 flex"},lt={class:"w-full px-4 mb-8"},at={class:"bg-zinc-100 p-2 text-xs mb-8"},rt={class:"js-comments","data-read-time-mark":"last-read-time-for-project-18514","data-read-time-value":"1725002882"},nt={class:"px-4","data-created-at":"1722924488"},it={class:"float-right"},ct={class:"ml-2 text-neutral-600 text-xs",title:"2024/08/06 14:08"},dt=["src"],ut={class:"ml-8 pl-4"},pt={class:"font-bold mr-2"},mt={class:"mt-2 mv-child-0"},wt=B({__name:"comments",setup(ft){const k=P(),{loading:_t,setLoading:c}=N(!1),g=f(null),l=f({}),m=f(!1),h=V(()=>{try{if(l.value.faq_ids)return l.value.faq_ids.split(",").length}catch{return 0}}),z=async o=>{if(o){c(!0);try{const{data:t}=await C(o);if(t&&t.detail){let r=p(t,"detail.product_multi_spec.spec_attr[0].spec_items",[])||[],a=t.detail.sku||[];a=a.map(s=>{let $=r.find(D=>D.item_id-0===s.spec_sku_id-0);return{...s,spec_item:$}}),l.value={...t.detail,sku:a.filter(s=>s.type-0===0)},console.log(l.value),m.value=t.is_fav}}catch{}finally{c(!1)}}},j=async o=>{if(o){c(!0);try{await L(o),m.value=!m.value;const t=m.value?"加入追蹤計劃":"取消追蹤計劃";T.success(t)}catch{}finally{c(!1)}}},w=f([]),_=Z({pageSize:20,current:1,total:0});async function q(o={}){var t,r;c(!0);try{let a={product_id:g.value,page:_.current,list_rows:_.pageSize};o&&(a={...a,...o});const{data:s}=await S(a);s&&(s!=null&&s.list)&&(w.value=((t=s==null?void 0:s.list)==null?void 0:t.data)||[],_.total=((r=s==null?void 0:s.list)==null?void 0:r.total)||0)}finally{c(!1)}}return E(()=>{const o=p(k,"params.id");o&&(g.value=o,z(o),q())}),(o,t)=>{const r=R("router-link");return v(),b(y,null,[t[10]||(t[10]=e("div",{class:"container"},null,-1)),e("div",U,[e("div",A,[e("div",G,[e("div",H,[e("div",{class:"aspect-ratio-project-cover bg-zinc-100 lg:mr-6",style:F(`background-image: url('${x(p)(l.value,"product_image","")}')`)},null,4)]),e("div",I,[e("h2",J,n(x(p)(l.value,"category.name")),1),e("div",K,n(l.value.type_text),1)])])])]),e("div",O,[e("div",Q,[e("div",W,[e("div",X,[d(r,{class:"text-xs font-bold ml-1 text-neutral-600",to:`/project/${l.value.product_id}`},{default:u(()=>t[1]||(t[1]=[i("專案內容 ")])),_:1},8,["to"]),d(r,{class:"inline-block py-2 hover:border-zec-green lg:border-b-2 text-black border-transparent",to:`/project/${l.value.product_id}/faqs`},{default:u(()=>[t[2]||(t[2]=i("常見問答 ")),e("span",Y,n(h.value),1)]),_:1},8,["to"]),d(r,{class:"inline-block py-2 hover:border-zec-green lg:border-b-2 text-black border-transparent",to:`/project/${l.value.product_id}/comments`},{default:u(()=>[t[3]||(t[3]=i("留言 ")),e("span",tt,n(x(p)(l.value,"comment_data_count")),1)]),_:1},8,["to"])]),e("div",et,[e("a",{class:"p-2 inline-block flex-initial mr-2 transition-transform hover:scale-105 focus:scale-105 active:scale-90 text-zec-cyan border-2 border-current rounded tooltip tooltip-l","data-method":"post","data-click-event":"follow_project","aria-label":"追蹤後會收到公開的專案更新和計畫結束提醒。",onClick:t[0]||(t[0]=a=>j(l.value.product_id))},t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",class:"w-6 h-6 fill-current"},[e("path",{d:"m479.435 948.718-48.609-43.978q-106.231-97.889-175.847-168.98-69.616-71.091-110.93-127.066-41.314-55.975-57.53-101.96-16.215-45.986-16.215-93.289 0-94.915 63.544-158.528 63.544-63.613 157.087-63.613 55.885 0 103.877 25.304t84.623 74.543q43.13-51.739 88.77-75.793 45.639-24.054 99.859-24.054 94.379 0 158.006 63.574 63.626 63.574 63.626 158.43 0 47.409-16.215 93.127-16.216 45.718-57.53 101.694-41.314 55.975-111.138 127.412-69.823 71.437-176.204 169.199l-49.174 43.978Zm-.283-100.936q100.045-92.612 164.566-157.708t102.206-113.998q37.685-48.902 52.369-87.12 14.685-38.218 14.685-75.34 0-63.355-40.649-104.475-40.649-41.119-103.649-41.119-50.349 0-92.851 31.783-42.503 31.782-70.503 88.717h-52.217q-26.859-56.5-70.188-88.5t-92.204-32q-62.394 0-102.762 40.599t-40.368 105.353q0 38.151 15.184 76.807 15.183 38.655 52.835 88.06 37.653 49.405 101.556 113.989 63.903 64.583 161.99 154.952Zm1.413-290.412Z"})],-1)])),d(r,{class:"js-back-project-now tracking-widest flex-1 border-zec-cyan bg-zec-cyan py-2 text-white inline-block w-full text-base transition-transform hover:scale-105 focus:scale-105 active:scale-90 rounded font-bold py-1","data-click-event":"list_options",to:`/order/${l.value.product_id}`},{default:u(()=>t[5]||(t[5]=[i("立即購買")])),_:1},8,["to"])])])])]),t[11]||(t[11]=e("div",{class:"container"},null,-1)),e("div",st,[e("div",ot,[e("div",lt,[e("div",at,[t[7]||(t[7]=i(" 贊助人才能留言。如有專案相關提問，請聯絡 ")),d(r,{class:"font-bold text-black",to:`/message/new?product_id=${l.value.product_id}`},{default:u(()=>t[6]||(t[6]=[i("我們")])),_:1},8,["to"]),t[8]||(t[8]=i("。 "))]),e("div",rt,[(v(!0),b(y,null,M(w.value,(a,s)=>(v(),b("div",{key:s,class:"cf -ml-4 py-4 -mr-4 lg:mx-0 border-t border-neutral-200 text-sm js-comment"},[e("div",nt,[e("div",it,[e("span",ct,n(a.create_time),1)]),e("img",{class:"round mr-4 h-8 w-8 absolute",src:a.users.avatarUrl},null,8,dt),e("div",ut,[e("span",pt,n(a.users.nickName),1),t[9]||(t[9]=e("span",{class:"text-zec-blue p-1 whitespace-nowrap leading-none rounded-sm text-xs mr-1 border border-current font-bold"},"贊助人",-1)),e("div",mt,[e("p",null,n(a.content),1)])])])]))),128))])])])])],64)}}});export{wt as default};
