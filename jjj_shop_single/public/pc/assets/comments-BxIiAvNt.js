import{u as C}from"./loading-DZi2qnJz.js";import{b as L,l as N,d as V}from"./product-Bc4eezU8.js";import{d as B,e as m,V as S,f as E,g as Z,o as v,c as b,a as t,a3 as F,m as h,G as r,b as d,w as u,h as n,F as w,D as M,i as P,E as T,r as G}from"./index-BWcYl31F.js";import{g as _}from"./get-Bnx5vrHs.js";const R=t("div",{class:"container"},null,-1),U={class:"border-t border-neutral-200"},A={class:"container cf"},H={class:"w-full flex"},I={class:"inline-block lg:float-left w-full lg:w-1/3"},J={class:"py-2 lg:px-2 px-4 flex-1"},K={class:"text-base mb-0 inline-block mt-1 text-base font-bold"},O={class:"text-neutral-600 text-xs mb-4"},Q={class:"px-4 lg:px-0 lg:mt-0 mt-6 top-0 bg-gray-50 sticky"},W={class:"container cf text-sm relative"},X={class:"-mx-4 flex"},Y={class:"px-4 overflow-auto whitespace-nowrap flex flex-nowrap items-center space-x-8 my-1 tracking-widest lg:w-7/10"},tt={class:"text-xs font-bold ml-1 text-neutral-600"},et={class:"inline-block py-2 hover:border-zec-green lg:border-b-2 text-black border-transparent border-zec-green font-bold"},st={class:"px-4 py-3 text-center w-full flex lg:static bg-gray-50 bottom-0 z-50 lg:w-3/10 fixed"},ot=t("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",class:"w-6 h-6 fill-current"},[t("path",{d:"m479.435 948.718-48.609-43.978q-106.231-97.889-175.847-168.98-69.616-71.091-110.93-127.066-41.314-55.975-57.53-101.96-16.215-45.986-16.215-93.289 0-94.915 63.544-158.528 63.544-63.613 157.087-63.613 55.885 0 103.877 25.304t84.623 74.543q43.13-51.739 88.77-75.793 45.639-24.054 99.859-24.054 94.379 0 158.006 63.574 63.626 63.574 63.626 158.43 0 47.409-16.215 93.127-16.216 45.718-57.53 101.694-41.314 55.975-111.138 127.412-69.823 71.437-176.204 169.199l-49.174 43.978Zm-.283-100.936q100.045-92.612 164.566-157.708t102.206-113.998q37.685-48.902 52.369-87.12 14.685-38.218 14.685-75.34 0-63.355-40.649-104.475-40.649-41.119-103.649-41.119-50.349 0-92.851 31.783-42.503 31.782-70.503 88.717h-52.217q-26.859-56.5-70.188-88.5t-92.204-32q-62.394 0-102.762 40.599t-40.368 105.353q0 38.151 15.184 76.807 15.183 38.655 52.835 88.06 37.653 49.405 101.556 113.989 63.903 64.583 161.99 154.952Zm1.413-290.412Z"})],-1),at=[ot],lt=t("div",{class:"container"},null,-1),ct={class:"container my-8"},rt={class:"lg:-mx-4 flex"},nt={class:"w-full px-4 mb-8"},it={class:"bg-zinc-100 p-2 text-xs mb-8"},dt={class:"js-comments","data-read-time-mark":"last-read-time-for-project-18514","data-read-time-value":"1725002882"},ut={class:"px-4","data-created-at":"1722924488"},_t={class:"float-right"},pt={class:"ml-2 text-neutral-600 text-xs",title:"2024/08/06 14:08"},mt=["src"],ft={class:"ml-8 pl-4"},vt={class:"font-bold mr-2"},bt=t("span",{class:"text-zec-blue p-1 whitespace-nowrap leading-none rounded-sm text-xs mr-1 border border-current font-bold"},"贊助人",-1),ht={class:"mt-2 mv-child-0"},qt=B({__name:"comments",setup(gt){const k=P(),{loading:xt,setLoading:i}=C(!1),g=m(null),a=m({}),p=m(!1),y=S(()=>{try{if(a.value.faq_ids)return a.value.faq_ids.split(",").length}catch{return 0}}),z=async o=>{if(o){i(!0);try{const{data:s}=await L(o);if(s&&s.detail){let c=_(s,"detail.product_multi_spec.spec_attr[0].spec_items",[])||[],l=s.detail.sku||[];l=l.map(e=>{let D=c.find($=>$.item_id-0===e.spec_sku_id-0);return{...e,spec_item:D}}),a.value={...s.detail,sku:l.filter(e=>e.type-0===0)},console.log(a.value),p.value=s.is_fav}}catch{}finally{i(!1)}}},q=async o=>{if(o){i(!0);try{await N(o),p.value=!p.value;const s=p.value?"加入追蹤計劃":"取消追蹤計劃";T.success(s)}catch{}finally{i(!1)}}},x=m([]),f=E({pageSize:20,current:1,total:0});async function j(o={}){var s,c;i(!0);try{let l={product_id:g.value,page:f.current,list_rows:f.pageSize};o&&(l={...l,...o});const{data:e}=await V(l);e&&(e!=null&&e.list)&&(x.value=((s=e==null?void 0:e.list)==null?void 0:s.data)||[],f.total=((c=e==null?void 0:e.list)==null?void 0:c.total)||0)}finally{i(!1)}}return Z(()=>{const o=_(k,"params.id");o&&(g.value=o,z(o),j())}),(o,s)=>{const c=G("router-link");return v(),b(w,null,[R,t("div",U,[t("div",A,[t("div",H,[t("div",I,[t("div",{class:"aspect-ratio-project-cover bg-zinc-100 lg:mr-6",style:F(`background-image: url('${h(_)(a.value,"product_image","")}')`)},null,4)]),t("div",J,[t("h2",K,r(h(_)(a.value,"category.name")),1),t("div",O,r(a.value.type_text),1)])])])]),t("div",Q,[t("div",W,[t("div",X,[t("div",Y,[d(c,{class:"text-xs font-bold ml-1 text-neutral-600",to:`/project/${a.value.product_id}`},{default:u(()=>[n("專案內容 ")]),_:1},8,["to"]),d(c,{class:"inline-block py-2 hover:border-zec-green lg:border-b-2 text-black border-transparent",to:`/project/${a.value.product_id}/faqs`},{default:u(()=>[n("常見問答 "),t("span",tt,r(y.value),1)]),_:1},8,["to"]),d(c,{class:"inline-block py-2 hover:border-zec-green lg:border-b-2 text-black border-transparent",to:`/project/${a.value.product_id}/comments`},{default:u(()=>[n("留言 "),t("span",et,r(h(_)(a.value,"comment_data_count")),1)]),_:1},8,["to"])]),t("div",st,[t("a",{class:"p-2 inline-block flex-initial mr-2 transition-transform hover:scale-105 focus:scale-105 active:scale-90 text-zec-cyan border-2 border-current rounded tooltip tooltip-l","data-method":"post","data-click-event":"follow_project","aria-label":"追蹤後會收到公開的專案更新和計畫結束提醒。",onClick:s[0]||(s[0]=l=>q(a.value.product_id))},at),d(c,{class:"js-back-project-now tracking-widest flex-1 border-zec-cyan bg-zec-cyan py-2 text-white inline-block w-full text-base transition-transform hover:scale-105 focus:scale-105 active:scale-90 rounded font-bold py-1","data-click-event":"list_options",to:`/order/${a.value.product_id}`},{default:u(()=>[n("立即購買")]),_:1},8,["to"])])])])]),lt,t("div",ct,[t("div",rt,[t("div",nt,[t("div",it,[n(" 贊助人才能留言。如有專案相關提問，請聯絡 "),d(c,{class:"font-bold text-black",to:`/message/new?product_id=${a.value.product_id}`},{default:u(()=>[n("我們")]),_:1},8,["to"]),n("。 ")]),t("div",dt,[(v(!0),b(w,null,M(x.value,(l,e)=>(v(),b("div",{key:e,class:"cf -ml-4 py-4 -mr-4 lg:mx-0 border-t border-neutral-200 text-sm js-comment"},[t("div",ut,[t("div",_t,[t("span",pt,r(l.create_time),1)]),t("img",{class:"round mr-4 h-8 w-8 absolute",src:l.users.avatarUrl},null,8,mt),t("div",ft,[t("span",vt,r(l.users.nickName),1),bt,t("div",ht,[t("p",null,r(l.content),1)])])])]))),128))])])])])],64)}}});export{qt as default};
