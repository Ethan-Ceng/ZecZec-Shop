/* empty css             *//* empty css               *//* empty css              */import{_ as L}from"./header-main.vue_vue_type_script_setup_true_lang-DaJeFuBG.js";import{d as y,o as n,c as r,a as e,b as x,_ as C,e as p,g as V,C as B,F as m,D as w,G as c,m as d,w as D,E as v,s as E,x as N,H as $,I as H,h as Y}from"./index-BWcYl31F.js";import{g as I,s as S,a as A}from"./message-TYytYp6X.js";import{u as F}from"./loading-DZi2qnJz.js";import{g as f}from"./get-Bnx5vrHs.js";/* empty css                      *//* empty css                  */const U={class:"relative z-20 border-b py-2 px-4 lg:px-0 border-zinc-100"},q={class:"cf lg:px-4"},G=y({__name:"full-width",setup(k){return(g,o)=>(n(),r("header",U,[e("div",q,[x(L)])]))}}),T=C(G,[["__scopeId","data-v-403ac14f"]]),J={class:"flex flex-nowrap js-inbox",style:{height:"calc(100vh - 5em)"}},K={class:"js-details reset-details w-full xs:w-auto xs:rounded-sm border-neutral-200 absolute xs:relative lg:w-1/4",open:"open"},O=e("div",{class:"js-summary inline-block block xs:hidden p-4 z-10 relative"},[e("i",{class:"material-icons"},"chevron_left")],-1),P={class:"xs:block bg-white -mt-16 xs:mt-0 h-full z-30 relative overflow-auto xs:w-16 lg:w-full border-r",style:{height:"calc(100vh - 5em)"}},Q=e("div",{class:"border-b p-4 border-zinc-100 xs:hidden lg:block"},[e("div",{class:"button-group"},[e("span",{class:"button-s button text-white hover:text-white bg-zec-blue"}," 未讀 (0) "),e("span",{class:"button-s button text-white hover:text-white bg-neutral-400"}," 全部 ")])],-1),R={key:0,class:"text-sm text-neutral-600 p-4"},W=["onClick"],X=["src"],Z={class:"flex-1 block xs:hidden lg:block pl-4 overflow-hidden"},ee={class:"text-xs float-right text-neutral-600"},te={class:"truncate mr-2 text-black"},se={class:"flex-auto mv-child-0 js-thread"},ae={class:"flex flex-nowrap flex-col h-full relative"},le={class:"border-b border-zinc-100 p-4 w-full text-center flex flex-nowrap items-center"},oe=e("div",{class:"w-16"},null,-1),ne={class:"flex-auto text-sm my-0 text-center relative z-10"},re=e("div",{class:"text-right w-16 relative z-10"},null,-1),ie=e("div",{class:"hidden absolute right-0 top-0 z-10 text-center disabled js-next-page-spinner p-4"},[e("i",{class:"material-icons rotate text-2xl text-neutral-200"},"donut_large")],-1),ce={class:"overflow-auto relative w-full js-message-screen grow"},de={class:"ml-16"},ue={class:"py-2 mv-child-0 ml-4 px-4 lg:max-w-lg max-w-full border-neutral-200 rounded inline-block border text-left"},_e=e("br",null,null,-1),xe={class:"ml-4 text-xs text-neutral-600 tooltip help inline-block tooltip-l","data-title":"2024/09/12  03:09"},he={class:"border-t border-zinc-100"},pe={class:"w-full flex p-4 border-t border-zinc-100"},Le=y({__name:"index",setup(k){const{loading:g,setLoading:o}=F(),h=p([]),z=async()=>{o(!0);try{const{data:t}=await I();t&&t.list&&(h.value=t.list||[])}catch{}finally{o(!1)}},l=p({}),b=async t=>{o(!0);try{const{data:a}=await A(t);a&&(l.value={...l.value,messageList:a||[]})}catch{}finally{o(!1)}},M=t=>{i.value="",l.value=t,b(t.message_box_id)},i=p(""),j=async()=>{var t,a,u;if(!i.value){v.warning("請輸入咨詢信息");return}if(!((t=l.value)!=null&&t.message_box_id)){v.warning("請輸選擇一個對話");return}o(!0);try{let _={message_box_id:(a=l.value)==null?void 0:a.message_box_id,content:i.value};await S(_),i.value="",v.success("傳送成功"),await b((u=l.value)==null?void 0:u.message_box_id)}catch{}finally{o(!1)}};return V(()=>{z()}),(t,a)=>{const u=E,_=N;return n(),r(m,null,[x(T),e("div",J,[e("div",K,[O,e("div",P,[Q,h.value.length===0?(n(),r("div",R,"沒有對話。")):B("",!0),(n(!0),r(m,null,w(h.value,s=>(n(),r("span",{key:s.message_box_id,onClick:me=>M(s),class:"block border-b flex border-zinc-100 p-4 hover:bg-zinc-100 js-conversation-link js-summary"},[e("img",{class:"w-8 h-8 round float-left self-center bg-neutral-200",src:d(f)(s,"user.avatarUrl")},null,8,X),e("div",Z,[e("div",ee,c(s.last_replied_at?d($).unix(s.last_replied_at).format("YYYY-MM-DD HH:mm:ss"):""),1),e("div",te,c(d(f)(s,"product.product_name","No Subject")),1)])],8,W))),128))])]),e("div",se,[e("div",ae,[e("div",le,[oe,e("h2",ne,c(d(f)(l.value,"product.product_name","咨詢信息")),1),re]),ie,e("div",ce,[(n(!0),r(m,null,w(l.value.messageList,s=>(n(),r("div",{class:H(["p-4",s.user_id&&"text-right"])},[e("div",de,[e("div",ue,[e("p",null,c(s.content),1)]),_e,e("div",xe,c(s.create_time),1)])],2))),256))]),e("div",he,[e("div",pe,[x(u,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value=s),type:"textarea",class:"flex-1 w-full"},null,8,["modelValue"]),x(_,{onClick:j,loading:d(g),class:"button button-s text-zec-green mb-0 ml-2",type:"success",plain:""},{default:D(()=>[Y(" 送出訊息 ")]),_:1},8,["loading"])])])])])])],64)}}});export{Le as default};
